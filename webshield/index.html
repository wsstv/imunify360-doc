<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>WebShield | Documentation</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content=":::warning Warning
When the interface IP address is added to or deleted from the system, the restart of the webshield is required for the latter to recognize the new IP.
:::">
    <meta name="image" content="https://docs.imunify360.com/images/captcha.jpg">
    <meta name="twitter:title" content="WebShield">
    <meta name="twitter:description" content=":::warning Warning
When the interface IP address is added to or deleted from the system, the restart of the webshield is required for the latter to recognize the new IP.
:::">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://docs.imunify360.com/images/captcha.jpg">
    <meta name="twitter:url" content="https://docs.imunify360.com/webshield/">
    <meta property="og:type" content="article">
    <meta property="og:title" content="WebShield">
    <meta property="og:description" content=":::warning Warning
When the interface IP address is added to or deleted from the system, the restart of the webshield is required for the latter to recognize the new IP.
:::">
    <meta property="og:image" content="https://docs.imunify360.com/images/captcha.jpg">
    <meta property="og:url" content="https://docs.imunify360.com/webshield/">
    <meta property="og:site_name" content="Imunify 360 Documentation">
    <meta itemprop="name" content="WebShield">
    <meta itemprop="description" content=":::warning Warning
When the interface IP address is added to or deleted from the system, the restart of the webshield is required for the latter to recognize the new IP.
:::">
    <meta itemprop="image" content="https://docs.imunify360.com/images/captcha.jpg">
    <link rel="preload" href="/assets/css/0.styles.6006968c.css" as="style"><link rel="preload" href="/assets/js/app.8f538a27.js" as="script"><link rel="preload" href="/assets/js/4.ad788cf3.js" as="script"><link rel="preload" href="/assets/js/1.ac56a00f.js" as="script"><link rel="preload" href="/assets/js/62.934d99c2.js" as="script"><link rel="prefetch" href="/assets/js/10.c28c2ce4.js"><link rel="prefetch" href="/assets/js/11.ecb5ecdf.js"><link rel="prefetch" href="/assets/js/12.bebabae6.js"><link rel="prefetch" href="/assets/js/13.922873af.js"><link rel="prefetch" href="/assets/js/14.aa3cdb24.js"><link rel="prefetch" href="/assets/js/15.0f275457.js"><link rel="prefetch" href="/assets/js/16.d493685a.js"><link rel="prefetch" href="/assets/js/17.f6d2650c.js"><link rel="prefetch" href="/assets/js/18.55041527.js"><link rel="prefetch" href="/assets/js/19.e19b2aac.js"><link rel="prefetch" href="/assets/js/20.ff5b0bf4.js"><link rel="prefetch" href="/assets/js/21.2c93ea93.js"><link rel="prefetch" href="/assets/js/22.cbc20958.js"><link rel="prefetch" href="/assets/js/23.ba18fca1.js"><link rel="prefetch" href="/assets/js/24.2305918e.js"><link rel="prefetch" href="/assets/js/25.bfa6f6a8.js"><link rel="prefetch" href="/assets/js/26.106d44b6.js"><link rel="prefetch" href="/assets/js/27.50b92db3.js"><link rel="prefetch" href="/assets/js/28.fa9dc82b.js"><link rel="prefetch" href="/assets/js/29.c1a62275.js"><link rel="prefetch" href="/assets/js/30.c5991493.js"><link rel="prefetch" href="/assets/js/31.24418d61.js"><link rel="prefetch" href="/assets/js/32.60f2cf7b.js"><link rel="prefetch" href="/assets/js/33.9e23ba42.js"><link rel="prefetch" href="/assets/js/34.802ede2c.js"><link rel="prefetch" href="/assets/js/35.cd6f9b1f.js"><link rel="prefetch" href="/assets/js/36.27b9d486.js"><link rel="prefetch" href="/assets/js/37.8eaf62ec.js"><link rel="prefetch" href="/assets/js/38.49a5f959.js"><link rel="prefetch" href="/assets/js/39.8edfc7ec.js"><link rel="prefetch" href="/assets/js/40.d4834493.js"><link rel="prefetch" href="/assets/js/41.4ecce336.js"><link rel="prefetch" href="/assets/js/42.5758db9d.js"><link rel="prefetch" href="/assets/js/43.c2196607.js"><link rel="prefetch" href="/assets/js/44.c303d7b2.js"><link rel="prefetch" href="/assets/js/45.5657a3e1.js"><link rel="prefetch" href="/assets/js/46.7401098e.js"><link rel="prefetch" href="/assets/js/47.666cbf98.js"><link rel="prefetch" href="/assets/js/48.e9068ece.js"><link rel="prefetch" href="/assets/js/49.f9866028.js"><link rel="prefetch" href="/assets/js/5.a791a612.js"><link rel="prefetch" href="/assets/js/50.b083857b.js"><link rel="prefetch" href="/assets/js/51.0bbf32ee.js"><link rel="prefetch" href="/assets/js/52.ba794043.js"><link rel="prefetch" href="/assets/js/53.8968d12f.js"><link rel="prefetch" href="/assets/js/54.749e0af6.js"><link rel="prefetch" href="/assets/js/55.16839767.js"><link rel="prefetch" href="/assets/js/56.478c922f.js"><link rel="prefetch" href="/assets/js/57.8fbd5f38.js"><link rel="prefetch" href="/assets/js/58.0be5b685.js"><link rel="prefetch" href="/assets/js/59.1cba522b.js"><link rel="prefetch" href="/assets/js/6.ecbbd367.js"><link rel="prefetch" href="/assets/js/60.1672bf0a.js"><link rel="prefetch" href="/assets/js/61.5363a453.js"><link rel="prefetch" href="/assets/js/63.17e5db2d.js"><link rel="prefetch" href="/assets/js/64.8600bb47.js"><link rel="prefetch" href="/assets/js/65.afafe3d8.js"><link rel="prefetch" href="/assets/js/7.8c8d2896.js"><link rel="prefetch" href="/assets/js/8.181ff140.js"><link rel="prefetch" href="/assets/js/9.f158522a.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.38015cce.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6006968c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/introduction/" class="home-link"><img src="/logo.svg" alt="Documentation" class="logo"> <span class="site-name site-name--documentation can-hide">Documentation</span></a> <form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <div class="links" style="max-width:nullpx;"><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" class="btn">
      Submit Request
    </a> <a href="https://www.imunify360.com/trial" target="_blank" class="btn">
      Try Free
    </a> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><span class="title">Language:</span> <a class="dropdown-title"><span class="text">En</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webshield/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/ru/webshield/" class="nav-link">Русский</a></li></ul></div></div></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><span class="title">Language:</span> <a class="dropdown-title"><span class="text">En</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webshield/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/ru/webshield/" class="nav-link">Русский</a></li></ul></div></div></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><div class="sidebar-heading open"><span>Contents</span> <!----></div> <ul class="sidebar-group-items"><li><div><a href="/introduction/" class="sidebar-link">Introduction</a></div></li><li><div><a href="/terminology/" class="sidebar-link">Terminology</a></div></li><li><div><a href="/billing/" class="sidebar-link">Billing</a></div></li><li><div class="sidebar-header sidebar-link"><div><a href="/installation/" class="sidebar-link">Installation Guide</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/installation/#requirements" class="sidebar-link">Requirements</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/installation/#side-by-side-installation-with-another-ids" class="sidebar-link">Side by side installation with another</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/installation/#installation-instructions" class="sidebar-link">Installation Instructions</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/installation/#registering" class="sidebar-link">Registering</a></div></li><li class="sidebar-sub-header"><div><a href="/installation/#selinux-support" class="sidebar-link">SELinux support</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/installation/#update-instructions" class="sidebar-link">Update Instructions</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/installation/#gradual-roll-out" class="sidebar-link">Gradual roll-out</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link sidebar-header--empty"><div><a href="/stand_alone/" class="sidebar-link">Imunify360 Stand-alone</a></div></div><ul class="sidebar-sub-headers"></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/ids_integration/" class="sidebar-link">IDS Integrations</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/ids_integration/#csf-integration" class="sidebar-link">CSF Integration</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/ids_integration/#cxs-integration" class="sidebar-link">CXS Integration</a></div></li></ul></li><li><div class="active collapsed sidebar-header sidebar-link"><div class="active"><a href="/webshield/" class="active sidebar-link">WebShield</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/webshield/#captcha" class="sidebar-link">Captcha</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/webshield/#captcha-page-customization" class="sidebar-link">Captcha page customization</a></div></li><li class="sidebar-sub-header"><div><a href="/webshield/#update-captcha-localizations" class="sidebar-link">Update Captcha localizations</a></div></li><li class="sidebar-sub-header"><div><a href="/webshield/#changing-the-default-keys-to-google-recaptcha-keys" class="sidebar-link">Changing the default keys to Google reCAPTCHA keys</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/webshield/#configuring-recaptcha-keys" class="sidebar-link">Configuring reCAPTCHA keys</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/webshield/#how-to-specify-the-keys-for-the-imunify360-captcha" class="sidebar-link">How to specify the keys for the Imunify360 CAPTCHA</a></div></li><li class="sidebar-sub-header"><div><a href="/webshield/#steps-to-configure" class="sidebar-link">Steps to configure</a></div></li><li class="sidebar-sub-header"><div><a href="/webshield/#verification" class="sidebar-link">Verification</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/webshield/#cdn-support" class="sidebar-link">CDN Support</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/webshield/#splashscreen-for-chinese-customers" class="sidebar-link">SplashScreen for Chinese customers</a></div></li><li class="sidebar-sub-header"><div><a href="/webshield/#how-to-block-attacks-from-a-particular-country-in-webshield" class="sidebar-link">How to block attacks from a particular country in WebShield</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/backup_providers_integration/" class="sidebar-link">Backup Providers Integration</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/backup_providers_integration/#overview" class="sidebar-link">Overview</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/backup_providers_integration/#command-line-usage" class="sidebar-link">Command Line Usage</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#synopsis" class="sidebar-link">Synopsis</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#actions" class="sidebar-link">Actions</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/backup_providers_integration/#using-as-library" class="sidebar-link">Using as Library</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#restoring-infected-files" class="sidebar-link">Restoring Infected Files</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#operating-with-backend" class="sidebar-link">Operating With Backend</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#operating-with-backup" class="sidebar-link">Operating With Backup</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#operating-with-file-in-backup" class="sidebar-link">Operating With File in Backup</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/backup_providers_integration/#creating-custom-backup-backend-plugin" class="sidebar-link">Creating Custom Backup Backend Plugin</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#creating-module" class="sidebar-link">Creating Module</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#defining-classes" class="sidebar-link">Defining Classes</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#implementing-api-functions" class="sidebar-link">Implementing API Functions</a></div></li></ul></li></ul></li><li><div><a href="/localization/" class="sidebar-link">Localization</a></div></li><li><div class="sidebar-header sidebar-link"><div><a href="/dashboard/" class="sidebar-link">Imunify360 Admin Interface</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#support" class="sidebar-link">Support</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#dashboard" class="sidebar-link">Dashboard</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#imunify-advisor" class="sidebar-link">Imunify Advisor</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#multi-server-dashboard" class="sidebar-link">Multi-server Dashboard</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#charts-and-heat-maps" class="sidebar-link">Charts and heat maps</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#incidents" class="sidebar-link">Incidents</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#firewall" class="sidebar-link">Firewall</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#white-list" class="sidebar-link">White List</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#gray-list" class="sidebar-link">Gray List</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#black-list" class="sidebar-link">Black List</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#global-black-white-list-ip-management" class="sidebar-link">Global Black/White list IP management</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#blocked-ports" class="sidebar-link">Blocked Ports</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#malware-scanner" class="sidebar-link">Malware Scanner</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#users" class="sidebar-link">Users</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#files" class="sidebar-link">Files</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#scan" class="sidebar-link">Scan</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#history" class="sidebar-link">History</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#ignore-list" class="sidebar-link">Ignore List</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#proactive-defense" class="sidebar-link">Proactive Defense</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#overview" class="sidebar-link">Overview</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#user-interface" class="sidebar-link">User Interface</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#reputation-management" class="sidebar-link">Reputation Management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#kernelcare-integration" class="sidebar-link">KernelCare Integration</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#settings" class="sidebar-link">Settings</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#general" class="sidebar-link">General</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#malware" class="sidebar-link">Malware</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#backups" class="sidebar-link">Backups</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#disabled-rules" class="sidebar-link">Disabled Rules</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#features-management" class="sidebar-link">Features Management</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#native-feature-management" class="sidebar-link">Native Feature Management</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#whm-cpanel" class="sidebar-link">WHM/cPanel</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#attributions" class="sidebar-link">Attributions</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/user_interface/" class="sidebar-link">Imunify360 User Interface</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/user_interface/#files" class="sidebar-link">Files</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/user_interface/#history" class="sidebar-link">History</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/user_interface/#ignore-list" class="sidebar-link">Ignore List</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/hosting_panels_specific_settin/" class="sidebar-link">Hosting Panels Firewall Rulesets Specific Settings</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/hosting_panels_specific_settin/#cpanel" class="sidebar-link">cPanel</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/hosting_panels_specific_settin/#modsecurity-settings" class="sidebar-link">ModSecurity Settings</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/hosting_panels_specific_settin/#plesk" class="sidebar-link">Plesk</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/hosting_panels_specific_settin/#modsecurity-configuration" class="sidebar-link">ModSecurity Configuration</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/hosting_panels_specific_settin/#directadmin" class="sidebar-link">DirectAdmin</a></div></li></ul></li><li><div class="sidebar-header sidebar-link sidebar-header--empty"><div><a href="/config_file_description/" class="sidebar-link">Config File Description</a></div></div><ul class="sidebar-sub-headers"></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/features/" class="sidebar-link">Imunify360 Features</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/features/#external-black-whitelist-management" class="sidebar-link">External Black/Whitelist Management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#rapidscan" class="sidebar-link">RapidScan</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#low-resource-usage-mode" class="sidebar-link">Low Resource Usage mode</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#exim-dovecot-brute-force-attack-protection" class="sidebar-link">Exim+Dovecot brute-force attack protection</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/features/#hooks" class="sidebar-link">Hooks</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/features/#overview" class="sidebar-link">Overview</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#how-to-start-using-hooks" class="sidebar-link">How to start using hooks</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#available-events-and-their-parameters" class="sidebar-link">Available events and their parameters</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#cli" class="sidebar-link">CLI</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#native" class="sidebar-link">Native</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#log-file" class="sidebar-link">Log File</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#structure-and-examples-of-a-hook-script" class="sidebar-link">Structure and examples of a hook script</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#notifications" class="sidebar-link">Notifications</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/features/#malware-database-scanner-mds" class="sidebar-link">Malware Database Scanner (MDS)</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/features/#how-to-use-malware-database-scanner-mds" class="sidebar-link">How to use Malware Database Scanner (MDS)</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/command_line_interface/" class="sidebar-link">Command-line Interface (CLI)</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#_3rdparty" class="sidebar-link">3rdparty</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#backup-systems" class="sidebar-link">Backup systems</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#blacklist" class="sidebar-link">Blacklist</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#blocked-ports" class="sidebar-link">Blocked ports</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#blocked-port-ip" class="sidebar-link">Blocked Port IP</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#checkdb" class="sidebar-link">Checkdb</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#check-domains" class="sidebar-link">Check-domains</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#check-modsec-directives" class="sidebar-link">Check modsec directives</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#clean" class="sidebar-link">Clean</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#config" class="sidebar-link">Config</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#doctor" class="sidebar-link">Doctor</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#eula" class="sidebar-link">Eula</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#features" class="sidebar-link">Features</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#feature-management" class="sidebar-link">Feature-management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#fix-modsec-directives" class="sidebar-link">Fix modsec directives</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#get" class="sidebar-link">Get</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#graylist" class="sidebar-link">Graylist</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#hooks" class="sidebar-link">Hooks</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#import" class="sidebar-link">Import</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#infected-domains" class="sidebar-link">Infected-domains</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#login" class="sidebar-link">Login</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#malware" class="sidebar-link">Malware</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#notifications-config" class="sidebar-link">Notifications config</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#proactive" class="sidebar-link">Proactive</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#register" class="sidebar-link">Register</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#reload-lists" class="sidebar-link">Reload lists</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#remote-proxy" class="sidebar-link">Remote-proxy</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#rstatus" class="sidebar-link">Rstatus</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#rules" class="sidebar-link">Rules</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#submit-false-positive-false-negative" class="sidebar-link">Submit false-positive/false-negative</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#unregister" class="sidebar-link">Unregister</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#vendors" class="sidebar-link">Vendors</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#version" class="sidebar-link">Version</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#whitelist" class="sidebar-link">Whitelist</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#whitelisted-crawlers" class="sidebar-link">Whitelisted crawlers</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/faq_and_known_issues/" class="sidebar-link">FAQ and Known Issues</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/faq_and_known_issues/#common-questions" class="sidebar-link">Common Questions</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_1-end-user-ip-is-blocked-and-i-do-not-know-why" class="sidebar-link">1. End user IP is blocked and I do not know why</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_2-could-i-disable-iptables-firewall-or-ossec-when-using-imunify360" class="sidebar-link">2. Could I disable IPtables (firewall) or OSSEC, when using Imunify360?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_3-does-imunify360-log-events-such-as-adding-or-removing-an-ip-to-from-the-gray-list" class="sidebar-link">3. Does Imunify360 log events such as adding or removing an IP to/from the Gray List?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_5-to-start-using-imunify360-we-need-to-know-which-information-is-sent-to-your-servers-could-you-please-give-us-some-more-information" class="sidebar-link">5. To start using Imunify360 we need to know which information is sent to your servers. Could you please give us some more information?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_6-no-valid-imunify360-license-found" class="sidebar-link">6. No valid Imunify360 License Found.</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_7-i-have-an-error-peewee-databaseerror-database-disk-image-is-malformed-what-should-i-do" class="sidebar-link">7. I have an error peewee.DatabaseError: database disk image is malformed. What should I do?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_8-why-does-my-cpanel-with-litespeed-and-owasp-modsecurity-rule-set-trigger-500-error-on-all-web-pages-after-installing-imunify360" class="sidebar-link">8. Why does my cPanel with LiteSpeed and OWASP ModSecurity rule set trigger 500 error on all web pages after installing Imunify360?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_9-disabling-waf-rules-for-certain-countries" class="sidebar-link">9. Disabling WAF rules for certain countries.</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_10-how-to-clone-imunify360-configuration-on-another-system" class="sidebar-link">10. How to clone Imunify360 configuration on another system?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_11-how-to-disable-support-icon-in-the-imunify360-ui" class="sidebar-link">11. How to disable Support icon in the Imunify360 UI?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_12-how-to-hide-the-ignore-list-tab-for-end-users-in-the-imunify360-ui" class="sidebar-link">12. How to hide the Ignore List tab for end users in the Imunify360 UI?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_13-how-to-delete-malware-scan-results-from-imunify360-s-database" class="sidebar-link">13. How to delete malware scan results from Imunify360’s database?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_14-imunify360-webshield-could-not-allocate-memory-problem-how-to-fix" class="sidebar-link">14. Imunify360 WebShield ‘Could not allocate memory’ problem. How to fix?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_15-how-to-check-modsecurity-scan-works" class="sidebar-link">15. How to check &quot;ModSecurity scan&quot; works?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_16-how-to-check-automatically-scan-all-modified-files-works" class="sidebar-link">16. How to check &quot;automatically scan all modified files&quot; works?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_17-malware-file-reasons" class="sidebar-link">17. Malware file reasons</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_18-can-imunify360-firewall-block-traffic-by-domain-name" class="sidebar-link">18. Can Imunify360 firewall block traffic by domain name?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_19-what-ports-are-used-by-webshield" class="sidebar-link">19. What ports are used by WebShield?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_20-how-to-check-that-captcha-works" class="sidebar-link">20. How to check that CAPTCHA works?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_21-how-to-edit-watched-and-excluded-patterns-for-malware-scanner" class="sidebar-link">21. How to edit watched and excluded patterns for Malware Scanner?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_22-how-to-test-rules-based-on-modsecurity-tags" class="sidebar-link">22. How to test rules based on ModSecurity tags?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_23-imunify-agent-is-not-running-troubleshooting" class="sidebar-link">23. &quot;Imunify agent is not running&quot; troubleshooting</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_24-ssh-exchange-identification-connection-closed-by-remote-host-troubleshooting" class="sidebar-link">24. &quot;sshexchangeidentification: Connection closed by remote host&quot; troubleshooting</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_25-where-can-i-find-the-files-backup-location" class="sidebar-link">25. Where can I find the files backup location?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_26-ipset-max-elements-error-hash-is-full-cannot-add-more-elements" class="sidebar-link">26. Ipset max elements error &quot;Hash is full, cannot add more elements&quot;</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_27-how-to-enable-scan-for-end-users" class="sidebar-link">27. How to enable scan for end-users?</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/faq_and_known_issues/#corner-cases" class="sidebar-link">Corner cases</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#ip-whitelisting-port-blocking-precedence" class="sidebar-link">IP whitelisting/port blocking precedence</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/faq_and_known_issues/#plesk-related" class="sidebar-link">Plesk related</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#how-to-get-an-imunify-activation-key-from-the-extended-plesk-license" class="sidebar-link">How to get an Imunify activation key from the extended Plesk license</a></div></li></ul></li></ul></li><li><div><a href="/whmcs_plugin/" class="sidebar-link">Imunify360 WHMCS Plugin</a></div></li><li><div><a href="/uninstall/" class="sidebar-link">Uninstall</a></div></li></ul></div></li></ul> </div> <div class="page"> <div class="breadcrumb-wrapper page-breadcrumb" data-v-5e0e0acf><span class="breadcrumb-title" data-v-5e0e0acf>Documentation:</span> <a href="/webshield/" class="breadcrumb router-link-exact-active router-link-active" data-v-5e0e0acf>
    WebShield
  </a></div> <div class="page-nav-wrapper"><div class="page-nav"><a href="/ids_integration/" class="nav-arrow left"></a> <a href="/backup_providers_integration/" class="nav-arrow right"></a></div></div> <div class="content content__default"><h1 id="webshield"><a href="#webshield" aria-hidden="true" class="header-anchor">#</a> WebShield</h1> <p></p><div class="table-of-contents"><ul><li><a href="#captcha">Captcha</a><ul><li><a href="#captcha-page-customization">Captcha page customization</a></li><li><a href="#update-captcha-localizations">Update Captcha localizations</a></li><li><a href="#changing-the-default-keys-to-google-recaptcha-keys">Changing the default keys to Google reCAPTCHA keys</a></li></ul></li><li><a href="#configuring-recaptcha-keys">Configuring reCAPTCHA keys</a><ul><li><a href="#how-to-specify-the-keys-for-the-imunify360-captcha">How to specify the keys for the Imunify360 CAPTCHA</a></li><li><a href="#steps-to-configure">Steps to configure</a></li><li><a href="#verification">Verification</a></li></ul></li><li><a href="#cdn-support">CDN Support</a><ul><li><a href="#splashscreen-for-chinese-customers">SplashScreen for Chinese customers</a></li><li><a href="#how-to-block-attacks-from-a-particular-country-in-webshield">How to block attacks from a particular country in WebShield</a></li></ul></li></ul></div><p></p> <div class="warning custom-block"><p class="custom-block-title">Warning</p><p>When the interface IP address is added to or deleted from the system, the restart of the webshield is required for the latter to recognize the new IP.</p></div><div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>service imunify360-webshield restart
</code></pre></div></div> <h4 id="setting-the-webshield-server-header"><a href="#setting-the-webshield-server-header" aria-hidden="true" class="header-anchor">#</a> Setting the WebShield &quot;Server&quot; header</h4> <p>Sometimes it's desired to change the WebShield &quot;Server&quot; header to something that suits certain requirements.</p> <p>To do so, locate the <span class="notranslate"><code>more_set_headers</code></span> directive in the <span class="notrabslate"><code>/etc/imunify360-webshield/webshield.conf</code></span> file.</p> <p>By default, the directive contains the <span class="notranslate"><code>&quot;Server: imunify360-webshield/1.8&quot;;</code></span> value. You can set string after the colon to whatever suits your needs.</p> <h2 id="captcha"><a href="#captcha" aria-hidden="true" class="header-anchor">#</a> Captcha</h2> <p>The CAPTCHA is a feature intended to distinguish human from machine input and protect websites from the spam and different types of automated abuse. Imunify360 uses <a href="https://www.google.com/recaptcha/intro/invisible.html" target="_blank" rel="noopener noreferrer">reCAPTCHA<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> service.</p> <div class="warning custom-block"><p class="custom-block-title">Warning</p><p>Please note that the WebShield Captcha is not compatible with aggressive CDN caching modes, like Cloudflare 'cache everything' with 'Edge Cache TTL'. If the Сaptcha page is cached by CDN, a visitor will see the Captcha from CDN cache disregarding it has been passed or not. In order to fix that, either disable the aggressive CDN caching or the Captcha functionality in the Imunify360.</p></div><p>There are two layers in CAPTCHA behavior:</p> <ol><li>If a user of a website is added to the <span class="notranslate">Grey List</span> (the access is blocked), then the CAPTCHA allows him to unblock himself. When he tries to get to the website he is redirected to the Captcha Server by ipset, where he can see the protection page asking to confirm that he is not a robot by ticking a checkbox.</li></ol> <p><img src="/images/captcha.jpg" alt=""></p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>The IP address on the screenshot above is given as an example.</p></div><p>If successful, a user is redirected to the website, which means that the access is unblocked and the IP address of this user is removed from the <span class="notranslate">Grey List</span>.</p> <p>It is also possible to enable the invisible reCAPTCHA via the Imunify360 <a href="/dashboard/#settings"><span class="notranslate">Settings</span> page</a>. With the invisible reCAPTCHA enabled, a human user is not required to go through human confirmation - the process will pass under the hood and a user will be redirected to the website. In case if invisible reCAPTCHA failed to detect if a user is a human or not, then visible reCAPTCHA appears.</p> <ol start="2"><li>The CAPTCHA is always on guard of the websites and checks the activity of each IP. With the help of reCAPTCHA it blocks bots and protects websites from spam and abuse. To learn more about reCAPTCHA follow the <a href="https://www.google.com/recaptcha/intro/" target="_blank" rel="noopener noreferrer">link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li></ol> <p>The reCaptcha supports localization. Depending on user’s browser settings, reCaptcha will use the browser default language and allow to change it:</p> <p><img src="/images/local.jpg" alt=""></p> <h3 id="captcha-page-customization"><a href="#captcha-page-customization" aria-hidden="true" class="header-anchor">#</a> Captcha page customization</h3> <p>To modify footer, header or body of the CAPTCHA use the templates in <span class="notranslate"><code>/usr/share/imunify360-webshield/captcha/templates/</code></span>.</p> <p>There are three files:</p> <ul><li><p><span class="notranslate"><code>head.tpl</code></span> – this file goes inside <span class="notranslate"><code>&lt;head&gt;&lt;/head&gt;</code></span> tags. So you can add JavaScript, CSS styles, etc.</p></li> <li><p><span class="notranslate"><code>body.tpl</code></span> – the main template file, modify it as you wish. CAPTCHA goes above all the layers.</p></li> <li><p><span class="notranslate"><code>static</code></span> – here you can place images, CSS, JavaScript, etc. and access these files as <span class="notranslate"><code>/static/&lt;filename&gt;</code></span>.</p></li></ul> <p>To find information on supported browsers follow this link <a href="https://support.google.com/recaptcha/answer/6223828" target="_blank" rel="noopener noreferrer">https://support.google.com/recaptcha/answer/6223828<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="update-captcha-localizations"><a href="#update-captcha-localizations" aria-hidden="true" class="header-anchor">#</a> Update Captcha localizations</h3> <p>A user can change the text of captcha messages for the supported languages. Note that adding custom language is not supported.</p> <p>To change the text of the Imunify360 Captcha and update the localizations text, please do the following:</p> <ol><li><p>Locate appropriate Captcha localization files by running:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>ls /usr/share/imunify360-webshield/captcha/translations/locale/{lang}/LC_MESSAGES/messages.po
</code></pre></div></div>
For example for Polish language the catalog looks like this: 
 <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>/usr/share/imunify360-webshield/captcha/translations/locale/pl/LC_MESSAGES/messages.po
</code></pre></div></div></li> <li><p>Update Captcha localization files by editing <span class="notranslate"><code>msgstr &quot;my customization or translation&quot;</code></span> for appropriate <span class="notranslate"><code>msgid “original plain english text&quot;</code></span>.</p> <p>Where <span class="notranslate"><code>msgstr</code></span> contains text that is shown to user and <span class="notranslate"><code>msgid</code></span> contains Captcha original English text.</p> <p>For example:</p> <div class="notranslate"><div class="language-HTML extra-class"><pre class="language-html"><code>#: templates/index.html:154
msgid &quot;&quot;
&quot;We have noticed an unusual activity from your <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>IP {client_ip}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span> and &quot;
&quot;blocked access to this website.&quot;
msgstr &quot;&quot;
&quot;Zauważyliśmy nietypową aktywność związaną z twoim adresem <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>IP &quot;
&quot;{client_ip}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span> i zablokowaliśmy dostęp do tej strony internetowej&quot;
</code></pre></div></div></li> <li><p>To add Polish translation edit text in the <span class="notranslate"><code>msgstr</code></span> field. To change the text for a default English translation, edit text in the <span class="notranslate"><code>msgid</code></span> field.</p></li> <li><p>Save files.</p></li> <li><p>When translation in <span class="notranslate"><code>messages.po</code></span> files is finished, restart <span class="notranslate">imunify360-webshield</span> service:</p></li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>service imunify360-webshield restart
</code></pre></div></div>
6. Block yourself (remove your IP from <span class="notranslate">Imunify360 White List</span> and try to log in to the server via ssh with wrong password until it blocks you). Then go to website and log in. Captcha should appear. Set Polish language and assert that new text is displayed.
<h3 id="changing-the-default-keys-to-google-recaptcha-keys"><a href="#changing-the-default-keys-to-google-recaptcha-keys" aria-hidden="true" class="header-anchor">#</a> Changing the default keys to Google reCAPTCHA keys</h3> <p>If a server owner has his own Google reCAPTCHA keys (both private and public), he may use them instead of the default CloudLinux keys.</p> <p>To set Google reCAPTCHA keys, place your keys into the <span class="notranslate"><code>/etc/imunify360-webshield/webshield-http.conf.d/captchakeys.conf</code></span> file as shown in the example below:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>captcha_site_key &lt;YOUR_SITE_KEY&gt;;
captcha_secret_key &lt;YOUR_SECRET_KEY&gt;;
</code></pre></div></div> <p>Then reload WebShield.</p> <h2 id="configuring-recaptcha-keys"><a href="#configuring-recaptcha-keys" aria-hidden="true" class="header-anchor">#</a> Configuring reCAPTCHA keys</h2> <p>See <a href="/dashboard/#invisible-captcha">how to setup invisible CAPTCHA</a>.</p> <h4 id="why-do-you-need-to-specify-the-google-recaptcha-keys-in-the-imunify360-product"><a href="#why-do-you-need-to-specify-the-google-recaptcha-keys-in-the-imunify360-product" aria-hidden="true" class="header-anchor">#</a> Why do you need to specify the Google reCAPTCHA keys in the Imunify360 product</h4> <p>Imunify360 admin should specify reCAPTCHA keys for the server since we’re planning to completely remove embedded reCAPTCHA keys in the future versions.</p> <p>In this article, you can find a step by step guide on how to set up a custom site and secret keys for your Imunify360 server.</p> <h3 id="how-to-specify-the-keys-for-the-imunify360-captcha"><a href="#how-to-specify-the-keys-for-the-imunify360-captcha" aria-hidden="true" class="header-anchor">#</a> How to specify the keys for the Imunify360 CAPTCHA</h3> <p>Public and secret reCAPTCHA keys are required for integration between Imunify360 and Google reCAPTCHA service.</p> <p>The site key will be publicly available and shown on pages along with reCAPTCHA widget or Invisible CAPTCHA, whereas the secret key will be stored for intercommunication between the backend of Imunify360 and Google service.</p> <div class="tip custom-block"><p class="custom-block-title">Note: Due to the captcha rate limit we recommend using different reCAPTCHA keys for each server.</p><p><a href="https://developers.google.com/recaptcha/docs/faq#are-there-any-qps-or-daily-limits-on-my-use-of-recaptcha" target="_blank" rel="noopener noreferrer">Google’s quotation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:
If you wish to make more than 1k calls per second or 1m calls per month, you must use reCAPTCHA Enterprise or fill out this form and wait for an exception approval.</p></div><h3 id="steps-to-configure"><a href="#steps-to-configure" aria-hidden="true" class="header-anchor">#</a> Steps to configure</h3> <ol><li><p>Open <a href="https://www.google.com/recaptcha/admin/create" target="_blank" rel="noopener noreferrer">https://www.google.com/recaptcha/admin/create<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p>Fill in required values</p> <ul><li>Set any value as a label, e.g. <span class="notranslate"><em>my servers cluster #1</em></span></li> <li>Select <em>reCAPTCHA v2</em></li> <li>Select <span class="notranslate"><em>Invisible reCAPTCHA badge</em></span></li> <li>Add any dummy domain, e.g. <span class="notranslate"><em>example.org</em></span></li></ul> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>You don’t need to put all your domains here</p></div><p><img src="/images/reCaptchaRegister.png" alt=""></p></li> <li><p>Accept terms and proceed</p></li> <li><p>Notice keys</p> <p><img src="/images/reCaptchaNoticeKeys.png" alt=""></p></li> <li><p>You need to put these keys on the Imunify360 settings page</p> <p><img src="/images/reCaptchaImunifyKeys.png" alt=""></p> <p>or use the following CLI commands:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># imunify360-agent config update '{&quot;WEBSHIELD&quot;: {&quot;captcha_site_key&quot;: &quot;6Ldu4XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXCN6fJ&quot;}}'

# imunify360-agent config update '{&quot;WEBSHIELD&quot;: {&quot;captcha_secret_key&quot;: &quot;6Ldu4XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXQqUuk&quot;}}'
</code></pre></div></div></li> <li><p>The final step is to allow Google to process requests from any of your domains</p> <ul><li><p>Open the <span class="notranslate"><em>Settings</em></span> page</p> <p><img src="/images/reCaptchaVerify.png" alt=""></p></li> <li><p>And disable the <span class="notranslate"><em>Verify the origin of reCAPTCHA solutions</em></span></p> <p><img src="/images/reCaptchaVerifyDisable.png" alt=""></p></li></ul></li></ol> <p>That’s it.</p> <h3 id="verification"><a href="#verification" aria-hidden="true" class="header-anchor">#</a> Verification</h3> <p>In order to make sure that you’ve done everything correctly you need to do the following:</p> <ol><li><p>Make sure that your IP is not whitelisted (using the CLI):</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># imunify360-agent whitelist ip list
IP          TTL    COUNTRY  IMPORTED_FROM  COMMENT
1.2.3.4     10256  None     None           Whitelisted for 3 hours due to successful panel login

# imunify360-agent whitelist ip delete 1.2.3.4
OK

# imunify360-agent whitelist ip list
IP          TTL    COUNTRY  IMPORTED_FROM  COMMENT
</code></pre></div></div></li> <li><p>Make sure your target domain is not <a href="/terminology/">whitelisted</a>:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># imunify360-agent whitelist domain list
example.com
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code># imunify360-agent whitelist domain delete example.com
OK
</code></pre></div><div></div></div></li> <li><p>Send at least two WAF test requests to any domain on the server</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># curl -v http://example.org/?i360test=88ff0adf94a190b9d1311c8b50fe2891c85af732
</code></pre></div></div></li> <li><p>Open your test domain in the browser and let it pass the captcha challenge</p></li> <li><p>Check the list of whitelisted IPs again</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># imunify360-agent whitelist ip list
IP          TTL    COUNTRY  IMPORTED_FROM  COMMENT
1.2.3.4     86377  None     None           IP auto-whitelisted with expiration date: 2020-05-28 15:29:34

</code></pre></div></div></li></ol> <p>If you see that your IP is whitelisted then integration between Imunify360 and reCAPTCHA service was <strong>done properly</strong>.</p> <p>You can watch how invisible reCAPTCHA works at <a href="https://www.youtube.com/watch?v=GQXmAj5hyDo" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=GQXmAj5hyDo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>It is also possible to test Captcha by the server IP. Find more information <a href="/faq_and_known_issues/#_20-how-to-check-that-captcha-works">here</a></p></div><h2 id="cdn-support"><a href="#cdn-support" aria-hidden="true" class="header-anchor">#</a> CDN Support</h2> <p>Imunify360 correctly graylists and blocks IPs behind Cloudflare and other CDNs (see <a href="/webshield/#supported-cdn-providers">here</a> for the full list).</p> <p>Imunify360 passes all requests from CDN through <span class="notranslate">WebShield</span>, and uses <span class="notranslate">CF-Connecting-IP</span> and <span class="notranslate">X-Forwarded-For</span> headers to identify real IPs.</p> <p>To enable it now, run the command:</p> <div class="notranslate"><div class="language-sh extra-class"><pre class="language-sh"><code>imunify360-agent config update <span class="token string">'{&quot;WEBSHIELD&quot;: {&quot;known_proxies_support&quot;: true}}'</span>
</code></pre></div></div> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>If you are using cPanel/EasyApache3, Imunify360 will not automatically deploy <em>mod_remoteip</em>, and log files will show local server IP for visitors coming from CDN. EasyApache 3 is EOL since December 2018, and we don't plan to add automated <em>mod_remoteip</em> setup and configuration for it.</p></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>For cPanel/EasyApache 4, Plesk, DirectAdmin and LiteSpeed <em>mod_remoteip</em> will be automatically installed and configured.</p></div><h4 id="supported-cdn-providers"><a href="#supported-cdn-providers" aria-hidden="true" class="header-anchor">#</a> Supported CDN providers:</h4> <ul><li>Cloudflare</li> <li>MaxCDN</li> <li>StackPath CDN</li> <li>KeyCDN</li> <li>Dartspeed.com</li> <li>QUIC.cloud CDN</li> <li>NuCDN</li> <li>Google CDN</li> <li>CloudFront CDN</li> <li>GoCache CDN</li> <li>Opera</li> <li>QUANTIL</li> <li>QUIC.cloud CDN</li> <li>BunnyCDN</li> <li>Sucuri WAF</li></ul> <h3 id="splashscreen-for-chinese-customers"><a href="#splashscreen-for-chinese-customers" aria-hidden="true" class="header-anchor">#</a> SplashScreen for Chinese customers</h3> <p>Imunify360 Captcha isn't available in some countries due to certain restrictions, for example, in China. To alleviate this, Chinese customers can use Imunify360 SplashScreen as Captcha.</p> <p>To enable SplashScreen, open the file <span class="notranslate"><code>/etc/imunify360-webshield/wscheck.conf</code></span>, find the following line:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>wscheck_splashscreen_as_captcha off;
</code></pre></div></div> <p>Change <span class="notranslate"><code>off</code></span> to <span class="notranslate"><code>on</code></span>:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>wscheck_splashscreen_as_captcha on;
</code></pre></div></div> <p>Save the file and run the following command:</p> <p><strong>For Ubuntu:</strong></p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>service imunify360-websheld reload
</code></pre></div></div> <p><strong>For CentOS:</strong></p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>systemctl reload imunify360-webshield
</code></pre></div></div> <p>The graylisted visitors will see such screen for 5 seconds before redirecting to their initial destination.</p> <p><img src="/images/splash_as_captcha.png" alt=""></p> <div class="warning custom-block"><p class="custom-block-title">Note</p><p>You can find WebShield and Captcha related logs in the <span class="notranslate"><code>/var/log/imunify360-webshield/</code></span> file.</p></div><h3 id="how-to-block-attacks-from-a-particular-country-in-webshield"><a href="#how-to-block-attacks-from-a-particular-country-in-webshield" aria-hidden="true" class="header-anchor">#</a> How to block attacks from a particular country in WebShield</h3> <p>Country blocking is available in both <a href="/dashboard/#black-list">Admin UI</a> and <a href="/command_line_interface/#blacklist">CLI</a></p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/cloudlinux/imunify360-doc/edit/dev/docs/webshield/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="back-to-top" data-v-5366e0dd><a href="/webshield/#app" class="nav-arrow top back-to-top__link" data-v-5366e0dd></a></div> </div> <div class="footer" data-v-3ca314c6><div data-v-3ca314c6><a href="https://cloudlinux.com" data-v-3ca314c6><img src="/assets/img/we-are-cloudlinux.783ed390.svg" alt="We are Cloudlinux" data-v-3ca314c6></a></div> <div class="footer-company-title" data-v-3ca314c6>2021. CloudLinux Inc</div> <div data-v-3ca314c6><div data-v-3ca314c6><a href="https://cloudlinux.zendesk.com/hc/en-us/categories/360002375980-Imunify-Security-Products" target="_blank" data-v-3ca314c6>How to</a></div><div data-v-3ca314c6><a href="https://www.imunify360.com/getting-started" target="_blank" data-v-3ca314c6>Getting started</a></div><div data-v-3ca314c6><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" data-v-3ca314c6>Contact support</a></div><div data-v-3ca314c6><a href="https://blog.imunify360.com" target="_blank" data-v-3ca314c6>Blog</a></div></div> <div class="social" data-v-3ca314c6><span class="footer-social-text" data-v-3ca314c6>Stay in touch</span> <a href="https://www.facebook.com/imunify360/" target="_blank" data-v-3ca314c6><img src="/fb.png" class="footer-social-logo" data-v-3ca314c6></a><a href="https://twitter.com/imunify360/" target="_blank" data-v-3ca314c6><img src="/tw.png" class="footer-social-logo" data-v-3ca314c6></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-3ca314c6><img src="/in.png" class="footer-social-logo" data-v-3ca314c6></a><a href="https://www.youtube.com/channel/UCcW6dDJjcy41c7Hl_5LdLZQ" target="_blank" data-v-3ca314c6><img src="/ytube.png" class="footer-social-logo" data-v-3ca314c6></a></div></div> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8f538a27.js" defer></script><script src="/assets/js/4.ad788cf3.js" defer></script><script src="/assets/js/1.ac56a00f.js" defer></script><script src="/assets/js/62.934d99c2.js" defer></script>
  </body>
</html>
