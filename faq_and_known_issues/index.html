<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>FAQ and Known Issues | Documentation</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="If you use CSF, then try to find the IP in CSF Allow/Deny Lists using their documentation and support. If not, then do the following:">
    <meta name="image" content="https://docs.imunify360.com/images/ImunifyAgentNotRunning.png">
    <meta name="twitter:title" content="FAQ and Known Issues">
    <meta name="twitter:description" content="If you use CSF, then try to find the IP in CSF Allow/Deny Lists using their documentation and support. If not, then do the following:">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://docs.imunify360.com/images/ImunifyAgentNotRunning.png">
    <meta name="twitter:url" content="https://docs.imunify360.com/faq_and_known_issues/">
    <meta property="og:type" content="article">
    <meta property="og:title" content="FAQ and Known Issues">
    <meta property="og:description" content="If you use CSF, then try to find the IP in CSF Allow/Deny Lists using their documentation and support. If not, then do the following:">
    <meta property="og:image" content="https://docs.imunify360.com/images/ImunifyAgentNotRunning.png">
    <meta property="og:url" content="https://docs.imunify360.com/faq_and_known_issues/">
    <meta property="og:site_name" content="Imunify 360 Documentation">
    <meta itemprop="name" content="FAQ and Known Issues">
    <meta itemprop="description" content="If you use CSF, then try to find the IP in CSF Allow/Deny Lists using their documentation and support. If not, then do the following:">
    <meta itemprop="image" content="https://docs.imunify360.com/images/ImunifyAgentNotRunning.png">
    <link rel="preload" href="/assets/css/0.styles.6006968c.css" as="style"><link rel="preload" href="/assets/js/app.8f538a27.js" as="script"><link rel="preload" href="/assets/js/4.ad788cf3.js" as="script"><link rel="preload" href="/assets/js/1.ac56a00f.js" as="script"><link rel="preload" href="/assets/js/28.fa9dc82b.js" as="script"><link rel="prefetch" href="/assets/js/10.c28c2ce4.js"><link rel="prefetch" href="/assets/js/11.ecb5ecdf.js"><link rel="prefetch" href="/assets/js/12.bebabae6.js"><link rel="prefetch" href="/assets/js/13.922873af.js"><link rel="prefetch" href="/assets/js/14.aa3cdb24.js"><link rel="prefetch" href="/assets/js/15.0f275457.js"><link rel="prefetch" href="/assets/js/16.d493685a.js"><link rel="prefetch" href="/assets/js/17.f6d2650c.js"><link rel="prefetch" href="/assets/js/18.55041527.js"><link rel="prefetch" href="/assets/js/19.e19b2aac.js"><link rel="prefetch" href="/assets/js/20.ff5b0bf4.js"><link rel="prefetch" href="/assets/js/21.2c93ea93.js"><link rel="prefetch" href="/assets/js/22.cbc20958.js"><link rel="prefetch" href="/assets/js/23.ba18fca1.js"><link rel="prefetch" href="/assets/js/24.2305918e.js"><link rel="prefetch" href="/assets/js/25.bfa6f6a8.js"><link rel="prefetch" href="/assets/js/26.106d44b6.js"><link rel="prefetch" href="/assets/js/27.50b92db3.js"><link rel="prefetch" href="/assets/js/29.c1a62275.js"><link rel="prefetch" href="/assets/js/30.c5991493.js"><link rel="prefetch" href="/assets/js/31.24418d61.js"><link rel="prefetch" href="/assets/js/32.60f2cf7b.js"><link rel="prefetch" href="/assets/js/33.9e23ba42.js"><link rel="prefetch" href="/assets/js/34.802ede2c.js"><link rel="prefetch" href="/assets/js/35.cd6f9b1f.js"><link rel="prefetch" href="/assets/js/36.27b9d486.js"><link rel="prefetch" href="/assets/js/37.8eaf62ec.js"><link rel="prefetch" href="/assets/js/38.49a5f959.js"><link rel="prefetch" href="/assets/js/39.8edfc7ec.js"><link rel="prefetch" href="/assets/js/40.d4834493.js"><link rel="prefetch" href="/assets/js/41.4ecce336.js"><link rel="prefetch" href="/assets/js/42.5758db9d.js"><link rel="prefetch" href="/assets/js/43.c2196607.js"><link rel="prefetch" href="/assets/js/44.c303d7b2.js"><link rel="prefetch" href="/assets/js/45.5657a3e1.js"><link rel="prefetch" href="/assets/js/46.7401098e.js"><link rel="prefetch" href="/assets/js/47.666cbf98.js"><link rel="prefetch" href="/assets/js/48.e9068ece.js"><link rel="prefetch" href="/assets/js/49.f9866028.js"><link rel="prefetch" href="/assets/js/5.a791a612.js"><link rel="prefetch" href="/assets/js/50.b083857b.js"><link rel="prefetch" href="/assets/js/51.0bbf32ee.js"><link rel="prefetch" href="/assets/js/52.ba794043.js"><link rel="prefetch" href="/assets/js/53.8968d12f.js"><link rel="prefetch" href="/assets/js/54.749e0af6.js"><link rel="prefetch" href="/assets/js/55.16839767.js"><link rel="prefetch" href="/assets/js/56.478c922f.js"><link rel="prefetch" href="/assets/js/57.8fbd5f38.js"><link rel="prefetch" href="/assets/js/58.0be5b685.js"><link rel="prefetch" href="/assets/js/59.1cba522b.js"><link rel="prefetch" href="/assets/js/6.ecbbd367.js"><link rel="prefetch" href="/assets/js/60.1672bf0a.js"><link rel="prefetch" href="/assets/js/61.5363a453.js"><link rel="prefetch" href="/assets/js/62.934d99c2.js"><link rel="prefetch" href="/assets/js/63.17e5db2d.js"><link rel="prefetch" href="/assets/js/64.8600bb47.js"><link rel="prefetch" href="/assets/js/65.afafe3d8.js"><link rel="prefetch" href="/assets/js/7.8c8d2896.js"><link rel="prefetch" href="/assets/js/8.181ff140.js"><link rel="prefetch" href="/assets/js/9.f158522a.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.38015cce.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6006968c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/introduction/" class="home-link"><img src="/logo.svg" alt="Documentation" class="logo"> <span class="site-name site-name--documentation can-hide">Documentation</span></a> <form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <div class="links" style="max-width:nullpx;"><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" class="btn">
      Submit Request
    </a> <a href="https://www.imunify360.com/trial" target="_blank" class="btn">
      Try Free
    </a> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><span class="title">Language:</span> <a class="dropdown-title"><span class="text">En</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/faq_and_known_issues/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/ru/faq_and_known_issues/" class="nav-link">Русский</a></li></ul></div></div></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><span class="title">Language:</span> <a class="dropdown-title"><span class="text">En</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/faq_and_known_issues/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/ru/faq_and_known_issues/" class="nav-link">Русский</a></li></ul></div></div></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><div class="sidebar-heading open"><span>Contents</span> <!----></div> <ul class="sidebar-group-items"><li><div><a href="/introduction/" class="sidebar-link">Introduction</a></div></li><li><div><a href="/terminology/" class="sidebar-link">Terminology</a></div></li><li><div><a href="/billing/" class="sidebar-link">Billing</a></div></li><li><div class="sidebar-header sidebar-link"><div><a href="/installation/" class="sidebar-link">Installation Guide</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/installation/#requirements" class="sidebar-link">Requirements</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/installation/#side-by-side-installation-with-another-ids" class="sidebar-link">Side by side installation with another</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/installation/#installation-instructions" class="sidebar-link">Installation Instructions</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/installation/#registering" class="sidebar-link">Registering</a></div></li><li class="sidebar-sub-header"><div><a href="/installation/#selinux-support" class="sidebar-link">SELinux support</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/installation/#update-instructions" class="sidebar-link">Update Instructions</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/installation/#gradual-roll-out" class="sidebar-link">Gradual roll-out</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link sidebar-header--empty"><div><a href="/stand_alone/" class="sidebar-link">Imunify360 Stand-alone</a></div></div><ul class="sidebar-sub-headers"></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/ids_integration/" class="sidebar-link">IDS Integrations</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/ids_integration/#csf-integration" class="sidebar-link">CSF Integration</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/ids_integration/#cxs-integration" class="sidebar-link">CXS Integration</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/webshield/" class="sidebar-link">WebShield</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/webshield/#captcha" class="sidebar-link">Captcha</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/webshield/#captcha-page-customization" class="sidebar-link">Captcha page customization</a></div></li><li class="sidebar-sub-header"><div><a href="/webshield/#update-captcha-localizations" class="sidebar-link">Update Captcha localizations</a></div></li><li class="sidebar-sub-header"><div><a href="/webshield/#changing-the-default-keys-to-google-recaptcha-keys" class="sidebar-link">Changing the default keys to Google reCAPTCHA keys</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/webshield/#configuring-recaptcha-keys" class="sidebar-link">Configuring reCAPTCHA keys</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/webshield/#how-to-specify-the-keys-for-the-imunify360-captcha" class="sidebar-link">How to specify the keys for the Imunify360 CAPTCHA</a></div></li><li class="sidebar-sub-header"><div><a href="/webshield/#steps-to-configure" class="sidebar-link">Steps to configure</a></div></li><li class="sidebar-sub-header"><div><a href="/webshield/#verification" class="sidebar-link">Verification</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/webshield/#cdn-support" class="sidebar-link">CDN Support</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/webshield/#splashscreen-for-chinese-customers" class="sidebar-link">SplashScreen for Chinese customers</a></div></li><li class="sidebar-sub-header"><div><a href="/webshield/#how-to-block-attacks-from-a-particular-country-in-webshield" class="sidebar-link">How to block attacks from a particular country in WebShield</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/backup_providers_integration/" class="sidebar-link">Backup Providers Integration</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/backup_providers_integration/#overview" class="sidebar-link">Overview</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/backup_providers_integration/#command-line-usage" class="sidebar-link">Command Line Usage</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#synopsis" class="sidebar-link">Synopsis</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#actions" class="sidebar-link">Actions</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/backup_providers_integration/#using-as-library" class="sidebar-link">Using as Library</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#restoring-infected-files" class="sidebar-link">Restoring Infected Files</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#operating-with-backend" class="sidebar-link">Operating With Backend</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#operating-with-backup" class="sidebar-link">Operating With Backup</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#operating-with-file-in-backup" class="sidebar-link">Operating With File in Backup</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/backup_providers_integration/#creating-custom-backup-backend-plugin" class="sidebar-link">Creating Custom Backup Backend Plugin</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#creating-module" class="sidebar-link">Creating Module</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#defining-classes" class="sidebar-link">Defining Classes</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#implementing-api-functions" class="sidebar-link">Implementing API Functions</a></div></li></ul></li></ul></li><li><div><a href="/localization/" class="sidebar-link">Localization</a></div></li><li><div class="sidebar-header sidebar-link"><div><a href="/dashboard/" class="sidebar-link">Imunify360 Admin Interface</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#support" class="sidebar-link">Support</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#dashboard" class="sidebar-link">Dashboard</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#imunify-advisor" class="sidebar-link">Imunify Advisor</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#multi-server-dashboard" class="sidebar-link">Multi-server Dashboard</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#charts-and-heat-maps" class="sidebar-link">Charts and heat maps</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#incidents" class="sidebar-link">Incidents</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#firewall" class="sidebar-link">Firewall</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#white-list" class="sidebar-link">White List</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#gray-list" class="sidebar-link">Gray List</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#black-list" class="sidebar-link">Black List</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#global-black-white-list-ip-management" class="sidebar-link">Global Black/White list IP management</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#blocked-ports" class="sidebar-link">Blocked Ports</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#malware-scanner" class="sidebar-link">Malware Scanner</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#users" class="sidebar-link">Users</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#files" class="sidebar-link">Files</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#scan" class="sidebar-link">Scan</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#history" class="sidebar-link">History</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#ignore-list" class="sidebar-link">Ignore List</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#proactive-defense" class="sidebar-link">Proactive Defense</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#overview" class="sidebar-link">Overview</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#user-interface" class="sidebar-link">User Interface</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#reputation-management" class="sidebar-link">Reputation Management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#kernelcare-integration" class="sidebar-link">KernelCare Integration</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#settings" class="sidebar-link">Settings</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#general" class="sidebar-link">General</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#malware" class="sidebar-link">Malware</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#backups" class="sidebar-link">Backups</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#disabled-rules" class="sidebar-link">Disabled Rules</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#features-management" class="sidebar-link">Features Management</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#native-feature-management" class="sidebar-link">Native Feature Management</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#whm-cpanel" class="sidebar-link">WHM/cPanel</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#attributions" class="sidebar-link">Attributions</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/user_interface/" class="sidebar-link">Imunify360 User Interface</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/user_interface/#files" class="sidebar-link">Files</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/user_interface/#history" class="sidebar-link">History</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/user_interface/#ignore-list" class="sidebar-link">Ignore List</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/hosting_panels_specific_settin/" class="sidebar-link">Hosting Panels Firewall Rulesets Specific Settings</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/hosting_panels_specific_settin/#cpanel" class="sidebar-link">cPanel</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/hosting_panels_specific_settin/#modsecurity-settings" class="sidebar-link">ModSecurity Settings</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/hosting_panels_specific_settin/#plesk" class="sidebar-link">Plesk</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/hosting_panels_specific_settin/#modsecurity-configuration" class="sidebar-link">ModSecurity Configuration</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/hosting_panels_specific_settin/#directadmin" class="sidebar-link">DirectAdmin</a></div></li></ul></li><li><div class="sidebar-header sidebar-link sidebar-header--empty"><div><a href="/config_file_description/" class="sidebar-link">Config File Description</a></div></div><ul class="sidebar-sub-headers"></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/features/" class="sidebar-link">Imunify360 Features</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/features/#external-black-whitelist-management" class="sidebar-link">External Black/Whitelist Management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#rapidscan" class="sidebar-link">RapidScan</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#low-resource-usage-mode" class="sidebar-link">Low Resource Usage mode</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#exim-dovecot-brute-force-attack-protection" class="sidebar-link">Exim+Dovecot brute-force attack protection</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/features/#hooks" class="sidebar-link">Hooks</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/features/#overview" class="sidebar-link">Overview</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#how-to-start-using-hooks" class="sidebar-link">How to start using hooks</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#available-events-and-their-parameters" class="sidebar-link">Available events and their parameters</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#cli" class="sidebar-link">CLI</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#native" class="sidebar-link">Native</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#log-file" class="sidebar-link">Log File</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#structure-and-examples-of-a-hook-script" class="sidebar-link">Structure and examples of a hook script</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#notifications" class="sidebar-link">Notifications</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/features/#malware-database-scanner-mds" class="sidebar-link">Malware Database Scanner (MDS)</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/features/#how-to-use-malware-database-scanner-mds" class="sidebar-link">How to use Malware Database Scanner (MDS)</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/command_line_interface/" class="sidebar-link">Command-line Interface (CLI)</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#_3rdparty" class="sidebar-link">3rdparty</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#backup-systems" class="sidebar-link">Backup systems</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#blacklist" class="sidebar-link">Blacklist</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#blocked-ports" class="sidebar-link">Blocked ports</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#blocked-port-ip" class="sidebar-link">Blocked Port IP</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#checkdb" class="sidebar-link">Checkdb</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#check-domains" class="sidebar-link">Check-domains</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#check-modsec-directives" class="sidebar-link">Check modsec directives</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#clean" class="sidebar-link">Clean</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#config" class="sidebar-link">Config</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#doctor" class="sidebar-link">Doctor</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#eula" class="sidebar-link">Eula</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#features" class="sidebar-link">Features</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#feature-management" class="sidebar-link">Feature-management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#fix-modsec-directives" class="sidebar-link">Fix modsec directives</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#get" class="sidebar-link">Get</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#graylist" class="sidebar-link">Graylist</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#hooks" class="sidebar-link">Hooks</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#import" class="sidebar-link">Import</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#infected-domains" class="sidebar-link">Infected-domains</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#login" class="sidebar-link">Login</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#malware" class="sidebar-link">Malware</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#notifications-config" class="sidebar-link">Notifications config</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#proactive" class="sidebar-link">Proactive</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#register" class="sidebar-link">Register</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#reload-lists" class="sidebar-link">Reload lists</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#remote-proxy" class="sidebar-link">Remote-proxy</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#rstatus" class="sidebar-link">Rstatus</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#rules" class="sidebar-link">Rules</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#submit-false-positive-false-negative" class="sidebar-link">Submit false-positive/false-negative</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#unregister" class="sidebar-link">Unregister</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#vendors" class="sidebar-link">Vendors</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#version" class="sidebar-link">Version</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#whitelist" class="sidebar-link">Whitelist</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#whitelisted-crawlers" class="sidebar-link">Whitelisted crawlers</a></div></li></ul></li><li><div class="active collapsed sidebar-header sidebar-link"><div class="active"><a href="/faq_and_known_issues/" class="active sidebar-link">FAQ and Known Issues</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/faq_and_known_issues/#common-questions" class="sidebar-link">Common Questions</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_1-end-user-ip-is-blocked-and-i-do-not-know-why" class="sidebar-link">1. End user IP is blocked and I do not know why</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_2-could-i-disable-iptables-firewall-or-ossec-when-using-imunify360" class="sidebar-link">2. Could I disable IPtables (firewall) or OSSEC, when using Imunify360?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_3-does-imunify360-log-events-such-as-adding-or-removing-an-ip-to-from-the-gray-list" class="sidebar-link">3. Does Imunify360 log events such as adding or removing an IP to/from the Gray List?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_5-to-start-using-imunify360-we-need-to-know-which-information-is-sent-to-your-servers-could-you-please-give-us-some-more-information" class="sidebar-link">5. To start using Imunify360 we need to know which information is sent to your servers. Could you please give us some more information?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_6-no-valid-imunify360-license-found" class="sidebar-link">6. No valid Imunify360 License Found.</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_7-i-have-an-error-peewee-databaseerror-database-disk-image-is-malformed-what-should-i-do" class="sidebar-link">7. I have an error peewee.DatabaseError: database disk image is malformed. What should I do?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_8-why-does-my-cpanel-with-litespeed-and-owasp-modsecurity-rule-set-trigger-500-error-on-all-web-pages-after-installing-imunify360" class="sidebar-link">8. Why does my cPanel with LiteSpeed and OWASP ModSecurity rule set trigger 500 error on all web pages after installing Imunify360?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_9-disabling-waf-rules-for-certain-countries" class="sidebar-link">9. Disabling WAF rules for certain countries.</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_10-how-to-clone-imunify360-configuration-on-another-system" class="sidebar-link">10. How to clone Imunify360 configuration on another system?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_11-how-to-disable-support-icon-in-the-imunify360-ui" class="sidebar-link">11. How to disable Support icon in the Imunify360 UI?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_12-how-to-hide-the-ignore-list-tab-for-end-users-in-the-imunify360-ui" class="sidebar-link">12. How to hide the Ignore List tab for end users in the Imunify360 UI?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_13-how-to-delete-malware-scan-results-from-imunify360-s-database" class="sidebar-link">13. How to delete malware scan results from Imunify360’s database?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_14-imunify360-webshield-could-not-allocate-memory-problem-how-to-fix" class="sidebar-link">14. Imunify360 WebShield ‘Could not allocate memory’ problem. How to fix?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_15-how-to-check-modsecurity-scan-works" class="sidebar-link">15. How to check &quot;ModSecurity scan&quot; works?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_16-how-to-check-automatically-scan-all-modified-files-works" class="sidebar-link">16. How to check &quot;automatically scan all modified files&quot; works?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_17-malware-file-reasons" class="sidebar-link">17. Malware file reasons</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_18-can-imunify360-firewall-block-traffic-by-domain-name" class="sidebar-link">18. Can Imunify360 firewall block traffic by domain name?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_19-what-ports-are-used-by-webshield" class="sidebar-link">19. What ports are used by WebShield?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_20-how-to-check-that-captcha-works" class="sidebar-link">20. How to check that CAPTCHA works?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_21-how-to-edit-watched-and-excluded-patterns-for-malware-scanner" class="sidebar-link">21. How to edit watched and excluded patterns for Malware Scanner?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_22-how-to-test-rules-based-on-modsecurity-tags" class="sidebar-link">22. How to test rules based on ModSecurity tags?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_23-imunify-agent-is-not-running-troubleshooting" class="sidebar-link">23. &quot;Imunify agent is not running&quot; troubleshooting</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_24-ssh-exchange-identification-connection-closed-by-remote-host-troubleshooting" class="sidebar-link">24. &quot;sshexchangeidentification: Connection closed by remote host&quot; troubleshooting</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_25-where-can-i-find-the-files-backup-location" class="sidebar-link">25. Where can I find the files backup location?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_26-ipset-max-elements-error-hash-is-full-cannot-add-more-elements" class="sidebar-link">26. Ipset max elements error &quot;Hash is full, cannot add more elements&quot;</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_27-how-to-enable-scan-for-end-users" class="sidebar-link">27. How to enable scan for end-users?</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/faq_and_known_issues/#corner-cases" class="sidebar-link">Corner cases</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#ip-whitelisting-port-blocking-precedence" class="sidebar-link">IP whitelisting/port blocking precedence</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/faq_and_known_issues/#plesk-related" class="sidebar-link">Plesk related</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#how-to-get-an-imunify-activation-key-from-the-extended-plesk-license" class="sidebar-link">How to get an Imunify activation key from the extended Plesk license</a></div></li></ul></li></ul></li><li><div><a href="/whmcs_plugin/" class="sidebar-link">Imunify360 WHMCS Plugin</a></div></li><li><div><a href="/uninstall/" class="sidebar-link">Uninstall</a></div></li></ul></div></li></ul> </div> <div class="page"> <div class="breadcrumb-wrapper page-breadcrumb" data-v-5e0e0acf><span class="breadcrumb-title" data-v-5e0e0acf>Documentation:</span> <a href="/faq_and_known_issues/" class="breadcrumb router-link-exact-active router-link-active" data-v-5e0e0acf>
    FAQ and Known Issues
  </a></div> <div class="page-nav-wrapper"><div class="page-nav"><a href="/command_line_interface/" class="nav-arrow left"></a> <a href="/whmcs_plugin/" class="nav-arrow right"></a></div></div> <div class="content content__default"><h1 id="faq-and-known-issues"><a href="#faq-and-known-issues" aria-hidden="true" class="header-anchor">#</a> FAQ and Known Issues</h1> <p></p><div class="table-of-contents"><ul><li><a href="#common-questions">Common Questions</a><ul><li><a href="#_1-end-user-ip-is-blocked-and-i-do-not-know-why">1. End user IP is blocked and I do not know why</a></li><li><a href="#_2-could-i-disable-iptables-firewall-or-ossec-when-using-imunify360">2. Could I disable IPtables (firewall) or OSSEC, when using Imunify360?</a></li><li><a href="#_3-does-imunify360-log-events-such-as-adding-or-removing-an-ip-to-from-the-gray-list">3. Does Imunify360 log events such as adding or removing an IP to/from the Gray List?</a></li><li><a href="#_5-to-start-using-imunify360-we-need-to-know-which-information-is-sent-to-your-servers-could-you-please-give-us-some-more-information">5. To start using Imunify360 we need to know which information is sent to your servers. Could you please give us some more information?</a></li><li><a href="#_6-no-valid-imunify360-license-found">6. No valid Imunify360 License Found.</a></li><li><a href="#_7-i-have-an-error-peewee-databaseerror-database-disk-image-is-malformed-what-should-i-do">7. I have an error peewee.DatabaseError: database disk image is malformed. What should I do?</a></li><li><a href="#_8-why-does-my-cpanel-with-litespeed-and-owasp-modsecurity-rule-set-trigger-500-error-on-all-web-pages-after-installing-imunify360">8. Why does my cPanel with LiteSpeed and OWASP ModSecurity rule set trigger 500 error on all web pages after installing Imunify360?</a></li><li><a href="#_9-disabling-waf-rules-for-certain-countries">9. Disabling WAF rules for certain countries.</a></li><li><a href="#_10-how-to-clone-imunify360-configuration-on-another-system">10. How to clone Imunify360 configuration on another system?</a></li><li><a href="#_11-how-to-disable-support-icon-in-the-imunify360-ui">11. How to disable Support icon in the Imunify360 UI?</a></li><li><a href="#_12-how-to-hide-the-ignore-list-tab-for-end-users-in-the-imunify360-ui">12. How to hide the Ignore List tab for end users in the Imunify360 UI?</a></li><li><a href="#_13-how-to-delete-malware-scan-results-from-imunify360-s-database">13. How to delete malware scan results from Imunify360’s database?</a></li><li><a href="#_14-imunify360-webshield-could-not-allocate-memory-problem-how-to-fix">14. Imunify360 WebShield ‘Could not allocate memory’ problem. How to fix?</a></li><li><a href="#_15-how-to-check-modsecurity-scan-works">15. How to check &quot;ModSecurity scan&quot; works?</a></li><li><a href="#_16-how-to-check-automatically-scan-all-modified-files-works">16. How to check &quot;automatically scan all modified files&quot; works?</a></li><li><a href="#_17-malware-file-reasons">17. Malware file reasons</a></li><li><a href="#_18-can-imunify360-firewall-block-traffic-by-domain-name">18. Can Imunify360 firewall block traffic by domain name?</a></li><li><a href="#_19-what-ports-are-used-by-webshield">19. What ports are used by WebShield?</a></li><li><a href="#_20-how-to-check-that-captcha-works">20. How to check that CAPTCHA works?</a></li><li><a href="#_21-how-to-edit-watched-and-excluded-patterns-for-malware-scanner">21. How to edit watched and excluded patterns for Malware Scanner?</a></li><li><a href="#_22-how-to-test-rules-based-on-modsecurity-tags">22. How to test rules based on ModSecurity tags?</a></li><li><a href="#_23-imunify-agent-is-not-running-troubleshooting">23. &quot;Imunify agent is not running&quot; troubleshooting</a></li><li><a href="#_24-ssh-exchange-identification-connection-closed-by-remote-host-troubleshooting">24. &quot;sshexchangeidentification: Connection closed by remote host&quot; troubleshooting</a></li><li><a href="#_25-where-can-i-find-the-files-backup-location">25. Where can I find the files backup location?</a></li><li><a href="#_26-ipset-max-elements-error-hash-is-full-cannot-add-more-elements">26. Ipset max elements error &quot;Hash is full, cannot add more elements&quot;</a></li><li><a href="#_27-how-to-enable-scan-for-end-users">27. How to enable scan for end-users?</a></li></ul></li><li><a href="#corner-cases">Corner cases</a><ul><li><a href="#ip-whitelisting-port-blocking-precedence">IP whitelisting/port blocking precedence</a></li></ul></li><li><a href="#plesk-related">Plesk related</a><ul><li><a href="#how-to-get-an-imunify-activation-key-from-the-extended-plesk-license">How to get an Imunify activation key from the extended Plesk license</a></li></ul></li></ul></div><p></p> <h2 id="common-questions"><a href="#common-questions" aria-hidden="true" class="header-anchor">#</a> Common Questions</h2> <h3 id="_1-end-user-ip-is-blocked-and-i-do-not-know-why"><a href="#_1-end-user-ip-is-blocked-and-i-do-not-know-why" aria-hidden="true" class="header-anchor">#</a> 1. End user IP is blocked and I do not know why</h3> <p>If you use CSF, then try to find the IP in <a href="/ids_integration/#csf-integration">CSF</a> <span class="notranslate">Allow/Deny</span> Lists using their <a href="https://support.configserver.com/knowledgebase/category/support%20" target="_blank" rel="noopener noreferrer">documentation and support<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. If not, then do the following:</p> <ul><li><p>Go to cPanel Plugins section, choose Imunify360 and enter the <span class="notranslate">Incidents</span> page.</p></li> <li><p>Make sure that the IP checkbox at the top of the table is ticked. Enter proper IP or part of IP in the input field and click <em>Enter</em>.</p> <ul><li>If the IP was found, then follow instructions on <a href="/dashboard/#incidents">Incidents page</a> and perform the actions you need, like: add IP to the <span class="notranslate">White List</span> or disable the security rule that has detected this incident.</li></ul></li> <li><p>If the IP was not found on the Incidents page, then go to Firewall page and using the same way as in the previous step try to find proper IP in <span class="notranslate">Black List</span> or <span class="notranslate">Grey List</span>.</p> <ul><li>If the IP was found then follow this instruction for <span class="notranslate"><a href="/dashboard/#firewall">Grey List</a></span> or <span class="notranslate"><a href="/dashboard/#firewall">Black List</a></span> and move the IP to the <span class="notranslate">White List</span> or just remove from the <span class="notranslate">Black List</span> or <span class="notranslate">Grey List</span>.</li></ul></li></ul> <p>If nothing helps, then <a href="https://cloudlinux.zendesk.com/hc/requests/new" target="_blank" rel="noopener noreferrer">contact our support team<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>There is a corner case of <a href="/faq_and_known_issues/#ip-whitelisting-port-blocking-precedence">IP whitelisting/port blocking precedence</a></p></div><h3 id="_2-could-i-disable-iptables-firewall-or-ossec-when-using-imunify360"><a href="#_2-could-i-disable-iptables-firewall-or-ossec-when-using-imunify360" aria-hidden="true" class="header-anchor">#</a> 2. Could I disable IPtables (firewall) or OSSEC, when using Imunify360?</h3> <p>No. Imunify360 will not be able to stop an attack without IPtables and will not be able to detect an attack without OSSEC.</p> <h3 id="_3-does-imunify360-log-events-such-as-adding-or-removing-an-ip-to-from-the-gray-list"><a href="#_3-does-imunify360-log-events-such-as-adding-or-removing-an-ip-to-from-the-gray-list" aria-hidden="true" class="header-anchor">#</a> 3. Does Imunify360 log events such as adding or removing an IP to/from the Gray List?</h3> <p>Most Imunify360 logs are saved in <span class="notranslate"><code>/var/log/imunify360/console.log</code></span>. For example, when IP is blocked and added to the <span class="notranslate">Black List</span>, the following lines are added:</p> <div class="notranslate"><div class="language-Python extra-class"><pre class="language-python"><code>INFO <span class="token punctuation">[</span><span class="token number">2017</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">15</span> <span class="token number">18</span><span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">,</span><span class="token number">889</span><span class="token punctuation">]</span>
defence360agent<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>protector<span class="token punctuation">.</span>lazy_init<span class="token punctuation">:</span> IP <span class="token number">103.86</span><span class="token number">.52</span><span class="token number">.175</span> <span class="token keyword">is</span> BLOCKED
<span class="token keyword">with</span> <span class="token number">300</span> sec <span class="token punctuation">(</span>expiration<span class="token punctuation">:</span> <span class="token number">1492281300</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>due to SensorAlert<span class="token punctuation">)</span>
INFO <span class="token punctuation">[</span><span class="token number">2017</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">15</span> <span class="token number">18</span><span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">:</span><span class="token number">00</span><span class="token punctuation">,</span><span class="token number">889</span><span class="token punctuation">]</span>
defence360agent<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>protector<span class="token punctuation">.</span>lazy_init<span class="token punctuation">:</span> Unblocking <span class="token number">103.86</span><span class="token number">.52</span><span class="token number">.175</span> <span class="token keyword">in</span>
CSF <span class="token keyword">as</span> it <span class="token keyword">is</span> already <span class="token keyword">in</span> our graylist
INFO <span class="token punctuation">[</span><span class="token number">2017</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">15</span> <span class="token number">18</span><span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">:</span><span class="token number">01</span><span class="token punctuation">,</span><span class="token number">663</span><span class="token punctuation">]</span> defence360agent<span class="token punctuation">.</span>internals<span class="token punctuation">.</span>the_sink<span class="token punctuation">:</span>
SensorAlert<span class="token punctuation">:</span>
<span class="token punctuation">{</span><span class="token string">'rule_id'</span><span class="token punctuation">:</span> <span class="token string">'LF_SMTPAUTH'</span><span class="token punctuation">,</span> <span class="token string">'timestamp'</span><span class="token punctuation">:</span> <span class="token number">1492281000.8720655</span><span class="token punctuation">,</span> <span class="token string">'attackers_ip'</span><span class="token punctuation">:</span> <span class="token string">'103.86.52.175'</span><span class="token punctuation">,</span> <span class="token string">'plugin_id'</span><span class="token punctuation">:</span> <span class="token string">'lfd'</span><span class="token punctuation">,</span> <span class="token string">'method'</span><span class="token punctuation">:</span> <span class="token string">'ALERT'</span><span class="token punctuation">,</span> <span class="token string">'ttl'</span><span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">}</span>
When user unblocks himself by captcha<span class="token punctuation">,</span> logs look like this<span class="token punctuation">:</span>
INFO <span class="token punctuation">[</span><span class="token number">2017</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">51</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">956</span><span class="token punctuation">]</span> defence360agent<span class="token punctuation">.</span>internals<span class="token punctuation">.</span>the_sink<span class="token punctuation">:</span>
CaptchaEvent<span class="token punctuation">:</span>
<span class="token punctuation">{</span><span class="token string">'timestamp'</span><span class="token punctuation">:</span> <span class="token number">1492404686.9496775</span><span class="token punctuation">,</span> <span class="token string">'errors'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'user_agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36'</span><span class="token punctuation">,</span> <span class="token string">'accept_language'</span><span class="token punctuation">:</span> <span class="token string">'ru-RU,ru;q=0.8,en-US;q=0.6,en;q=0.4'</span><span class="token punctuation">,</span> <span class="token string">'event'</span><span class="token punctuation">:</span> <span class="token string">'PASSED'</span><span class="token punctuation">,</span> <span class="token string">'method'</span><span class="token punctuation">:</span> <span class="token string">'CAPTCHA'</span><span class="token punctuation">,</span> <span class="token string">'attackers_ip'</span><span class="token punctuation">:</span> <span class="token string">'10.101.1.18'</span><span class="token punctuation">}</span>
INFO <span class="token punctuation">[</span><span class="token number">2017</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">00</span><span class="token punctuation">:</span><span class="token number">51</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">,</span><span class="token number">967</span><span class="token punctuation">]</span>
defence360agent<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>protector<span class="token punctuation">.</span>lazy_init<span class="token punctuation">:</span> IP <span class="token number">10.101</span><span class="token number">.1</span><span class="token number">.18</span> <span class="token keyword">is</span> UNBLOCKED
<span class="token punctuation">(</span>due to ClientUnblock<span class="token punctuation">)</span>
</code></pre></div></div> <p>Adding and removing IPs from the <span class="notranslate">White List</span> is only possible manually, no IPs will be added automatically.</p> <h3 id="_5-to-start-using-imunify360-we-need-to-know-which-information-is-sent-to-your-servers-could-you-please-give-us-some-more-information"><a href="#_5-to-start-using-imunify360-we-need-to-know-which-information-is-sent-to-your-servers-could-you-please-give-us-some-more-information" aria-hidden="true" class="header-anchor">#</a> 5. To start using Imunify360 we need to know which information is sent to your servers. Could you please give us some more information?</h3> <p>The following info is sent to our server:</p> <ul><li>all the messages from IDS OSSEC (can be found in OSSEC logs)</li> <li>all the messages from <span class="notranslate">mod_security</span> (can be found in <span class="notranslate"><code>modsec_audit.log</code></span>)</li> <li>users domains (to be checked in reputation engine);</li> <li>CAPTCHA verification info</li> <li>all running scans for malware (maldet scans) and information on cleaning up or discovering suspicious files</li> <li>optionally, suspicious files can be sent to us for the analysis. Files can be sent via UI by marking a proper checkbox</li></ul> <h3 id="_6-no-valid-imunify360-license-found"><a href="#_6-no-valid-imunify360-license-found" aria-hidden="true" class="header-anchor">#</a> 6. No valid Imunify360 License Found.</h3> <p>Check if the agent is running:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>systemctl status imunify360
</code></pre></div></div> <p>Check access to the central server (e.g. using <code>telnet</code>) (<span class="notranslate"><code>imunify360.cloudlinux.com port: 443)</code></span>.</p> <p>Run <span class="notranslate"><code>imunify360-agent rstatus</code></span> and ensure that status is <span class="notranslate"><code>OK</code></span></p> <p>If not, <a href="/installation/#registering">register</a> the agent.</p> <h3 id="_7-i-have-an-error-peewee-databaseerror-database-disk-image-is-malformed-what-should-i-do"><a href="#_7-i-have-an-error-peewee-databaseerror-database-disk-image-is-malformed-what-should-i-do" aria-hidden="true" class="header-anchor">#</a> 7. I have an error peewee.DatabaseError: database disk image is malformed. What should I do?</h3> <p>Imunify360 uses SQLite database to store its data. Although this database has proved its reliability, database files become corrupted in rare cases. To restore data try to perform the following steps:</p> <p>Stop the agent.</p> <p>If you have sqlite3 application installed on your machine, try to make dump of Imunify360 database:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>#sqlite3 /var/imunify360/imunify360.db
.mode insert
.output dump_all.sql
.dump
.exit
</code></pre></div></div> <p>You should see new file <span class="notranslate"><code>dump_all.sql</code></span> in the directory <span class="notranslate"><code>/var/imunify/</code></span></p> <p>Create a new database from this dump file:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>#sqlite3 imunify360.db.new &lt; dump_all.sql
</code></pre></div></div> <p>Replace old database with the new one:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>#cd /var/imunify/
#mv imunify360.db imunify360.db.corrupt &amp;&amp; mv imunify360.db.new imunify360.db
</code></pre></div></div> <p>Start the Imunify360 agent.</p> <p>If these steps have not solved the problem or no sqlite3 package is installed, then you should create a completely new database:</p> <p>Stop the agent.</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>#rm /var/imunify/imunify360.db
#imunify360-agent migratedb
</code></pre></div></div> <p>Start the agent</p> <h3 id="_8-why-does-my-cpanel-with-litespeed-and-owasp-modsecurity-rule-set-trigger-500-error-on-all-web-pages-after-installing-imunify360"><a href="#_8-why-does-my-cpanel-with-litespeed-and-owasp-modsecurity-rule-set-trigger-500-error-on-all-web-pages-after-installing-imunify360" aria-hidden="true" class="header-anchor">#</a> 8. Why does my cPanel with LiteSpeed and OWASP ModSecurity rule set trigger 500 error on all web pages after installing Imunify360?</h3> <p>OWASP rule set may conflict with Imunify360 default rule set on a server running <span class="notranslate">LiteSpeed Web Server</span>. We recommend to turn off OWASP rule set prior to installing Imunify360.</p> <p>Please find more FAQs in our <a href="https://cloudlinux.zendesk.com/hc/sections/360003635400-FAQ" target="_blank" rel="noopener noreferrer">Knowledge Base<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="_9-disabling-waf-rules-for-certain-countries"><a href="#_9-disabling-waf-rules-for-certain-countries" aria-hidden="true" class="header-anchor">#</a> 9. Disabling WAF rules for certain countries.</h3> <p>It is possible to disable some WAF rules for IPs that are resolved to be from some country (or other geographical entity).
To implement this, a customer should create his own modsecurity configuration file, and include it into the default modsecurity configuration. In case of cPanel, this can be done by creating <span class="notranslate"><code>/etc/apache2/conf.d/includes/countrywafrules.conf</code></span> and adding it as an include to the <span class="notranslate"><code>/etc/apache2/conf.d/modsec/modsec2.cpanel.conf</code></span>. Otherwise configuration files might be rewritten by Imunify360 rules update.</p> <p>Example of contents of such config file:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>SecGeoLookupDb /path/to/GeoLiteCity.dat 
# ModSecurity relies on the free geolocation databases (GeoLite City and GeoLite Country) that can be obtained from MaxMind http://www.maxmind.com. Currently ModSecurity only supports the legacy GeoIP format. Maxmind's newer GeoIP2 format is not yet currently supported.
So a customer need to download this IP database and locate somewhere.

# Lookup IP address 
SecRule REMOTE_ADDR &quot;@geoLookup&quot; &quot;phase:1,id:155,nolog,pass&quot;

# Optionally block IP address for which geolocation failed
# SecRule &amp;GEO &quot;@eq 0&quot; &quot;phase:1,id:156,deny,msg:'Failed to lookup IP'&quot;

# Skip rules 942100 and 942101 for GB country as example

SecRule GEO:COUNTRY_CODE &quot;@streq GB&quot; &quot;phase:2,auditlog,id:157,pass,severity:2,\
ctl:ruleRemoveById=942100,\
ctl:ruleRemoveById=942101&quot;
</code></pre></div></div> <p>Make sure that you have replaced <span class="notranslate"><code>/path/to/GeoLiteCity.dat</code></span> with the real path to the GeoLiteCity.dat file installed in your system.</p> <p>Variable <span class="notranslate"><code>GEO</code></span> is a collection populated by result of the last <span class="notranslate"><code>@geoLookup</code></span> operator. The collection can be used to match geographical fields looked from an IP address or hostname.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Available since ModSecurity 2.5.0.</p></div><p>Fields:</p> <ul><li><span class="notranslate"><code>COUNTRY_CODE</code></span>: two character country code. Example: <code>US</code>, <code>GB</code>, etc.</li> <li><span class="notranslate"><code>COUNTRY_CODE3</code></span>: up to three character country code.</li> <li><span class="notranslate"><code>COUNTRY_NAME</code></span>: full country name.</li> <li><span class="notranslate"><code>COUNTRY_CONTINENT</code></span>: two character continent that the country is located. Example: <code>EU</code>.</li> <li><span class="notranslate"><code>REGION</code></span>: two character region. For US, this is state. For Canada, providence, etc.</li> <li><span class="notranslate"><code>CITY</code></span>: city name if supported by the database.</li> <li><span class="notranslate"><code>POSTAL_CODE</code></span>: postal code if supported by the database.</li> <li><span class="notranslate"><code>LATITUDE</code></span>: latitude if supported by the database.</li> <li><span class="notranslate"><code>LONGITUDE</code></span>: longitude if supported by the database.</li> <li><span class="notranslate"><code>DMA_CODE</code></span>: metropolitan area code if supported by the database. (US only)</li> <li><span class="notranslate"><code>AREA_CODE</code></span>: phone system area code. (US only)</li></ul> <h3 id="_10-how-to-clone-imunify360-configuration-on-another-system"><a href="#_10-how-to-clone-imunify360-configuration-on-another-system" aria-hidden="true" class="header-anchor">#</a> 10. How to clone Imunify360 configuration on another system?</h3> <p>The solution is available in <a href="https://cloudlinux.zendesk.com/hc/en-us/articles/360022689394-How-to-Clone-Imunify360-Installation" target="_blank" rel="noopener noreferrer">FAQ section<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_11-how-to-disable-support-icon-in-the-imunify360-ui"><a href="#_11-how-to-disable-support-icon-in-the-imunify360-ui" aria-hidden="true" class="header-anchor">#</a> 11. How to disable Support icon in the Imunify360 UI?</h3> <ol><li>Go to <span class="notranslate"><code>/etc/sysconfig/imunify360/imunify360.config</code></span>.</li> <li>And set <span class="notranslate"><code>PERMISSIONS.support_form:</code></span> option to <span class="notranslate"><code>false</code></span>.</li></ol> <p>OR, <strong>better</strong>, run the following command:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent config update '{&quot;PERMISSIONS&quot;: {&quot;support_form&quot;: false}}'
</code></pre></div><h3 id="_12-how-to-hide-the-ignore-list-tab-for-end-users-in-the-imunify360-ui"><a href="#_12-how-to-hide-the-ignore-list-tab-for-end-users-in-the-imunify360-ui" aria-hidden="true" class="header-anchor">#</a> 12. How to hide the Ignore List tab for end users in the Imunify360 UI?</h3> <ol><li>Go to <span class="notranslate"><code>/etc/sysconfig/imunify360/imunify360.config</code></span>.</li> <li>And set <span class="notranslate"><code>PERMISSIONS.user_ignore_list:</code></span> option to <span class="notranslate"><code>false</code></span>.</li></ol> <p>OR, <strong>better</strong>, run the following command:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent config update '{&quot;PERMISSIONS&quot;: {&quot;user_ignore_list&quot;: false}}'
</code></pre></div><h3 id="_13-how-to-delete-malware-scan-results-from-imunify360-s-database"><a href="#_13-how-to-delete-malware-scan-results-from-imunify360-s-database" aria-hidden="true" class="header-anchor">#</a> 13. How to delete malware scan results from Imunify360’s database?</h3> <p>Sometimes, you may need to delete all users’ scan results from the server. This should not be common practice, and we do not recommend doing it on a regular basis. But, if you do need to erase the results of all Imunify360 scans, you can find the instructions below.</p> <ol><li>First, you need to stop the agent:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>systemctl stop imunify360
</code></pre></div></div> <p>(on CentOS 7)
</p><div class="notranslate"><p></p> <div class="language- extra-class"><pre class="language-text"><code>service imunify360 stop
</code></pre></div></div> <p>(on CentOS 6, Ubuntu)</p> <ol start="2"><li>Connect to the Imunify360 database by running this command:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>sqlite3 /var/imunify360/imunify360.db
</code></pre></div></div> <ol start="3"><li>Execute the following SQL commands:</li></ol> <div class="danger custom-block"><p class="custom-block-title">IMPORTANT</p><p>This will remove all scan results from Imunify360!</p></div><div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>DELETE FROM malware_history;
DELETE FROM malware_hits;
DELETE FROM malware_scans;
DELETE FROM malware_user_infected;
</code></pre></div></div> <ol start="4"><li>Start the Imunify360 service:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>systemctl start imunify360
</code></pre></div></div> <p>(on CentOS 7)
</p><div class="notranslate"><p></p> <div class="language- extra-class"><pre class="language-text"><code>service imunify360 start
</code></pre></div></div> <p>(on CentOS 6, Ubuntu)</p> <p>We don’t recommend cleaning the scan results for specific users, as it may cause inconsistencies in the <span class="notranslate"><code>malware_scans</code></span> table. But, in emergencies, you can do it with these SQL commands:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>DELETE FROM malware_history WHERE file_onwer = &lt;user&gt;;
DELETE FROM malware_hits WHERE user = &lt;user&gt;;
DELETE FROM malware_user_infected WHERE user = &lt;user&gt;;
</code></pre></div></div> <p>Unfortunately, there’s no easy way to delete records in the <span class="notranslate"><code>malware_scans</code></span> table for a specific user, so the table should be either truncated with the other tables shown in step 2 above, or the records should just be ignored.</p> <p>If you need any more information on this or anything else related to Imunify360 administration, please <a href="mailto:feedback@imunify360.com">get in touch</a> .</p> <h3 id="_14-imunify360-webshield-could-not-allocate-memory-problem-how-to-fix"><a href="#_14-imunify360-webshield-could-not-allocate-memory-problem-how-to-fix" aria-hidden="true" class="header-anchor">#</a> 14. Imunify360 WebShield ‘Could not allocate memory’ problem. How to fix?</h3> <p><strong>Symptoms:</strong> It can have pretty different symptoms (increased IO, CPU and memory usage), but the main one is that WebShield blacklisting (through CDN) does not work.</p> <p><strong>How to check:</strong> Just browse wsshdict log (<span class="notranslate"><code>/var/log/wsshdict/wsshdict.log</code></span>). If you face the issue, the log will have entries like:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>2019-07-09 16:50:06 [WARN]: Could not allocate memory for 192.126.123.115/32 in rbtree
2019-07-09 16:52:23 [WARN]: Could not allocate memory for 179.108.244.125/32 in lpctrie
</code></pre></div></div> <p>This means that the shared memory is full and no new address is allowed to be added.
Shared memory has a fixed size (it’s set in configuration files) and cannot change it dynamically. Currently, the size of shared memory is <strong>20 MB</strong>, and it can take up to 89k IPv4 addresses. However, some of our clients have more blacklisted addresses, and when Imunify360 agent tries to place all these IP addresses into shared memory, the aforementioned error occurs.</p> <p><strong>How to fix:</strong> We want to increase the shared memory size.</p> <ol><li>Modify the second parameter of the <span class="notranslate"><code>shared_storage</code></span> directive of the <span class="notranslate"><code>/etc/imunify360-webshield/webshield.conf</code></span> config file, to make it look like:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>shared_storage /opt/imunify360-webshield/shared_data/shdict.dat 21m;
</code></pre></div></div> <ol start="2"><li><p>Modify the <span class="notranslate"><code>data_size</code></span> directive of the <span class="notranslate"><code>/etc/imunify360-webshield/webshield-shdict.conf</code></span> config file to <code>22020096</code> (21 MB in bytes: 1024 * 1024 * 21):</p></li> <li><p>Restart <span class="notranslate"><code>imunify360-webshield</code></span>:</p></li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>   systemctl restart imunify360-webshield
</code></pre></div></div> <p>Or</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>   service imunify360-webshield reload
</code></pre></div></div> <p>The wsshdict daemon is expected to be restarted automatically.</p> <ol start="4"><li>Make sure the shared memory size is actually changed. Run <span class="notranslate"><code>ipcs -m</code></span> command. It’s expected to have the output like this:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># ipcs -m
------ Shared Memory Segments --------
key      shmid   owner    perms   bytes nattch status  
0x620035c1 4554752  imunify360 600    22020096   4                       
0x00000000 32769    root       644    80         2
</code></pre></div></div> <p>The first column must not have zeros (like in the second row), the third column (owner) is expected to be ‘imunify360-webshield’, and size must correspond to values set in the config files (22020096 in our case).</p> <h3 id="_15-how-to-check-modsecurity-scan-works"><a href="#_15-how-to-check-modsecurity-scan-works" aria-hidden="true" class="header-anchor">#</a> 15. How to check &quot;ModSecurity scan&quot; works?</h3> <ol><li>To verify, if ModSecurity scan works, you can use the following command:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>curl -v -s -o /dev/null -F 'data=@&lt;path-to-malware-sample&gt;' http://&lt;domain&gt;/
</code></pre></div></div> <p>You can get a malware sample file on the eicar.org: <a href="http://www.eicar.org/" target="_blank" rel="noopener noreferrer">eicar.org<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>For instance:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>wget http://www.eicar.org/download/eicar.com.txt -O /tmp/eicar.com.txt
curl -v -s -o /dev/null -F 'data=@/tmp/eicar.com.txt' http://mycoolwebsite.net/
</code></pre></div></div> <p>You can find the results of this attempt in the <span class="notranslate"><em>Incidents</em></span> tab</p> <ol><li>Also, you can perform the following request which triggers a test rule</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>curl -v http://mycoolwebsite.net//?i360test=88ff0adf94a190b9d1311c8b50fe2891c85af732 
</code></pre></div></div> <p>And check the Imunify360 console log</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>grep 'Testing the work of the i360 ModSecurity rules' /var/log/imunify360/console.log
</code></pre></div></div> <h3 id="_16-how-to-check-automatically-scan-all-modified-files-works"><a href="#_16-how-to-check-automatically-scan-all-modified-files-works" aria-hidden="true" class="header-anchor">#</a> 16. How to check &quot;automatically scan all modified files&quot; works?</h3> <p>To check &quot;automatically scan all modified files&quot; (i.e inotify scanner), upload a malware sample to some account's webroot via SSH and check if it will appear in the <span class="notranslate"><em>Malicious</em></span> tab shortly.</p> <p>You can get a malware sample file on the <a href="http://www.eicar.org/" target="_blank" rel="noopener noreferrer">eicar.org<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Make sure <a href="/dashboard/#malware">the option is enabled</a>.</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>wget http://www.eicar.org/download/eicar.com.txt -O /tmp/eicar.com.txt
scp /tmp/eicar.com.txt  mycooluser@X.Y.Z.A:/var/www/mycooluser/mycoolwebsite_docroot
</code></pre></div></div> <p>where <span class="notranslate"><code>X.Y.Z.A</code></span> - your server IP address</p> <p>You can find the results in the <span class="notranslate"><em>Malware scanner &gt; Files</em></span> tab.</p> <h3 id="_17-malware-file-reasons"><a href="#_17-malware-file-reasons" aria-hidden="true" class="header-anchor">#</a> 17. Malware file reasons</h3> <p>You can see the advanced reason why a file was detected as malicious.</p> <p>Go to <span class="notranslate">Imunify → Malware Scanner → Files tab → Reason</span>. See <a href="/dashboard/#files">Malware Scanner → Files tab</a>.</p> <p>A reason pattern looks like the following:</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;type&gt;-&lt;detected&gt;-&lt;ID&gt;-&lt;filetype&gt;.&lt;mlwcategory&gt;.&lt;mlwclassification&gt;
</code></pre></div><table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>&lt;type&gt;</code></td> <td><code>SMW</code> – server malware, <code>CMW</code> – client malware</td></tr> <tr><td><code>&lt;detected&gt;</code></td> <td><code>SA</code>- stand-alone (file is completely malicious), <code>INJ</code> – injections (malware is injected to some legitimate file)</td></tr> <tr><td><code>&lt;ID&gt;</code></td> <td>a signature ID</td></tr> <tr><td><code>&lt;filetype&gt;</code></td> <td>a file type; see <a href="/faq_and_known_issues/#table-1-file-types-and-their-codes">Table 1. File types and their code</a></td></tr> <tr><td><code>&lt;mlwcategory&gt;</code></td> <td>a malware category, see <a href="/faq_and_known_issues/#table-2-malware-categories">Table 2. Malware categories</a></td></tr> <tr><td><code>&lt;mlwclassification&gt;</code></td> <td>malware classification; it varies based on scenario/actions of a malicious artifact (see <a href="/faq_and_known_issues/#table-3-malware-classification">Table 3. Malware classification</a>)</td></tr></tbody></table> <h4 id="table-1-file-types-and-their-codes"><a href="#table-1-file-types-and-their-codes" aria-hidden="true" class="header-anchor">#</a> Table 1. File types and their codes</h4> <p><code>filetype</code></p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><strong>File types</strong></td> <td><strong>File extensions</strong></td></tr> <tr><td>Markup language files</td> <td><code>htm</code>, <code>html</code>, <code>shtml</code> ,<code>phtml</code></td></tr> <tr><td>Server config files</td> <td><code>htaccess</code></td></tr> <tr><td><span class="notranslate">JavaScript</span> files</td> <td><code>js</code></td></tr> <tr><td><span class="notranslate">Perl</span> files</td> <td><code>pl</code></td></tr> <tr><td><span class="notranslate">Python</span> files</td> <td><code>py</code></td></tr> <tr><td><span class="notranslate">Ruby</span> files</td> <td><code>rb</code></td></tr> <tr><td><span class="notranslate">Shell</span> scripts</td> <td>shells in common: <code>sh</code></td></tr> <tr><td><span class="notranslate">Cron</span> files</td> <td><code>cron</code></td></tr> <tr><td><span class="notranslate">ELF</span> files</td> <td><code>elf</code></td></tr> <tr><td>Other server pages</td> <td><code>Jsp</code> (<code>asp</code>,<code>aspx</code>), <code>vb</code></td></tr> <tr><td>Files with no extension/fake extension</td> <td>These files can be named based on the type of malicious code used inside the file - the above other filetype classification can be used based on code.</td></tr></tbody></table> <h4 id="table-2-malware-categories"><a href="#table-2-malware-categories" aria-hidden="true" class="header-anchor">#</a> Table 2. Malware categories</h4> <p><code>mlwcategory</code></p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><strong>Category</strong></td> <td><strong>Explanation</strong></td></tr> <tr><td><span class="notranslate"><code>bkdr</code></span></td> <td>Artifacts that help attackers with partial or complete access to victims. Example: web shells</td></tr> <tr><td><span class="notranslate"><code>tool</code></span></td> <td>Scripts that are uploaded to victim's servers and can be used to perform certain specific actions like file upload, database access, downloaders/droppers, mailers, brute-force scripts, proxy scripts, etc.</td></tr> <tr><td><span class="notranslate"><code>exploit</code></span></td> <td>Scripts that are uploaded to victim's servers and meant to exploit certain other vulnerabilities or bugs. Example: WordPress/Joomla exploits</td></tr> <tr><td><span class="notranslate"><code>spam</code></span></td> <td>Files that deliver spam or point end-users towards spammy content. Example: doorway pages, other SEO spam, spam advertisement, injections, etc.</td></tr> <tr><td><span class="notranslate"><code>phish</code></span></td> <td>Phishing related malware artifacts</td></tr> <tr><td><span class="notranslate"><code>miner</code></span></td> <td>All sorts of miners go under this category</td></tr> <tr><td><span class="notranslate"><code>redi</code></span></td> <td>Malware artifacts causing redirects for any sort of malicious reason can be covered under this category</td></tr> <tr><td><span class="notranslate"><code>deface</code></span></td> <td>Any sort of artifacts that are meant to show off attacker's intentions or to spread a certain message. Example: Defacements, banners, etc.</td></tr></tbody></table> <h4 id="table-3-malware-classification"><a href="#table-3-malware-classification" aria-hidden="true" class="header-anchor">#</a> Table 3. Malware classification</h4> <p><code>mlwclassification</code></p> <p>The <span class="notranslate"><code>mlwclassification</code></span> field is not fixed and may vary depending on the purposes of the malware.</p> <p>The following table shows the <span class="notranslate"><code>mlwclassification</code></span> field examples.</p> <ul><li>Sometimes we include a file extension as a part of the malware classification (like <code>php.tool.htaccess</code> or <code>php.tool.cron</code> or <code>php.tool.js</code>). It means that malware artifact involves manipulation of file types mentioned in the classification. For example, the <code>php.tool.htaccess</code> example can be explained as a PHP based malware involved in modifying/dropping content related to htaccess.</li> <li>Sometimes you may see signature categories beginning with <code>elf.troj</code>. The <code>troj</code> classification is mainly associated with ELF file types where we classify trojans as <code>troj</code>.</li></ul> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><strong>Classification</strong></td> <td><strong>Explanation</strong></td></tr> <tr><td><code>ad/adware</code></td> <td>Malware that drops spammy advertisements in some way falls under this classification.</td></tr> <tr><td><code>wshll</code></td> <td>Webshells of any sort fall under this classification.</td></tr> <tr><td><code>google</code>/<code>yahoo</code>/<code>fb</code>/<code>apple</code>/<code>msoft</code>/<code>nflix</code>/<code>msn</code></td> <td>This involves expandable classification in which malware involves any sort of incident/attacks regarding big corporates such as Google, Yahoo, Facebook, Microsoft, Netflix, etc.</td></tr> <tr><td><code>link</code>/<code>links</code></td> <td>Covers malware involving/spreading/dropping spammy links.</td></tr> <tr><td><code>bank</code>/<code>edu</code>/<code>ecom</code>/<code>pharma</code>/<code>ent</code></td> <td>Covers different varieties of phishing or malware based on the corporate sector they are targeting. <code>bank</code> stands for banking, <code>edu</code> for education, <code>ecom</code> for e-commerce, <code>pharma</code> for pharmaceuticals, <code>ent</code> for entertainment.</td></tr> <tr><td><code>red</code>/<code>redi</code></td> <td>Usually covers malware involving redirects of any sort. Some may redirect you to spam pages, some works as a part of SMM panels to send traffic, etc.</td></tr> <tr><td><code>drpr</code>/<code>dwnldr</code></td> <td>Covers malware that opens the door to drop more complex malware from a remote location.</td></tr> <tr><td><code>upldr</code>/<code>upld</code></td> <td>Malware that acts as a simple uploader tool that can be used to upload more backdoors/webshells.</td></tr> <tr><td><code>inc</code>/<code>incl</code></td> <td>Covers malware that abuses <code>include</code>/<code>require</code> functions in PHP to execute code hidden in files with non PHP extensions. For example, image file extensions with PHP code hidden inside.</td></tr> <tr><td><code>mobi</code>/<code>mob</code></td> <td>Covers malware scripts that activate/work based on detection of mobile device. One such example can be a few JavaScripts redirects to spammy domains based on detecting the presence of mobile based user agents.</td></tr> <tr><td><code>drwy</code></td> <td>Covers spammy doorway pages.</td></tr> <tr><td><code>deface</code></td> <td>Deface covers any sort of artifacts that are meant to show off attackers intentions or to spread a certain message. When we use <code>deface</code> in the classification instead of the category it’s because the artifact can be a tool that aids in defacing websites. Something like <code>php.tool.deface</code> explains this scenario.</td></tr> <tr><td><code>wp</code>/<code>joom</code>/<code>mage</code>/<code>presta</code></td> <td>Covers malicious artifacts targeting major CMS/applications such as WordPress (<code>wp</code>), Joomla (<code>joom</code>), Magento (<code>mage</code>), PrestaShop (<code>presta</code>).</td></tr> <tr><td><code>gen</code></td> <td><code>gen</code> stands for generic. We use it when the signature is generic in nature covering artifacts of different origins but falls under the same category.</td></tr> <tr><td><code>mail</code>/<code>mailer</code></td> <td>It covers tools that are used for malicious purposes such as mailers.</td></tr> <tr><td><code>db</code>/<code>wpdb</code></td> <td>Usually covers malware infections that affect databases in some way or trying to extract some information from the databases.</td></tr> <tr><td><code>exec</code>/<code>eva</code>/<code>eval</code>/<code>cmd</code></td> <td>Covers malware injections that assists attackers execute code via attacker controlled parameters in HTTP requests.</td></tr> <tr><td><code>seo</code></td> <td>Covers malware campaigns that involve in some sort of SEO specific malicious actions.</td></tr> <tr><td><code>gif</code>/<code>img</code>/<code>ico</code>/<code>jpg</code>...</td> <td>An identified artifact/malicious file has PHP code hidden inside file extensions that mimic that of images.</td></tr> <tr><td><code>paste</code>/<code>pastebin</code>/<code>pbin</code>/<code>pasteb</code></td> <td>Covers malware utilising pastebin to further drop more malicious content.</td></tr> <tr><td><code>create</code>/<code>crtfunc</code>/<code>cf</code>/<code>createfunction</code></td> <td>Covers backdoors that relies on using PHP function <code>createfunction</code> to execute code on a victim's server.</td></tr> <tr><td><code>stealer</code>/<code>steal</code>/<code>cred</code></td> <td>To classify malware that steals credentials of any sort.</td></tr> <tr><td><code>fakeplugin</code></td> <td>Some malware authors utilise technique of mimicking legit WordPress plugins to conceal the presence of malware. Such fake plugins are covered under this classification.</td></tr> <tr><td><code>glob</code>/<code>globals</code></td> <td>Covers malware that utilises PHP superglobals based obfuscation to avoid detection.</td></tr> <tr><td><code>btrx</code>/<code>bitrix</code></td> <td>Covers malware that works based on hiding itself inside Bitrix installations.</td></tr> <tr><td><code>dos</code>/<code>ddos</code>/<code>flood</code>/<code>booter</code></td> <td>Covers any typical malware that involves denial of service attacks.</td></tr> <tr><td><code>exfil</code></td> <td>Covers malware that involves in data exfiltration.</td></tr> <tr><td><code>filemanager</code>/<code>fileman</code>/<code>fm</code></td> <td>For malwares with capabilities of a file manager.</td></tr> <tr><td><code>crypto</code>/<code>chive</code>/<code>cimp</code></td> <td>For malware that involves stealing cryptocurrencies or mining of cryptocurrencies.</td></tr> <tr><td><code>goto</code></td> <td>Covers malware that utilises PHP <code>goto</code> feature for obfuscation and to avoid detection.</td></tr> <tr><td><code>wpvcd</code>/<code>wpcd</code></td> <td>For malware that are involved in the WPVCD malware campaign.</td></tr> <tr><td><code>oneliner</code>/<code>oneline</code></td> <td>Sometimes malware authors try to make a backdoor injection as short as possible to accommodate in a single line and deploy various tactics to achieve it. Such malware is covered under this classification.</td></tr> <tr><td><code>tmp</code></td> <td>Sometimes we create temporary signatures that will either be deleted/changed to something else after sometime. These are marked with <code>tmp</code>.</td></tr> <tr><td><code>wpnull24</code></td> <td>Malware injections that are part of nulled plugins/themes from the wpnull24 website.</td></tr> <tr><td><code>iframe</code></td> <td>Malware injections that deliver iframe.</td></tr> <tr><td><code>sym</code>/<code>symlink</code>/<code>symlnk</code></td> <td>Covers malware workings related to symbolic links.</td></tr> <tr><td><code>cpanel</code>/<code>whm</code>/<code>cp</code>/<code>resetpass</code></td> <td>Malware/tools that involve stealing/cracking credentials related to cPanel/WHM.</td></tr> <tr><td><code>tele</code>/<code>tgram</code></td> <td>Covers malware involving exfiltration of information using the Telegram API.</td></tr> <tr><td><code>conf</code>/<code>confgrab</code>/<code>grabber</code></td> <td>Malware that involves activities such as grabbing configurations, configuration files, etc.</td></tr> <tr><td><code>brute</code>/<code>bruter</code>/<code>wpbrute</code>/<code>bruteforce</code></td> <td>Covers malware artifacts involving brute force attacks of any sort.</td></tr> <tr><td><code>bninja</code>/<code>bloodninja</code></td> <td>Covers malware authored by a malware author dubbed <code>bloodninja</code>.</td></tr> <tr><td><code>obf</code>/<code>enc</code></td> <td>Obfuscated/encrypted malware artifact is somehow obfuscated/encrypted to conceal the malware code.</td></tr> <tr><td><code>indo</code>/<code>indoxploit</code>/<code>indox</code></td> <td>Covers various versions of IndoXploit webshell.</td></tr> <tr><td><code>cracker</code>/<code>crack</code></td> <td>Covers malware artifacts involving cracking credentials of any sort.</td></tr> <tr><td><code>klg</code>/<code>rms</code></td> <td>Covers backdoors or webshells related to malware campaigns dubbed <code>klg</code> and <code>rms</code>.</td></tr> <tr><td><code>array</code></td> <td>Malware that utilises arrays and array based functions to hide/ make legit looking backdoor code.</td></tr> <tr><td><code>skim</code>/<code>skimmer</code></td> <td>Covers malware artifacts that involve web skimming.</td></tr> <tr><td><code>bot</code>/<code>botnet</code></td> <td>Malicious code that resembles activities of a bot/botnet.</td></tr> <tr><td><code>irc</code>/<code>ircbot</code></td> <td>Covers malicious IRC artifacts.</td></tr></tbody></table> <h4 id="example"><a href="#example" aria-hidden="true" class="header-anchor">#</a> Example</h4> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><strong>Reason</strong></td> <td><strong>Explanation</strong></td></tr> <tr><td><span class="notranslate"><code>SMW-SA-05155-sh.bkdr.wshll</code></span></td> <td><strong>type</strong>: server malware (<code>SMW</code>)<br><strong>detected</strong>: stand-alone (file is completely malicious) (<code>SA</code>)<br><strong>signature ID</strong>: <code>05155</code><br><strong>file type</strong>: shell scripts (<code>sh</code>)<br><strong>mlwcategory</strong>: artifacts that help attackers with partial or complete access to victims (<code>bkdr</code>)<br><strong>mlwclassification</strong>: web shells (<code>wshll</code>)</td></tr></tbody></table> <h3 id="_18-can-imunify360-firewall-block-traffic-by-domain-name"><a href="#_18-can-imunify360-firewall-block-traffic-by-domain-name" aria-hidden="true" class="header-anchor">#</a> 18. Can Imunify360 firewall block traffic by domain name?</h3> <p>Unfortunately, Imunify360 does not have such ability.</p> <h3 id="_19-what-ports-are-used-by-webshield"><a href="#_19-what-ports-are-used-by-webshield" aria-hidden="true" class="header-anchor">#</a> 19. What ports are used by WebShield?</h3> <p>The following ports are reserved:</p> <ul><li>52223</li> <li>52224</li> <li>52227-52235</li></ul> <p>You can find additional information in the following config files:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>/etc/imunify360-webshield/ports.conf
/etc/imunify360-webshield/ssl_ports.conf
/etc/imunify360-webshield/webshield.conf
</code></pre></div></div> <h3 id="_20-how-to-check-that-captcha-works"><a href="#_20-how-to-check-that-captcha-works" aria-hidden="true" class="header-anchor">#</a> 20. How to check that CAPTCHA works?</h3> <p>First, remove an IP from the White list:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># imunify360-agent whitelist ip delete YOUR_IP 
</code></pre></div></div> <p>After that, run the following loop which triggers ModSecurity test rule 5 times in a row that leads to graylisting of the IP due to the sequence of 403 HTTP errors:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># for i in {1..5} ; do curl -s http://SERVER_IP/?i360test=88ff0adf94a190b9d1311c8b50fe2891c85af732 &gt; /dev/null; echo $i; done
</code></pre></div></div> <p>Where <span class="notranslate"><code>SERVER_IP</code></span> is the server's IP address where Imunify360 is installed and where you want to check CAPTCHA.</p> <p>Also, it is possible to use a domain name of a website which <code>DNS A</code> record is pointed to the server. In other words, which is located on the server, like <a href="/webshield/#verification">shown here</a></p> <h3 id="_21-how-to-edit-watched-and-excluded-patterns-for-malware-scanner"><a href="#_21-how-to-edit-watched-and-excluded-patterns-for-malware-scanner" aria-hidden="true" class="header-anchor">#</a> 21. How to edit watched and excluded patterns for Malware Scanner?</h3> <p>There are two files:</p> <ul><li><span class="notranslate"><code>/etc/sysconfig/imunify360/malware-filters-admin-conf/watched.txt</code></span> defines which paths are watched by Imunify360</li> <li><span class="notranslate"><code>/etc/sysconfig/imunify360/malware-filters-admin-conf/ignored.txt</code></span> defines which paths are excluded by Imunify360</li></ul> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>This exclude list is intended for things like logs, tmp files, etc. Things that are not worth scanning in real-time and should not be allowed to execute.
Proactive Defense will prevent <span class="notranslate"><code>include</code>/<code>require</code></span> of PHP files that are excluded by realtime-scan.
There is a separate ignore list for false-positive hits: see <a href="/dashboard/#ignore-list">Ignore List</a></p></div><p>The <code>watched.txt</code> file contains additional shell-like glob patterns specifying what file system directories should be monitored by inotify/fanotify realtime scanner.</p> <p>Patterns can be absolute:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>/another/folder
</code></pre></div></div> <p>or relative to basedirs supplied by hosting control panels, if they start with a &quot;+&quot; sign:&quot;</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>+*/www
</code></pre></div></div> <p>This relative pattern will expand to the <code>/home/*/www</code> for cPanel, for example.</p> <p>All patterns listed here have higher priority than stock watched and excluded lists supplied with Imunify360.</p> <div class="warning custom-block"><p class="custom-block-title">IMPORTANT</p><p>After making changes to this file, run the <code>imunify360-agent malware rebuild patterns</code> command.</p></div><p>The <span class="notranslate"><code>ignored.txt</code></span> file contains additional regular expression patterns specifying what filesystem paths should not be monitored by inotify/fanotify realtime scanner.</p> <p>Patterns can be absolute:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>/another/folder
</code></pre></div></div> <p>or relative to basedirs supplied by hosting control panels, if they start with a &quot;+&quot; sign:&quot;</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>+[^/]+/www/\.cache
</code></pre></div></div> <p>This relative pattern may expand to the <span class="notranslate"><code>^/home/[^/]+/www/\.cache</code></span> for cPanel, for example. The <code>+</code> sign at the beginning is substituted with all base directories for user homes. Imunify360 picks up those directories from hosting panel configuration.</p> <p>All patterns listed here have higher priority than stock watched and excluded lists supplied with Imunify360.</p> <p>Custom exclude patterns have higher priority than custom watched patterns.</p> <div class="warning custom-block"><p class="custom-block-title">IMPORTANT</p><p>After making changes to this file, perform the <span class="notranslate"><code>imunify360-agent malware rebuild patterns</code></span> command.</p></div><h3 id="_22-how-to-test-rules-based-on-modsecurity-tags"><a href="#_22-how-to-test-rules-based-on-modsecurity-tags" aria-hidden="true" class="header-anchor">#</a> 22. How to test rules based on ModSecurity tags?</h3> <p>You can use the following URIs to check what was activated.</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>curl -k 'https://example.org/?tag_test=joomla_core'
</code></pre></div></div> <p>It will produce 403 only for sites with Joomla!.</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>curl -k 'https://example.org/?tag_test=wp_core'
</code></pre></div></div> <p>It will produce 403 only for sites with WordPress.</p> <h3 id="_23-imunify-agent-is-not-running-troubleshooting"><a href="#_23-imunify-agent-is-not-running-troubleshooting" aria-hidden="true" class="header-anchor">#</a> 23. &quot;Imunify agent is not running&quot; troubleshooting</h3> <p>Having the Imunify service installed, you may come across the situation when the message <span class="notranslate">&quot;Imunify agent is not running&quot;</span> is displayed when you try to access the Dashboard:</p> <p><img src="/images/ImunifyAgentNotRunning.png" alt=""></p> <p>First of all, try to check the status of the service via the command line using the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># service imunify360 status
</code></pre></div></div> <p>In case you see the agent is inactive:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>[root@host ~]# service imunify360 status


Redirecting to /bin/systemctl status imunify360.service
● imunify360.service - Imunify360 agent
Loaded: loaded (/usr/lib/systemd/system/imunify360.service; disabled; vendor preset: disabled)
Active: inactive (dead)
</code></pre></div></div> <p>try to start it via the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># service imunify360 start
</code></pre></div></div> <p>It may also occur that despite the Imunify’s Dashboard showing the <span class="notranslate">&quot;agent is not running&quot;</span>, the service itself is loaded and active.</p> <p>You can check it with the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># service imunify360 status -l
</code></pre></div></div> <p>Example output:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>[root@host ~]# service imunify360 status -l

Redirecting to /bin/systemctl status -l imunify360.service
● imunify360.service - Imunify360 agent
Loaded: loaded (/usr/lib/systemd/system/imunify360.service; enabled; vendor preset: disabled)
Active: active (running) since Mon 2020-05-13 02:58:43 WIB; 3min 54s ago
Main PID: 1234567 (python3)
Status: &quot;Demonized&quot;
CGroup: /system.slice/imunify360.service
├─1234567 /opt/alt/python35/bin/python3 -m im360.run --daemon --pidfile /var/run/imunify360.pid
├─1234568 /usr/bin/tail --follow=name -n0 --retry /usr/local/cpanel/logs/cphulkd.log
├─1234569 /usr/bin/tail --follow=name -n0 --retry /etc/apache2/logs/modsec_audit.log
├─1234570 /usr/bin/tail --follow=name -n0 --retry /var/ossec/logs/alerts/alerts.json
└─1234571 /opt/alt/python27/bin/python2.7 -s /usr/sbin/cagefsctl --wait-lock --force-update-etc
May 13 02:58:39 host.domain.com systemd[1]: Starting Imunify360 agent…
May 13 02:58:43 host.domain.com systemd[1]: Started Imunify360 agent.
May 13 02:58:43 host.domain.com imunify-service[4072717]: Starting migrations
May 13 02:58:43 host.domain.com imunify-service[4072717]: There is nothing to migrate
</code></pre></div></div> <p>Most often, such circumstances attest that the Imunify service has been recently installed on the server. Sometimes, a desynchronization between the agent and the web interface may occur in such cases, and it can take a bit of time for the database to be integrated completely.</p> <p>In case the issue is still the same after 60 minutes, you can try creating the backup of the Imunify files and do the service restart to force the sync process:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># service imunify360 stop
# mv /var/imunify360/files /var/imunify360/files_backup
# service imunify360 start
</code></pre></div></div> <p>After these actions, wait until the files downloading and the migration process are complete – the agent will synchronize with the web interface and start working normally. You can monitor this process via</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># tail -f /var/log/imunify360/console.log
</code></pre></div></div> <p>Another similar workaround may be handy in case you locate some database-related error inside the <span class="notranslate"><code>/var/log/imunify360/error.log</code></span> – by renaming the database file and restarting the service. There may be errors like</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>&quot;Imunify360 database is corrupt. Application cannot run with corrupt database.&quot;
</code></pre></div></div> <p>or some lines with</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>&quot;sqlite3.DatabaseError&quot;.
</code></pre></div></div> <p>The <code>imunify360.db</code> file is an sqlite3 database the Imunify360 relies on; it contains incidents, malware hits/lists, settings, etc. Using this workaround will force the database recreation:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># service imunify360 stop
# mv /var/imunify360/imunify360.db /var/imunify360/imunify360.db_backup
# service imunify360 start
</code></pre></div></div> <p>If you face any difficulties during the progress or simply cannot make the agent start, please run</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># imunify360-agent doctor
</code></pre></div></div> <p>and provide the output to our Support Team at <a href="https://cloudlinux.zendesk.com/hc/requests/new" target="_blank" rel="noopener noreferrer">https://cloudlinux.zendesk.com/hc/requests/new<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>You can find the ImunifyAV(+) instructions <a href="https://docs.imunifyav.com/faq_and_known_issues/#imunify-agent-is-not-running-troubleshooting" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h3 id="_24-ssh-exchange-identification-connection-closed-by-remote-host-troubleshooting"><a href="#_24-ssh-exchange-identification-connection-closed-by-remote-host-troubleshooting" aria-hidden="true" class="header-anchor">#</a> 24. &quot;ssh_exchange_identification: Connection closed by remote host&quot; troubleshooting</h3> <p>If you see the <span class="notranslate">&quot;ssh_exchange_identification: Connection closed by remote host&quot;</span> few times in a row, then this might be an evidence that <span class="notranslate">SSH</span> is under bruteforce attack and some of concurrent unauthenticated connections are dropped due to the <span class="notranslate">/etc/ssh/ssh_config MaxStartups ...</span> parameter default value. Thus, we would advise you to increase the <span class="notranslate">MaxStartups ...</span> from the default (e.g. 10:30:60) to 100:30:200 or something that is proportional to your SSH server bruteforce intensity (100:30:200 is for 25 attempts per second bruteforce intensity rate).</p> <h3 id="_25-where-can-i-find-the-files-backup-location"><a href="#_25-where-can-i-find-the-files-backup-location" aria-hidden="true" class="header-anchor">#</a> 25. Where can I find the files backup location?</h3> <p>You can find the files backup location in the following directory: <code>/var/imunify360/cleanup_storage/</code>.</p> <h3 id="_26-ipset-max-elements-error-hash-is-full-cannot-add-more-elements"><a href="#_26-ipset-max-elements-error-hash-is-full-cannot-add-more-elements" aria-hidden="true" class="header-anchor">#</a> 26. Ipset max elements error &quot;Hash is full, cannot add more elements&quot;</h3> <p>We would like to describe a possible situation you may come across while adding some IP(s) into the Black/White List. In case you are experiencing difficulties with the procedure and get the following error message within the Imunify360 Dashboard or the CLI:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>Command ['/usr/sbin/ipset', 'add', 'i360.ipv4.blacklist', '11.22.33.44/32', 'timeout', '0', '-exist'] returned non-zero code 1,
Stdout: None,
Stderr: ipset v7.1: Hash is full, cannot add more elements
</code></pre></div></div> <p>This means the ipset elements limit is exceeded.</p> <p>The ipset size is hardcoded in the Imunify360 source code and currently, it is equal to a 100K IPs limit. You can confirm it with the following commands:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># ipset -t list i360.ipv4.blacklist
Name: i360.ipv4.blacklist
Type: hash:net
Revision: 3
Header: family inet hashsize 1024 maxelem 100000 timeout 0
Size in memory: 17040
References: 1
</code></pre></div></div> <p>or</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># ipset list &quot;i360.ipv4.blacklist&quot; | grep -oP '(?&lt;=maxelem )[^ ]*'
100000
</code></pre></div></div> <p>In case you wish to expand the lists to add more elements to a Black/White list, you can use the external one by creating a separate file with the list of the IPs you would like to whitelist/blacklist and placing it inside:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>/etc/imunify360/whitelist/*.txt
</code></pre></div></div> <p>or</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>/etc/imunify360/blacklist/*.txt
</code></pre></div></div> <p>Please mind that apart from single IP addresses, subnets can be also added to blacklists to block more addresses.</p> <p>Such lists support up to 500K elements. More details about configuring external lists can be found <a href="/features/#external-black-whitelist-management">here</a>.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>We also would like to clarify the decision of keeping the ipset size as it is – it's not reasonable to further increase the ipset size because it can lead to the degradation of network performance. There is no reason to keep IPs in the blacklist forever because IP addresses used by hackers are often changed. Please be informed that Imunify360 analytics do their best to provide optimal TTL for the graylist to ensure the best protection with a low false positives rate.</p></div><p>You may also want to add a whole region (or certain regions) to the blacklist, which can contain quite an impressive number of IPs. We believe the entire country cannot be malicious and crawlers can be operating from different locations. Still, if you wish to block the whole country/countries and to allow access to your server for specific IPs/subnets, we would recommend that you use the option to <a href="/dashboard/#blocked-ports">&quot;block all except specified&quot;</a> for blocking the majority of common ports and <a href="/dashboard/#white-list">whitelist the necessary IPs/subnets</a> you wish to allow access to your server.</p> <h3 id="_27-how-to-enable-scan-for-end-users"><a href="#_27-how-to-enable-scan-for-end-users" aria-hidden="true" class="header-anchor">#</a> 27. How to enable scan for end-users?</h3> <p>An administrator can enable the “scan” action for end-users in the config file via the CLI.</p> <p>End-user scans are disabled by default. To enable it, run the followint command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent config update '{&quot;PERMISSIONS&quot;: {&quot;allow_malware_scan&quot;: true}}'
</code></pre></div></div> <p>All user scans are scheduled using a single queue. Thus, multiple scans requested by users will not affect server performance.</p> <h2 id="corner-cases"><a href="#corner-cases" aria-hidden="true" class="header-anchor">#</a> Corner cases</h2> <h3 id="ip-whitelisting-port-blocking-precedence"><a href="#ip-whitelisting-port-blocking-precedence" aria-hidden="true" class="header-anchor">#</a> IP whitelisting/port blocking precedence</h3> <p>Imunify360 has a corner case related to the following behavior of the Imunify360 firewall: when some IP is whitelisted and at the same time a certain port is blocked, the access to the port for the whitelisted IP is blocked (the port setting takes precedence).</p> <p><img src="/images/corner1.jpg" alt=""> <img src="/images/corner2.jpg" alt=""></p> <p>As a workaround, you may add the IP address to &quot;Whitelisted IP&quot; list for the blocked port:</p> <p><img src="/images/corner3.jpg" alt=""></p> <p>If you wish to use CLI -  you may remove the blocked port for all IPs and add a new record with the list of whitelisted IPs. Here's an example for TCP port 2083:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent blocked-port delete 2083:tcp
imunify360-agent blocked-port add  2083:tcp --ips 69.175.3.6  10.102.1.37
</code></pre></div></div> <h2 id="plesk-related"><a href="#plesk-related" aria-hidden="true" class="header-anchor">#</a> Plesk related</h2> <h3 id="how-to-get-an-imunify-activation-key-from-the-extended-plesk-license"><a href="#how-to-get-an-imunify-activation-key-from-the-extended-plesk-license" aria-hidden="true" class="header-anchor">#</a> How to get an Imunify activation key from the extended Plesk license</h3> <p>Often our clients purchase Imunify licenses through Plesk/Odin and in such cases, they get a universal key which includes the Imunify license and other additional keys for Plesk plugins. Such a key has the following syntax – <code>A00B00-0CDE00-F0G000-HIGK00-LM0N00</code>, – and initially, it is installed through Plesk automatically and the license gets activated successfully.</p> <p>However, if it is required to re-register the agent for some reason or simply get the Imunify activation key separately, it would be impossible to apply the above-mentioned one – we would need to deal with the Imunify service separately.</p> <p>To get the Imunify360 activation key from the extended Plesk license key, you will need to proceed with the following.</p> <ol><li>Navigate to <span class="notranslate"><em>Tools &amp; Settings &gt;&gt; Plesk &gt;&gt; License Management &gt;&gt; Additional License Keys</em></span></li></ol> <p><img src="/images/LicenseManagement.png" alt=""></p> <p><img src="/images/AdditionalLicenseKeys.png" alt=""></p> <ol start="2"><li><p>Click <span class="notranslate"><em>Download key</em></span> next to the Imunify license listed on the page and open the file downloaded in some text editor</p></li> <li><p>Find the following abstract:</p></li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>&lt;!--Key body--&gt;
&lt;aps-3:key-body core:encoding=&quot;base64&quot; core:type=&quot;binary&quot;&gt;YOUR_BASE64_ENCODED_LICENSE_KEY==&lt;/aps-3:key-body&gt;
&lt;!--Information about additional key--&gt;
</code></pre></div></div> <ol start="4"><li><p>This is your base64-encoded key, and it should be decoded using a CLI utility or an online base64 decoder into UTF-8, e.g. <a href="https://www.base64decode.org" target="_blank" rel="noopener noreferrer">https://www.base64decode.org<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.
The new license key should have the following format: <code>IMxxxxxxxxxxxxxxx</code>.</p></li> <li><p>Use the new key decoded to activate the service:</p></li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># imunify360-agent register DECODED_KEY_HERE
</code></pre></div></div> <p>This is it!</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/cloudlinux/imunify360-doc/edit/dev/docs/faq_and_known_issues/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="back-to-top" data-v-5366e0dd><a href="/faq_and_known_issues/#app" class="nav-arrow top back-to-top__link" data-v-5366e0dd></a></div> </div> <div class="footer" data-v-3ca314c6><div data-v-3ca314c6><a href="https://cloudlinux.com" data-v-3ca314c6><img src="/assets/img/we-are-cloudlinux.783ed390.svg" alt="We are Cloudlinux" data-v-3ca314c6></a></div> <div class="footer-company-title" data-v-3ca314c6>2021. CloudLinux Inc</div> <div data-v-3ca314c6><div data-v-3ca314c6><a href="https://cloudlinux.zendesk.com/hc/en-us/categories/360002375980-Imunify-Security-Products" target="_blank" data-v-3ca314c6>How to</a></div><div data-v-3ca314c6><a href="https://www.imunify360.com/getting-started" target="_blank" data-v-3ca314c6>Getting started</a></div><div data-v-3ca314c6><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" data-v-3ca314c6>Contact support</a></div><div data-v-3ca314c6><a href="https://blog.imunify360.com" target="_blank" data-v-3ca314c6>Blog</a></div></div> <div class="social" data-v-3ca314c6><span class="footer-social-text" data-v-3ca314c6>Stay in touch</span> <a href="https://www.facebook.com/imunify360/" target="_blank" data-v-3ca314c6><img src="/fb.png" class="footer-social-logo" data-v-3ca314c6></a><a href="https://twitter.com/imunify360/" target="_blank" data-v-3ca314c6><img src="/tw.png" class="footer-social-logo" data-v-3ca314c6></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-3ca314c6><img src="/in.png" class="footer-social-logo" data-v-3ca314c6></a><a href="https://www.youtube.com/channel/UCcW6dDJjcy41c7Hl_5LdLZQ" target="_blank" data-v-3ca314c6><img src="/ytube.png" class="footer-social-logo" data-v-3ca314c6></a></div></div> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8f538a27.js" defer></script><script src="/assets/js/4.ad788cf3.js" defer></script><script src="/assets/js/1.ac56a00f.js" defer></script><script src="/assets/js/28.fa9dc82b.js" defer></script>
  </body>
</html>
