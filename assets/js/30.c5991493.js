(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{385:function(t,s,e){"use strict";e.r(s);var a=e(34),n=Object(a.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"hosting-panels-firewall-rulesets-specific-settings"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#hosting-panels-firewall-rulesets-specific-settings","aria-hidden":"true"}},[t._v("#")]),t._v(" Hosting Panels Firewall Rulesets Specific Settings")]),t._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#cpanel"}},[t._v("cPanel")]),e("ul",[e("li",[e("a",{attrs:{href:"#modsecurity-settings"}},[t._v("ModSecurity Settings")])])])]),e("li",[e("a",{attrs:{href:"#plesk"}},[t._v("Plesk")]),e("ul",[e("li",[e("a",{attrs:{href:"#modsecurity-configuration"}},[t._v("ModSecurity Configuration")])])])]),e("li",[e("a",{attrs:{href:"#directadmin"}},[t._v("DirectAdmin")])])])]),e("p"),t._v(" "),e("p",[t._v("This section includes specific settings for each hosting panel that Imunify360 supports. It is important to follow these instructions to setup Imunify360 plugin properly.")]),t._v(" "),e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[t._v("Note")]),e("p",[e("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(", the important software for Imunify360, is not installed automatically during Imunify360 installation process. Without "),e("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(", Imunify360 will lack the following features:")]),t._v(" "),e("ul",[e("li",[t._v("Web application firewall")]),t._v(" "),e("li",[t._v("Malware scanning of files uploaded using web")])])]),e("p",[e("span",{staticClass:"notranslate"},[t._v("Mod_security")]),t._v(" installation process is specific for different panels:")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("Find the official cPanel documentation on the link: "),e("a",{attrs:{href:"https://documentation.cpanel.net/display/EA4/Apache+Module%3A+ModSecurity#ApacheModule:ModSecurity-InstallModSecHowtoinstalloruninstallmod_security2",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://documentation.cpanel.net/display/EA4/Apache+Module%3A+ModSecurity#ApacheModule:ModSecurity-InstallModSecHowtoinstalloruninstallmod_security2"),e("OutboundLink")],1)])]),t._v(" "),e("li",[e("p",[t._v("Find the official Plesk documentation on the link: "),e("a",{attrs:{href:"https://docs.plesk.com/en-US/onyx/administrator-guide/server-administration/web-application-firewall-modsecurity.73383/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.plesk.com/en-US/onyx/administrator-guide/server-administration/web-application-firewall-modsecurity.73383/"),e("OutboundLink")],1)])])]),t._v(" "),e("div",{staticClass:"danger custom-block"},[e("p",{staticClass:"custom-block-title"},[t._v("Important!")]),e("p",[t._v("If "),e("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" is installed after Imunify360, it is important to execute the following command to add "),e("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" ruleset to Imunify360:")]),t._v(" "),e("p",[t._v("For cPanel/Plesk/DirectAdmin/Stand-alone:")]),t._v(" "),e("div",{staticClass:"notranslate"},[e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("imunify360-agent install-vendors\n")])])])])]),e("p",[t._v("If "),e("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" is installed before Imunify360, the rules will be installed automatically.")]),t._v(" "),e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[t._v("Note")]),e("p",[t._v("If Imunify360 installer detects any existing ruleset, it installs only minimal set of its rules. So, you need to disable all third-party rulesets prior to Imunify360 installation to get the full ruleset installed automatically.")])]),e("h2",{attrs:{id:"cpanel"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cpanel","aria-hidden":"true"}},[t._v("#")]),t._v(" cPanel")]),t._v(" "),e("p",[t._v("It is possible to enable "),e("span",{staticClass:"notranslate"},[t._v("Service Status")]),t._v(" checker for Imunify360. To do so, perform the following steps:")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("Go to "),e("span",{staticClass:"notranslate"},[e("em",[t._v("Service Configuration")])]),t._v(" and choose "),e("span",{staticClass:"notranslate"},[e("em",[t._v("Service Manager")])]),t._v(".")])]),t._v(" "),e("li",[e("p",[t._v("In "),e("span",{staticClass:"notranslate"},[e("em",[t._v("Additional Services")])]),t._v(" section tick "),e("span",{staticClass:"notranslate"},[e("code",[t._v("imunify360")])]),t._v(" and "),e("span",{staticClass:"notranslate"},[e("code",[t._v("imunify360-webshield")])]),t._v(" checkboxes.")])]),t._v(" "),e("li",[e("p",[t._v("Click "),e("span",{staticClass:"notranslate"},[e("em",[t._v("Save")])]),t._v(" and wait until cPanel enables the "),e("span",{staticClass:"notranslate"},[t._v("Service Status")]),t._v(" checker for Imunify360.")])])]),t._v(" "),e("p",[e("img",{attrs:{src:"/images/cpanel_set01.png",alt:""}})]),t._v(" "),e("p",[t._v("If succeeded, the status of Imunify360 service will be displayed at "),e("span",{staticClass:"notranslate"},[t._v("Service Status")]),t._v(" section of "),e("span",{staticClass:"notranslate"},[t._v("Server Status")]),t._v(".")]),t._v(" "),e("p",[e("img",{attrs:{src:"/images/cpanel_set02.png",alt:""}})]),t._v(" "),e("h3",{attrs:{id:"modsecurity-settings"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#modsecurity-settings","aria-hidden":"true"}},[t._v("#")]),t._v(" ModSecurity Settings")]),t._v(" "),e("p",[t._v("Recommended "),e("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" settings are:")]),t._v(" "),e("ul",[e("li",[e("span",{staticClass:"notranslate"},[t._v("Audit Log Level – Only log noteworthy transactions")])]),t._v(" "),e("li",[e("span",{staticClass:"notranslate"},[t._v("Connections Engine – Do not process the rules")])]),t._v(" "),e("li",[e("span",{staticClass:"notranslate"},[t._v("Rules Engine – Process the rules")])])]),t._v(" "),e("p",[e("img",{attrs:{src:"/images/modsecuritysettings.png",alt:""}})]),t._v(" "),e("p",[t._v("It’s also recommended to disable any third-party "),e("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" vendors except Imunify360 ruleset (especially "),e("strong",[t._v("OWASP")]),t._v(" and "),e("strong",[t._v("Comodo")]),t._v(" ). These rulesets can cause large number of false-positives and duplicate Imunify360 ruleset.")]),t._v(" "),e("p",[t._v("To do so, go to "),e("span",{staticClass:"notranslate"},[t._v("ModSecurity Vendors")]),t._v(" section of cPanel main menu, and switch to "),e("span",{staticClass:"notranslate"},[e("code",[t._v("Off")])]),t._v(" all enabled vendors except Imunify360 ruleset.\nIf there is no Imunify360 ruleset installed, run "),e("span",{staticClass:"notranslate"},[e("code",[t._v("imunify360-agent install-vendors")])]),t._v(" command.")]),t._v(" "),e("p",[e("img",{attrs:{src:"/images/whmmodsecurityvendors_zoom70.png",alt:""}})]),t._v(" "),e("ul",[e("li",[e("p",[t._v("Enable rules auto-update. Otherwise, you won't get important updates of ModSecurity ruleset in time")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("For Apache run the following command:")]),t._v(" "),e("div",{staticClass:"notranslate"},[e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("/usr/local/cpanel/scripts/modsec_vendor enable-updates imunify360-full-apache\n")])])])])]),t._v(" "),e("li",[e("p",[t._v("For LiteSpeed run the following command:")]),t._v(" "),e("div",{staticClass:"notranslate"},[e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("/usr/local/cpanel/scripts/modsec_vendor enable-updates imunify360-full-litespeed \n")])])])])])]),t._v(" "),e("p",[t._v("See details "),e("a",{attrs:{href:"https://documentation.cpanel.net/display/82Docs/ModSecurity+Vendors#ModSecurityVendors-Enableordisableupdates",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("Or you can use "),e("a",{attrs:{href:"https://documentation.cpanel.net/display/DD/WHM+API+1+Functions+-+modsec_enable_vendor_updates",target:"_blank",rel:"noopener noreferrer"}},[t._v("WHMAPI1"),e("OutboundLink")],1),t._v(" to enable vendor auto-updates.")])]),t._v(" "),e("li",[e("p",[t._v("It is possible to block ModSecurity rules only for IPs that belong to some country. More info can be found in "),e("RouterLink",{attrs:{to:"/faq_and_known_issues/#_9-disabling-waf-rules-for-certain-countries"}},[t._v("FAQ")])],1)])]),t._v(" "),e("h2",{attrs:{id:"plesk"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#plesk","aria-hidden":"true"}},[t._v("#")]),t._v(" Plesk")]),t._v(" "),e("p",[t._v("It is not recommended to use firewalld and Plesk Firewall simultaneously, because Plesk does not fully support such configuration. We recommend to disable firewalld by running the command on the server:")]),t._v(" "),e("div",{staticClass:"notranslate"},[e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("systemctl disable firewalld\n")])])])]),t._v(" "),e("p",[t._v("Read more about the problem at Plesk Help Center in this "),e("a",{attrs:{href:"https://support.plesk.com/hc/en-us/articles/115000905285-Plesk-Firewall-and-firewalld",target:"_blank",rel:"noopener noreferrer"}},[t._v("thread"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"modsecurity-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#modsecurity-configuration","aria-hidden":"true"}},[t._v("#")]),t._v(" ModSecurity Configuration")]),t._v(" "),e("ul",[e("li",[e("span",{staticClass:"notranslate"},[t._v("Web application firewall mode – On")])])]),t._v(" "),e("p",[e("img",{attrs:{src:"/images/modsecurityconfigurationpleskonyx.png",alt:""}})]),t._v(" "),e("p",[t._v("If any "),e("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" ruleset was installed during Imunify360 installation, Imunify360 will not install its own ruleset, because Plesk supports only one ruleset at once.")]),t._v(" "),e("p",[t._v("To check, if Imunify360 ruleset is installed, run the following as root:")]),t._v(" "),e("div",{staticClass:"notranslate"},[e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# plesk sbin modsecurity_ctl -L --enabled")]),t._v("\ncustom\n")])])])]),t._v(" "),e("p",[t._v("If the output does not contain imunify360, for example:")]),t._v(" "),e("div",{staticClass:"notranslate"},[e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# plesk sbin modsecurity_ctl -L --enabled")]),t._v("\ntortix\n")])])])]),t._v(" "),e("p",[t._v("Then remove existing ruleset and install Imunify360 one:")]),t._v(" "),e("div",{staticClass:"notranslate"},[e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# plesk sbin modsecurity_ctl --disable-all-rules --ruleset tortix")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# plesk sbin modsecurity_ctl --uninstall --ruleset tortix")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# plesk sbin modsecurity_ctl -L --enabled")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# imunify360-agent install-vendors")]),t._v("\nINFO    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("+ 3785ms"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                         defence360agent.simple_rpc"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("Executing "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'install-vendors'")]),t._v(","),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(", params: "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nINFO    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("+ 8781ms"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("   defence360agent.subsys.panels.plesk.mod_security"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("Successfully installed vendor "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'imunify360-full-apache'")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v(".")]),t._v("\nINFO    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("+ 8782ms"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                  defence360agent.subsys.web_server"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("Performing web_server graceful restart\nOK\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# plesk sbin modsecurity_ctl -L --enabled")]),t._v("\ncustom\n")])])])]),t._v(" "),e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[t._v("Note")]),e("p",[t._v("Please make sure that "),e("span",{staticClass:"notranslate"},[e("em",[t._v("Update rule sets")])]),t._v(" option is disabled in your Plesk "),e("span",{staticClass:"notranslate"},[e("em",[t._v("Web Application Firewall")])]),t._v(" interface on the "),e("span",{staticClass:"notranslate"},[e("em",[t._v("Settings")])]),t._v(" tab.")])]),e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[t._v("Note")]),e("p",[t._v("Note that in the current version of Plesk, "),e("span",{staticClass:"notranslate"},[e("em",[t._v("Update rule sets")])]),t._v(" option is available if one of the "),e("span",{staticClass:"notranslate"},[e("em",[t._v("Atomic Basic ModSecurity/Advanced ModSecurity Rules by Atomicorp/Comodo ModSecurity")])]),t._v(" Rule Set is enabled.")])]),e("h2",{attrs:{id:"directadmin"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#directadmin","aria-hidden":"true"}},[t._v("#")]),t._v(" DirectAdmin")]),t._v(" "),e("p",[t._v("During installation on DirectAdmin, Imunify360 will try to install "),e("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" automatically using custombuild 2.0.")]),t._v(" "),e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[t._v("Note")]),e("p",[t._v("Automatic installation of Imunify360 ruleset is only supported with custombuild 2.0.")])])])},[],!1,null,null,null);s.default=n.exports}}]);