<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Imunify360 Features | Documentation</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="To use external files with the list of Black/White IPs, place this list into the following directory:">
    <meta name="image" content="https://docs.imunify360.com/images/LowResourceUsage.png">
    <meta name="twitter:title" content="Imunify360 Features">
    <meta name="twitter:description" content="To use external files with the list of Black/White IPs, place this list into the following directory:">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://docs.imunify360.com/images/LowResourceUsage.png">
    <meta name="twitter:url" content="https://docs.imunify360.com/features/">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Imunify360 Features">
    <meta property="og:description" content="To use external files with the list of Black/White IPs, place this list into the following directory:">
    <meta property="og:image" content="https://docs.imunify360.com/images/LowResourceUsage.png">
    <meta property="og:url" content="https://docs.imunify360.com/features/">
    <meta property="og:site_name" content="Imunify 360 Documentation">
    <meta itemprop="name" content="Imunify360 Features">
    <meta itemprop="description" content="To use external files with the list of Black/White IPs, place this list into the following directory:">
    <meta itemprop="image" content="https://docs.imunify360.com/images/LowResourceUsage.png">
    <link rel="preload" href="/assets/css/0.styles.6006968c.css" as="style"><link rel="preload" href="/assets/js/app.8f538a27.js" as="script"><link rel="preload" href="/assets/js/4.ad788cf3.js" as="script"><link rel="preload" href="/assets/js/1.ac56a00f.js" as="script"><link rel="preload" href="/assets/js/29.c1a62275.js" as="script"><link rel="preload" href="/assets/js/19.e19b2aac.js" as="script"><link rel="prefetch" href="/assets/js/10.c28c2ce4.js"><link rel="prefetch" href="/assets/js/11.ecb5ecdf.js"><link rel="prefetch" href="/assets/js/12.bebabae6.js"><link rel="prefetch" href="/assets/js/13.922873af.js"><link rel="prefetch" href="/assets/js/14.aa3cdb24.js"><link rel="prefetch" href="/assets/js/15.0f275457.js"><link rel="prefetch" href="/assets/js/16.d493685a.js"><link rel="prefetch" href="/assets/js/17.f6d2650c.js"><link rel="prefetch" href="/assets/js/18.55041527.js"><link rel="prefetch" href="/assets/js/20.ff5b0bf4.js"><link rel="prefetch" href="/assets/js/21.2c93ea93.js"><link rel="prefetch" href="/assets/js/22.cbc20958.js"><link rel="prefetch" href="/assets/js/23.ba18fca1.js"><link rel="prefetch" href="/assets/js/24.2305918e.js"><link rel="prefetch" href="/assets/js/25.bfa6f6a8.js"><link rel="prefetch" href="/assets/js/26.106d44b6.js"><link rel="prefetch" href="/assets/js/27.50b92db3.js"><link rel="prefetch" href="/assets/js/28.fa9dc82b.js"><link rel="prefetch" href="/assets/js/30.c5991493.js"><link rel="prefetch" href="/assets/js/31.24418d61.js"><link rel="prefetch" href="/assets/js/32.60f2cf7b.js"><link rel="prefetch" href="/assets/js/33.9e23ba42.js"><link rel="prefetch" href="/assets/js/34.802ede2c.js"><link rel="prefetch" href="/assets/js/35.cd6f9b1f.js"><link rel="prefetch" href="/assets/js/36.27b9d486.js"><link rel="prefetch" href="/assets/js/37.8eaf62ec.js"><link rel="prefetch" href="/assets/js/38.49a5f959.js"><link rel="prefetch" href="/assets/js/39.8edfc7ec.js"><link rel="prefetch" href="/assets/js/40.d4834493.js"><link rel="prefetch" href="/assets/js/41.4ecce336.js"><link rel="prefetch" href="/assets/js/42.5758db9d.js"><link rel="prefetch" href="/assets/js/43.c2196607.js"><link rel="prefetch" href="/assets/js/44.c303d7b2.js"><link rel="prefetch" href="/assets/js/45.5657a3e1.js"><link rel="prefetch" href="/assets/js/46.7401098e.js"><link rel="prefetch" href="/assets/js/47.666cbf98.js"><link rel="prefetch" href="/assets/js/48.e9068ece.js"><link rel="prefetch" href="/assets/js/49.f9866028.js"><link rel="prefetch" href="/assets/js/5.a791a612.js"><link rel="prefetch" href="/assets/js/50.b083857b.js"><link rel="prefetch" href="/assets/js/51.0bbf32ee.js"><link rel="prefetch" href="/assets/js/52.ba794043.js"><link rel="prefetch" href="/assets/js/53.8968d12f.js"><link rel="prefetch" href="/assets/js/54.749e0af6.js"><link rel="prefetch" href="/assets/js/55.16839767.js"><link rel="prefetch" href="/assets/js/56.478c922f.js"><link rel="prefetch" href="/assets/js/57.8fbd5f38.js"><link rel="prefetch" href="/assets/js/58.0be5b685.js"><link rel="prefetch" href="/assets/js/59.1cba522b.js"><link rel="prefetch" href="/assets/js/6.ecbbd367.js"><link rel="prefetch" href="/assets/js/60.1672bf0a.js"><link rel="prefetch" href="/assets/js/61.5363a453.js"><link rel="prefetch" href="/assets/js/62.934d99c2.js"><link rel="prefetch" href="/assets/js/63.17e5db2d.js"><link rel="prefetch" href="/assets/js/64.8600bb47.js"><link rel="prefetch" href="/assets/js/65.afafe3d8.js"><link rel="prefetch" href="/assets/js/7.8c8d2896.js"><link rel="prefetch" href="/assets/js/8.181ff140.js"><link rel="prefetch" href="/assets/js/9.f158522a.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.38015cce.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6006968c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/introduction/" class="home-link"><img src="/logo.svg" alt="Documentation" class="logo"> <span class="site-name site-name--documentation can-hide">Documentation</span></a> <form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <div class="links" style="max-width:nullpx;"><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" class="btn">
      Submit Request
    </a> <a href="https://www.imunify360.com/trial" target="_blank" class="btn">
      Try Free
    </a> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><span class="title">Language:</span> <a class="dropdown-title"><span class="text">En</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/features/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/ru/features/" class="nav-link">Русский</a></li></ul></div></div></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><span class="title">Language:</span> <a class="dropdown-title"><span class="text">En</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/features/" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/ru/features/" class="nav-link">Русский</a></li></ul></div></div></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><div class="sidebar-heading open"><span>Contents</span> <!----></div> <ul class="sidebar-group-items"><li><div><a href="/introduction/" class="sidebar-link">Introduction</a></div></li><li><div><a href="/terminology/" class="sidebar-link">Terminology</a></div></li><li><div><a href="/billing/" class="sidebar-link">Billing</a></div></li><li><div class="sidebar-header sidebar-link"><div><a href="/installation/" class="sidebar-link">Installation Guide</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/installation/#requirements" class="sidebar-link">Requirements</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/installation/#side-by-side-installation-with-another-ids" class="sidebar-link">Side by side installation with another</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/installation/#installation-instructions" class="sidebar-link">Installation Instructions</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/installation/#registering" class="sidebar-link">Registering</a></div></li><li class="sidebar-sub-header"><div><a href="/installation/#selinux-support" class="sidebar-link">SELinux support</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/installation/#update-instructions" class="sidebar-link">Update Instructions</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/installation/#gradual-roll-out" class="sidebar-link">Gradual roll-out</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link sidebar-header--empty"><div><a href="/stand_alone/" class="sidebar-link">Imunify360 Stand-alone</a></div></div><ul class="sidebar-sub-headers"></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/ids_integration/" class="sidebar-link">IDS Integrations</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/ids_integration/#csf-integration" class="sidebar-link">CSF Integration</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/ids_integration/#cxs-integration" class="sidebar-link">CXS Integration</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/webshield/" class="sidebar-link">WebShield</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/webshield/#captcha" class="sidebar-link">Captcha</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/webshield/#captcha-page-customization" class="sidebar-link">Captcha page customization</a></div></li><li class="sidebar-sub-header"><div><a href="/webshield/#update-captcha-localizations" class="sidebar-link">Update Captcha localizations</a></div></li><li class="sidebar-sub-header"><div><a href="/webshield/#changing-the-default-keys-to-google-recaptcha-keys" class="sidebar-link">Changing the default keys to Google reCAPTCHA keys</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/webshield/#configuring-recaptcha-keys" class="sidebar-link">Configuring reCAPTCHA keys</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/webshield/#how-to-specify-the-keys-for-the-imunify360-captcha" class="sidebar-link">How to specify the keys for the Imunify360 CAPTCHA</a></div></li><li class="sidebar-sub-header"><div><a href="/webshield/#steps-to-configure" class="sidebar-link">Steps to configure</a></div></li><li class="sidebar-sub-header"><div><a href="/webshield/#verification" class="sidebar-link">Verification</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/webshield/#cdn-support" class="sidebar-link">CDN Support</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/webshield/#splashscreen-for-chinese-customers" class="sidebar-link">SplashScreen for Chinese customers</a></div></li><li class="sidebar-sub-header"><div><a href="/webshield/#how-to-block-attacks-from-a-particular-country-in-webshield" class="sidebar-link">How to block attacks from a particular country in WebShield</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/backup_providers_integration/" class="sidebar-link">Backup Providers Integration</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/backup_providers_integration/#overview" class="sidebar-link">Overview</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/backup_providers_integration/#command-line-usage" class="sidebar-link">Command Line Usage</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#synopsis" class="sidebar-link">Synopsis</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#actions" class="sidebar-link">Actions</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/backup_providers_integration/#using-as-library" class="sidebar-link">Using as Library</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#restoring-infected-files" class="sidebar-link">Restoring Infected Files</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#operating-with-backend" class="sidebar-link">Operating With Backend</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#operating-with-backup" class="sidebar-link">Operating With Backup</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#operating-with-file-in-backup" class="sidebar-link">Operating With File in Backup</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/backup_providers_integration/#creating-custom-backup-backend-plugin" class="sidebar-link">Creating Custom Backup Backend Plugin</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#creating-module" class="sidebar-link">Creating Module</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#defining-classes" class="sidebar-link">Defining Classes</a></div></li><li class="sidebar-sub-header"><div><a href="/backup_providers_integration/#implementing-api-functions" class="sidebar-link">Implementing API Functions</a></div></li></ul></li></ul></li><li><div><a href="/localization/" class="sidebar-link">Localization</a></div></li><li><div class="sidebar-header sidebar-link"><div><a href="/dashboard/" class="sidebar-link">Imunify360 Admin Interface</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#support" class="sidebar-link">Support</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#dashboard" class="sidebar-link">Dashboard</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#imunify-advisor" class="sidebar-link">Imunify Advisor</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#multi-server-dashboard" class="sidebar-link">Multi-server Dashboard</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#charts-and-heat-maps" class="sidebar-link">Charts and heat maps</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#incidents" class="sidebar-link">Incidents</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#firewall" class="sidebar-link">Firewall</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#white-list" class="sidebar-link">White List</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#gray-list" class="sidebar-link">Gray List</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#black-list" class="sidebar-link">Black List</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#global-black-white-list-ip-management" class="sidebar-link">Global Black/White list IP management</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#blocked-ports" class="sidebar-link">Blocked Ports</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#malware-scanner" class="sidebar-link">Malware Scanner</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#users" class="sidebar-link">Users</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#files" class="sidebar-link">Files</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#scan" class="sidebar-link">Scan</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#history" class="sidebar-link">History</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#ignore-list" class="sidebar-link">Ignore List</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#proactive-defense" class="sidebar-link">Proactive Defense</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#overview" class="sidebar-link">Overview</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#user-interface" class="sidebar-link">User Interface</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#reputation-management" class="sidebar-link">Reputation Management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/dashboard/#kernelcare-integration" class="sidebar-link">KernelCare Integration</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/dashboard/#settings" class="sidebar-link">Settings</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/dashboard/#general" class="sidebar-link">General</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#malware" class="sidebar-link">Malware</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#backups" class="sidebar-link">Backups</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#disabled-rules" class="sidebar-link">Disabled Rules</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#features-management" class="sidebar-link">Features Management</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#native-feature-management" class="sidebar-link">Native Feature Management</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#whm-cpanel" class="sidebar-link">WHM/cPanel</a></div></li><li class="sidebar-sub-header"><div><a href="/dashboard/#attributions" class="sidebar-link">Attributions</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/user_interface/" class="sidebar-link">Imunify360 User Interface</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/user_interface/#files" class="sidebar-link">Files</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/user_interface/#history" class="sidebar-link">History</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/user_interface/#ignore-list" class="sidebar-link">Ignore List</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/hosting_panels_specific_settin/" class="sidebar-link">Hosting Panels Firewall Rulesets Specific Settings</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/hosting_panels_specific_settin/#cpanel" class="sidebar-link">cPanel</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/hosting_panels_specific_settin/#modsecurity-settings" class="sidebar-link">ModSecurity Settings</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/hosting_panels_specific_settin/#plesk" class="sidebar-link">Plesk</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/hosting_panels_specific_settin/#modsecurity-configuration" class="sidebar-link">ModSecurity Configuration</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/hosting_panels_specific_settin/#directadmin" class="sidebar-link">DirectAdmin</a></div></li></ul></li><li><div class="sidebar-header sidebar-link sidebar-header--empty"><div><a href="/config_file_description/" class="sidebar-link">Config File Description</a></div></div><ul class="sidebar-sub-headers"></ul></li><li><div class="active collapsed sidebar-header sidebar-link"><div class="active"><a href="/features/" class="active sidebar-link">Imunify360 Features</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/features/#external-black-whitelist-management" class="sidebar-link">External Black/Whitelist Management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#rapidscan" class="sidebar-link">RapidScan</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#low-resource-usage-mode" class="sidebar-link">Low Resource Usage mode</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/features/#exim-dovecot-brute-force-attack-protection" class="sidebar-link">Exim+Dovecot brute-force attack protection</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/features/#hooks" class="sidebar-link">Hooks</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/features/#overview" class="sidebar-link">Overview</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#how-to-start-using-hooks" class="sidebar-link">How to start using hooks</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#available-events-and-their-parameters" class="sidebar-link">Available events and their parameters</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#cli" class="sidebar-link">CLI</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#native" class="sidebar-link">Native</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#log-file" class="sidebar-link">Log File</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#structure-and-examples-of-a-hook-script" class="sidebar-link">Structure and examples of a hook script</a></div></li><li class="sidebar-sub-header"><div><a href="/features/#notifications" class="sidebar-link">Notifications</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/features/#malware-database-scanner-mds" class="sidebar-link">Malware Database Scanner (MDS)</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/features/#how-to-use-malware-database-scanner-mds" class="sidebar-link">How to use Malware Database Scanner (MDS)</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/command_line_interface/" class="sidebar-link">Command-line Interface (CLI)</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#_3rdparty" class="sidebar-link">3rdparty</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#backup-systems" class="sidebar-link">Backup systems</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#blacklist" class="sidebar-link">Blacklist</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#blocked-ports" class="sidebar-link">Blocked ports</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#blocked-port-ip" class="sidebar-link">Blocked Port IP</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#checkdb" class="sidebar-link">Checkdb</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#check-domains" class="sidebar-link">Check-domains</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#check-modsec-directives" class="sidebar-link">Check modsec directives</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#clean" class="sidebar-link">Clean</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#config" class="sidebar-link">Config</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#doctor" class="sidebar-link">Doctor</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#eula" class="sidebar-link">Eula</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#features" class="sidebar-link">Features</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#feature-management" class="sidebar-link">Feature-management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#fix-modsec-directives" class="sidebar-link">Fix modsec directives</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#get" class="sidebar-link">Get</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#graylist" class="sidebar-link">Graylist</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#hooks" class="sidebar-link">Hooks</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#import" class="sidebar-link">Import</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#infected-domains" class="sidebar-link">Infected-domains</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#login" class="sidebar-link">Login</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#malware" class="sidebar-link">Malware</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#notifications-config" class="sidebar-link">Notifications config</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#proactive" class="sidebar-link">Proactive</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#register" class="sidebar-link">Register</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#reload-lists" class="sidebar-link">Reload lists</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#remote-proxy" class="sidebar-link">Remote-proxy</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#rstatus" class="sidebar-link">Rstatus</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#rules" class="sidebar-link">Rules</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#submit-false-positive-false-negative" class="sidebar-link">Submit false-positive/false-negative</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#unregister" class="sidebar-link">Unregister</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#vendors" class="sidebar-link">Vendors</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#version" class="sidebar-link">Version</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#whitelist" class="sidebar-link">Whitelist</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/command_line_interface/#whitelisted-crawlers" class="sidebar-link">Whitelisted crawlers</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/faq_and_known_issues/" class="sidebar-link">FAQ and Known Issues</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/faq_and_known_issues/#common-questions" class="sidebar-link">Common Questions</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_1-end-user-ip-is-blocked-and-i-do-not-know-why" class="sidebar-link">1. End user IP is blocked and I do not know why</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_2-could-i-disable-iptables-firewall-or-ossec-when-using-imunify360" class="sidebar-link">2. Could I disable IPtables (firewall) or OSSEC, when using Imunify360?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_3-does-imunify360-log-events-such-as-adding-or-removing-an-ip-to-from-the-gray-list" class="sidebar-link">3. Does Imunify360 log events such as adding or removing an IP to/from the Gray List?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_5-to-start-using-imunify360-we-need-to-know-which-information-is-sent-to-your-servers-could-you-please-give-us-some-more-information" class="sidebar-link">5. To start using Imunify360 we need to know which information is sent to your servers. Could you please give us some more information?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_6-no-valid-imunify360-license-found" class="sidebar-link">6. No valid Imunify360 License Found.</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_7-i-have-an-error-peewee-databaseerror-database-disk-image-is-malformed-what-should-i-do" class="sidebar-link">7. I have an error peewee.DatabaseError: database disk image is malformed. What should I do?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_8-why-does-my-cpanel-with-litespeed-and-owasp-modsecurity-rule-set-trigger-500-error-on-all-web-pages-after-installing-imunify360" class="sidebar-link">8. Why does my cPanel with LiteSpeed and OWASP ModSecurity rule set trigger 500 error on all web pages after installing Imunify360?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_9-disabling-waf-rules-for-certain-countries" class="sidebar-link">9. Disabling WAF rules for certain countries.</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_10-how-to-clone-imunify360-configuration-on-another-system" class="sidebar-link">10. How to clone Imunify360 configuration on another system?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_11-how-to-disable-support-icon-in-the-imunify360-ui" class="sidebar-link">11. How to disable Support icon in the Imunify360 UI?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_12-how-to-hide-the-ignore-list-tab-for-end-users-in-the-imunify360-ui" class="sidebar-link">12. How to hide the Ignore List tab for end users in the Imunify360 UI?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_13-how-to-delete-malware-scan-results-from-imunify360-s-database" class="sidebar-link">13. How to delete malware scan results from Imunify360’s database?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_14-imunify360-webshield-could-not-allocate-memory-problem-how-to-fix" class="sidebar-link">14. Imunify360 WebShield ‘Could not allocate memory’ problem. How to fix?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_15-how-to-check-modsecurity-scan-works" class="sidebar-link">15. How to check &quot;ModSecurity scan&quot; works?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_16-how-to-check-automatically-scan-all-modified-files-works" class="sidebar-link">16. How to check &quot;automatically scan all modified files&quot; works?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_17-malware-file-reasons" class="sidebar-link">17. Malware file reasons</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_18-can-imunify360-firewall-block-traffic-by-domain-name" class="sidebar-link">18. Can Imunify360 firewall block traffic by domain name?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_19-what-ports-are-used-by-webshield" class="sidebar-link">19. What ports are used by WebShield?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_20-how-to-check-that-captcha-works" class="sidebar-link">20. How to check that CAPTCHA works?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_21-how-to-edit-watched-and-excluded-patterns-for-malware-scanner" class="sidebar-link">21. How to edit watched and excluded patterns for Malware Scanner?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_22-how-to-test-rules-based-on-modsecurity-tags" class="sidebar-link">22. How to test rules based on ModSecurity tags?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_23-imunify-agent-is-not-running-troubleshooting" class="sidebar-link">23. &quot;Imunify agent is not running&quot; troubleshooting</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_24-ssh-exchange-identification-connection-closed-by-remote-host-troubleshooting" class="sidebar-link">24. &quot;sshexchangeidentification: Connection closed by remote host&quot; troubleshooting</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_25-where-can-i-find-the-files-backup-location" class="sidebar-link">25. Where can I find the files backup location?</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_26-ipset-max-elements-error-hash-is-full-cannot-add-more-elements" class="sidebar-link">26. Ipset max elements error &quot;Hash is full, cannot add more elements&quot;</a></div></li><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#_27-how-to-enable-scan-for-end-users" class="sidebar-link">27. How to enable scan for end-users?</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/faq_and_known_issues/#corner-cases" class="sidebar-link">Corner cases</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#ip-whitelisting-port-blocking-precedence" class="sidebar-link">IP whitelisting/port blocking precedence</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/faq_and_known_issues/#plesk-related" class="sidebar-link">Plesk related</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/faq_and_known_issues/#how-to-get-an-imunify-activation-key-from-the-extended-plesk-license" class="sidebar-link">How to get an Imunify activation key from the extended Plesk license</a></div></li></ul></li></ul></li><li><div><a href="/whmcs_plugin/" class="sidebar-link">Imunify360 WHMCS Plugin</a></div></li><li><div><a href="/uninstall/" class="sidebar-link">Uninstall</a></div></li></ul></div></li></ul> </div> <div class="page"> <div class="breadcrumb-wrapper page-breadcrumb" data-v-5e0e0acf><span class="breadcrumb-title" data-v-5e0e0acf>Documentation:</span> <a href="/features/" class="breadcrumb router-link-exact-active router-link-active" data-v-5e0e0acf>
    Imunify360 Features
  </a></div> <div class="page-nav-wrapper"><div class="page-nav"><a href="/config_file_description/" class="nav-arrow left"></a> <a href="/command_line_interface/" class="nav-arrow right"></a></div></div> <div class="content content__default"><h1 id="imunify360-features"><a href="#imunify360-features" aria-hidden="true" class="header-anchor">#</a> Imunify360 Features</h1> <p></p><div class="table-of-contents"><ul><li><a href="#external-black-whitelist-management">External Black/Whitelist Management</a></li><li><a href="#rapidscan">RapidScan</a></li><li><a href="#low-resource-usage-mode">Low Resource Usage mode</a></li><li><a href="#exim-dovecot-brute-force-attack-protection">Exim+Dovecot brute-force attack protection</a></li><li><a href="#hooks-badge-text-deprecated-type-warning">Hooks <span class="badge warning" style="vertical-align:top;" data-v-17014d78>Deprecated</span></a><ul><li><a href="#overview">Overview</a></li><li><a href="#how-to-start-using-hooks">How to start using hooks</a></li><li><a href="#available-events-and-their-parameters">Available events and their parameters</a></li><li><a href="#cli">CLI</a></li><li><a href="#native">Native</a></li><li><a href="#log-file">Log File</a></li><li><a href="#structure-and-examples-of-a-hook-script">Structure and examples of a hook script</a></li><li><a href="#notifications">Notifications</a></li></ul></li><li><a href="#malware-database-scanner-mds">Malware Database Scanner (MDS)</a><ul><li><a href="#how-to-use-malware-database-scanner-mds">How to use Malware Database Scanner (MDS)</a></li></ul></li></ul></div><p></p> <h2 id="external-black-whitelist-management"><a href="#external-black-whitelist-management" aria-hidden="true" class="header-anchor">#</a> External Black/Whitelist Management</h2> <p>To use external files with the list of <span class="notranslate">Black/White IPs</span>, place this list into the following directory:</p> <ul><li>for the White List:</li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>/etc/imunify360/whitelist/*.txt
</code></pre></div></div> <ul><li>for the Black List:</li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>/etc/imunify360/blacklist/*.txt
</code></pre></div></div> <p>The files may have IP addresses or subnet in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing" target="_blank" rel="noopener noreferrer">CIDR notation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>In order to apply the IP lists, run the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent reload-lists
</code></pre></div></div> <p>Or restart the agent.</p> <div class="warning custom-block"><p class="custom-block-title">Warning</p><p>Specifying IPs in those files will not prevent Imunify from adding the same IPs to dynamic lists (like Gray list), but all White lists always have the priority over Black lists when it comes to actual filtering of requests/packages.</p></div><h2 id="rapidscan"><a href="#rapidscan" aria-hidden="true" class="header-anchor">#</a> RapidScan</h2> <p>RapidScan feature allows you to increase scanning speed by lower system resource usage and gives you an opportunity to scan more frequently, further hardening your systems’ security posture.</p> <h4 id="rapidscan-techniques"><a href="#rapidscan-techniques" aria-hidden="true" class="header-anchor">#</a> RapidScan techniques</h4> <ul><li><strong>Faster File Integrity Checking</strong>. File metadata, such as file hashes, are stored locally. This means that unchanged files don't need to be rescanned.</li> <li><strong>Efficient Cloud-assisted Scanning</strong>. Imunify360 stores its malicious file hash database in the cloud. We detect malicious files and skip white-listed files. The remaining files are fewer, so the overall scan time is significantly reduced.</li> <li><strong>Optimized Malware Signatures</strong>. Our malware signature database continually expands to match the variety of malicious software. While the database becomes more accurate and comprehensive, it also becomes larger and more cumbersome to index. We tackle this by actively curating the database and re-evaluating complex signatures, recasting any that affect scanning performance.</li></ul> <h4 id="what-does-it-mean-to-you"><a href="#what-does-it-mean-to-you" aria-hidden="true" class="header-anchor">#</a> What does it mean to you?</h4> <p>When you first enable the RapidScan feature, the first scan will run as before. But subsequent scans will see a speed improvement, anywhere between 5 to 20 times faster. This is the case for both on-demand and scheduled scans, and means you can afford more scans without affecting system performance.</p> <p>To take advantage of these new improvements, go to your Imunify360 control panel and enable RapidScan in Settings→Malware Scanner. See details <a href="/dashboard/#malware">here</a>.</p> <h2 id="low-resource-usage-mode"><a href="#low-resource-usage-mode" aria-hidden="true" class="header-anchor">#</a> Low Resource Usage mode</h2> <p>This is a special operation mode where Imunify360 consumes less CPU and RAM. It is intended for servers with limited resources.</p> <p>This mode disables <span class="notranslate"><a href="/webshield/">WebShield</a></span> switching off GrayList and Captcha.</p> <p><span class="notranslate"><em>Low Resource Usage</em></span> mode also enables the <span class="notranslate"><em><a href="/dashboard/#waf-settings">Minimized Modsec Ruleset</a></em></span> option that disables Imunify WAF rules with a high memory footprint, leaving critical rulesets enabled.</p> <p>When the <span class="notranslate"><em>Low Resource Usage</em></span> mode is activated it is reflected on the UI: an Imunify main menu changes color to light green, and an appropriate label appears on the top right.</p> <p><img src="/images/LowResourceUsage.png" alt=""></p> <h2 id="exim-dovecot-brute-force-attack-protection"><a href="#exim-dovecot-brute-force-attack-protection" aria-hidden="true" class="header-anchor">#</a> Exim+Dovecot brute-force attack protection</h2> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>cPanel only, other panels will be added later</p></div><p>Exim+Dovecot brute-force attack protection is an advanced protection against Dovecot brute-force attacks. PAM module protects against IMAP/POP3 brute-force attack and prevents mail account from being compromised via brute-forcing.</p> <p><strong>How to enable Dovecot</strong></p> <p>We recommend using Imunify360 agent config to enable Dovecot because this allows to correctly switch OSSEC rules/configs:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent config update '{&quot;PAM&quot;: {&quot;enable&quot;: true, &quot;exim_dovecot_protection&quot;: true}}'
</code></pre></div></div> <p><strong>How to disable Dovecot</strong></p> <p>To disable all PAM module via config file:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent config update '{&quot;PAM&quot;: {&quot;enable&quot;: false, &quot;exim_dovecot_protection&quot;: false}}'
</code></pre></div></div> <p>To disable only Exim+Dovecot via config file:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent config update '{&quot;PAM&quot;: {&quot;exim_dovecot_protection&quot;: false}}'
</code></pre></div></div> <p>The options of the <code>pam_imunufy</code> are placed in the file: <span class="notranslate"><code>/etc/pam_imunify/i360.ini</code></span></p> <p><strong>Values</strong></p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>USER_LOCK_TIMEOUT=5</code></span></td> <td>a period of time during which a user should be blocked (minutes)</td></tr> <tr><td><span class="notranslate"><code>USER_LOCK_ATTEMPTS=10</code></span></td> <td>a number of attempts after which a user should be blocked</td></tr> <tr><td><span class="notranslate"><code>USER_LOCK_MINUTES=5</code></span></td> <td>a period of time (minutes) during which violation attempts from a user are counted; all attempts earlier than <span class="notranslate"><code>USER_LOCK_MINUTES</code></span> are not counted</td></tr> <tr><td><span class="notranslate"><code>USER_IP_LOCK_TIMEOUT=5</code></span></td> <td>a period of time during which a user + IP should be blocked (minutes)</td></tr> <tr><td><span class="notranslate"><code>USER_IP_LOCK_ATTEMPTS=10</code></span></td> <td>a number of attempts after which a user + IP should be blocked</td></tr> <tr><td><span class="notranslate"><code>USER_IP_LOCK_MINUTES=5</code></span></td> <td>a period of time (minutes) during which violation attempts from a user + IP are counted; all attempts earlier than <span class="notranslate"><code>USER_IP_LOCK_MINUTES</code></span> are not counted</td></tr> <tr><td><span class="notranslate"><code>IP_LOCK_TIMEOUT=5</code></span></td> <td>a period of time during which an IP should be blocked (minutes)</td></tr> <tr><td><span class="notranslate"><code>IP_LOCK_ATTEMPTS=10</code></span></td> <td>a number of attempts after which an IP should be blocked</td></tr> <tr><td><span class="notranslate"><code>IP_LOCK_MINUTES=5</code></span></td> <td>a period of time during which violation attempts from an IP are counted; all attempts earlier than <span class="notranslate"><code>IP_LOCK_MINUTES</code></span> are not counted</td></tr> <tr><td><span class="notranslate"><code>rbl=net-brute.rbl.imunify.com.</code></span></td> <td>RBL DNS Zone</td></tr> <tr><td><span class="notranslate"><code>RBL_timeout=5</code></span></td> <td>this is the wait time for a response from RBL</td></tr> <tr><td><span class="notranslate"><code>RBL_nameserver=ns1-rbl.imunify.com:53</code></span></td> <td>NS Server</td></tr></tbody></table> <div class="tip custom-block"><p class="custom-block-title">Notes</p><p>Default RBL block time for IP = 4 hours.</p></div><p><strong>How to apply settings</strong></p> <p>In order to apply new settings in the <span class="notranslate"><code>/etc/pam_imunify/i360.ini</code></span>, run the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>systemctl restart imunify360-pam
</code></pre></div></div> <h4 id="how-it-works"><a href="#how-it-works" aria-hidden="true" class="header-anchor">#</a> How it works</h4> <p>During the last <span class="notranslate"><code>XXX_LOCK_MINUTES</code></span> we count the number of login failures (unsuccessful login attempts). If the number of attempts exceeds the specified threshold <span class="notranslate"><code>XXX_LOCK_ATTEMPTS</code></span>, the PAM plugin blocks access for <span class="notranslate"><code>XXX_LOCK_TIMEOUT</code></span> minutes. After that, the counter is reset and the process repeats.
Note that the plugin has three separate counters and a set of settings for USER/IP/USER+IP management regarding brute-force attacks (see the table above).</p> <div class="tip custom-block"><p class="custom-block-title">Notes</p><ul><li>If a user is blocked by <span class="notranslate"><code>USER_LOCK_ATTEMPTS</code></span>, then this user will not have access to the server from any IP</li> <li>If a user is blocked by <span class="notranslate"><code>USER_IP_LOCK_ATTEMPTS</code></span>, then this user will not have access to the server from that specific IP</li> <li>If an IP is blocked by <span class="notranslate"><code>IP_LOCK_ATTEMPTS</code></span>, then all users will not have access to the server from that specific blocked IP</li></ul></div><h2 id="hooks"><a href="#hooks" aria-hidden="true" class="header-anchor">#</a> Hooks <span class="badge warning" style="vertical-align:top;" data-v-17014d78>Deprecated</span></h2> <p>You can use a new notification system via <a href="/command_line_interface/#notifications-config">CLI</a> and <a href="/features/#notifications">UI</a>.</p> <h3 id="overview"><a href="#overview" aria-hidden="true" class="header-anchor">#</a> Overview</h3> <p>Hooks are introduced as a script-based interface for various application events. This is a simple and effective way to automate Imunify360 alerts and event processing.
For example, an administrator can have Imunify360 calling his own script when malicious files are detected or misconfigurations are detected and perform a custom processing or specific actions, for example, create a ticket.
Hooks are available only via CLI.</p> <h4 id="requirements"><a href="#requirements" aria-hidden="true" class="header-anchor">#</a> Requirements</h4> <ul><li>You can use any programming language to create a hook script</li> <li>A hook script should be executable</li> <li>For Native hooks, you should use Python 3.5 only</li></ul> <h3 id="how-to-start-using-hooks"><a href="#how-to-start-using-hooks" aria-hidden="true" class="header-anchor">#</a> How to start using hooks</h3> <p>Start using hooks with three simple steps:</p> <ol><li><p>Create a script to handle an event (a hook handler):</p> <ul><li>you can use our <a href="/features/#structure-and-examples-of-a-hook-script">scripts example</a> as a template</li> <li><a href="/features/#available-events-and-their-parameters">the following events are available</a></li></ul></li> <li><p>Register your hook handler in Imunify360 agent - use registration command:</p></li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent hook add --event &lt;event name&gt; --path &lt;/path/to/hook_script&gt;
</code></pre></div></div> <ol start="3"><li>Once the event added - check results and the <a href="/features/#log-file">log file</a></li></ol> <h3 id="available-events-and-their-parameters"><a href="#available-events-and-their-parameters" aria-hidden="true" class="header-anchor">#</a> Available events and their parameters</h3> <h4 id="agent"><a href="#agent" aria-hidden="true" class="header-anchor">#</a> agent</h4> <ul><li>subtype ( started | misconfig )
<ul><li><p>started - the event is generated each time the Imunify agent is started/restarted</p> <ul><li>params[]
<ul><li>version / string / version of agent</li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{&quot;version&quot;: &quot;4.6.2-2&quot;}
</code></pre></div></div></li> <li><p>misconfig - the event is generated when the agent detects agent misconfiguration / broken settings / etc.</p> <ul><li>params[]
<ul><li>error / string / error message where / what type of misconfiguration was detected and some details</li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
&quot;error&quot;: &quot;ValidationError({'SMTP_BLOCKING': [{'allow_groups': ['must be of list type']}]},)&quot;
}
</code></pre></div></div></li></ul></li></ul> <h4 id="malware-scanning"><a href="#malware-scanning" aria-hidden="true" class="header-anchor">#</a> malware-scanning</h4> <ul><li><p>subtype ( started | finished )</p> <ul><li><p><strong>started</strong> - the event is generated when the malware scanning process is started (for on-demand and background scans only, yet not the ftp / waf / inotify)</p> <ul><li>params[]
<ul><li>scan_id / string / identifier of running scan</li> <li>path / string / path that’s scanning</li> <li>started / int / unixtime when scan started</li> <li>scan_type / string / type of scanning (“on-demand”, “background”, “ftp”, “rescan“)</li> <li>scan_params[]  / initial scanning params
<ul><li>file_patterns / string / file mask to scan</li> <li>exclude_patterns / string / file mask to ignore</li> <li>follow_symlinks / boolean / shall scanner follow symlinks</li> <li>intensity_cpu / int / intensity for cpu operations (from 1 to 7)</li> <li>intensity_io / int / intensity for IO operations (from 1 to 7)</li> <li>intensity_ram / int / amount of memory allocated to the scan process in MB</li></ul></li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
    &quot;scan_id&quot;: &quot;dc3c6061c572410a83be19d153809df1&quot;,
    &quot;home&quot;: &quot;/home/a/abdhf/&quot;,
    &quot;user&quot;: &quot;abdhf&quot;,
    &quot;type&quot;: &quot;background&quot;,
    &quot;scan_params&quot;: {
        &quot;file_patterns&quot;: &quot;*&quot;,
        &quot;exclude_patterns&quot;: null,
        &quot;follow_symlinks&quot;: true,
        &quot;intensity_cpu&quot;: 2
        &quot;intensity_io&quot;: 2
        &quot;intensity_ram&quot;: 2048
    }
}
</code></pre></div></div></li> <li><p><strong>finished</strong> - the event is generated when the malware scanning process is finished (for on-demand and background scans only, yet not the ftp / waf / inotify)</p> <ul><li>params[]
<ul><li>scan_id / string / identifier of running scan</li> <li>path / string / path that’s scanned</li> <li>started / int / unixtime when scan started</li> <li>scan_type / string / type of scanning (“on-demand”, “background”, “ftp”, “rescan“)</li> <li>total_files / int / total number of files that were scanned</li> <li>total_malicious / int / number of detected malicious files</li> <li>error / string / error message if any occurred during scanning</li> <li>status / string / status of scan (“ok”, “failed”)</li> <li>users[] / string array/ user that’s scanned</li> <li>scan_params[]  / initial scanning params
<ul><li>file_patterns / string / file mask to scan</li> <li>exclude_patterns / string / file mask to ignore</li> <li>follow_symlinks / boolean / shall scanner follow symlinks</li> <li>intensity_cpu / int / intensity for cpu operations (from 1 to 7)</li> <li>intensity_io / int / intensity for IO operations (from 1 to 7)</li> <li>intensity_ram / int / amount of memory allocated to the scan process in MB</li></ul></li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
    &quot;scan_id&quot;: &quot;dc3c6061c572410a83be19d153809df1&quot;,
    &quot;path&quot;: &quot;/home/a/abdhf/&quot;,
    &quot;started&quot;: 1587365282,
    &quot;scan_type&quot;: &quot;background&quot;,
    &quot;total_files&quot;: 873535,
    &quot;total_malicious&quot;: 345,
    &quot;error&quot;: null,
    &quot;status&quot;: &quot;ok&quot;,
    &quot;users&quot;: [&quot;abdhf&quot;],
    &quot;scan_params&quot;: {
        &quot;file_patterns&quot;: &quot;*&quot;,
        &quot;exclude_patterns&quot;: null,
        &quot;follow_symlinks&quot;: true,
        &quot;intensity_cpu&quot;: 2
        &quot;intensity_io&quot;: 2
        &quot;intensity_ram&quot;: 2048
    }
}
</code></pre></div></div></li></ul></li></ul> <h4 id="malware-detected"><a href="#malware-detected" aria-hidden="true" class="header-anchor">#</a> malware-detected</h4> <ul><li>subtype ( critical )
<ul><li><p><strong>critical</strong></p> <ul><li>params[]
<ul><li>scan_id / string / unique id of the scan</li> <li>scan_type / string / type of scanning (“on-demand”, “background”, “ftp”, “rescan“)</li> <li>error / string / error message if any occurred during scanning</li> <li>started / int / unixtime when the scan was started</li> <li>path / string / path that was scanned</li> <li>users[] / string array / users that have been scanned (if any)</li> <li>total_files / int / number of files checked within the last scanning</li> <li>total_malicious / int / number of detected malicious files</li> <li>tmp_filename / string / path to a temporary file with a list of detected threads. The list of threads is in the format of the following command: <span class="notranslate"><code>imunify360-agent malware malicious list --by-scan-id=... --json</code></span></li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
    &quot;scan_id&quot;: &quot;dc3c6061c572410a83be19d153809df1&quot;,
    &quot;scan_type&quot;: &quot;on-demand&quot;,
    &quot;path&quot;: &quot;/home/a/abdhf/&quot;,
    &quot;users&quot;: [
        &quot;imunify&quot;,
        &quot;u1&quot;
    ],
    &quot;started&quot;: 1587365282,
    &quot;total_files&quot;: 873535,
    &quot;total_malicious&quot;: 345,
    &quot;error&quot;: null,
    &quot;tmp_filename&quot;: &quot;/var/imunify360/tmp/malware_detected_critical_sldkf2j.json&quot;
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>[
    {
      &quot;scan_id&quot;: &quot;dc3c6061c572410a83be19d153809df1&quot;,
      &quot;username&quot;: &quot;imunify&quot;,
      &quot;hash&quot;: &quot;17c1dd3659578126a32701bb5eaccecc2a6d8307d8e392f5381b7273bfb8a89d&quot;,
      &quot;size&quot;: &quot;182&quot;,
      &quot;cleaned_at&quot;: 1553762878.6882641,
      &quot;extra_data&quot;: {


      },
      &quot;malicious&quot;: true,
      &quot;id&quot;: 32,
      &quot;status&quot;: &quot;cleanup_removed&quot;,
      &quot;file&quot;: &quot;/home/imunify/public_html/01102018_2.php&quot;,
      &quot;type&quot;: &quot;SMW-INJ-04174-bkdr&quot;,
      &quot;scan_type&quot;: &quot;on-demand&quot;,
      &quot;created&quot;: 1553002672
    },
    {
      &quot;scan_id&quot;: &quot;dc3c6061c572410a83be19d153809df1&quot;,
      &quot;username&quot;: &quot;imunify&quot;,
      &quot;hash&quot;: &quot;04425f71ae6c3cd04f8a7f156aee57096dd658ce6321c92619a07e122d33bd32&quot;,
      &quot;size&quot;: &quot;12523&quot;,
      &quot;cleaned_at&quot;: 1553762878.6882641,
      &quot;extra_data&quot;: {


      },
      &quot;malicious&quot;: true,
      &quot;id&quot;: 33,
      &quot;status&quot;: &quot;cleanup_done&quot;,
      &quot;file&quot;: &quot;/home/imunify/public_html/22.js&quot;,
      &quot;type&quot;: &quot;SMW-INJ-04346-js.inj&quot;,
      &quot;scan_type&quot;: &quot;on-demand&quot;,
      &quot;created&quot;: 1553002672
    },
...
]
</code></pre></div></div></li></ul></li></ul> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>All results can be saved in a temporary file before handler invocation and then remove the file after the event is being processed</p></div><h4 id="malware-cleanup"><a href="#malware-cleanup" aria-hidden="true" class="header-anchor">#</a> malware-cleanup</h4> <ul><li><p>subtype ( started | finished )</p> <ul><li><p><strong>started</strong> - the event is generated when the malware cleanup process is started (for on-demand and background cleanup only, background auto-cleanup will be implemented later)</p> <ul><li>params[]
<ul><li>cleanup_id / string / unique id of the cleanup</li> <li>started / int / unixtime when the cleanup was started</li> <li>tmp_filename / string / path to a temporary file with a scanning report. The list is in the format of the following command: <span class="notranslate"><code>imunify360-agent malware malicious list --by-scan-id=... --json</code></span>. See malware-detected hook section for details.</li> <li>total_files / int / number of files that were sent for cleanup</li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
    &quot;cleanup_id&quot;: &quot;dc3c6061c572410a83be19d153809df1&quot;,
    &quot;started&quot;: 1587365282,
    &quot;total_files&quot;: 873535,
    &quot;tmp_filename&quot;: &quot;/var/imunify/tmp/hooks/tmp_02q648234692834698456728439587245.json&quot;,
}
</code></pre></div></div></li> <li><p><strong>finished</strong> - the event is generated when the malware scanning process is finished (for on-demand and background cleanup only, background auto-cleanup will be implemented later)</p> <ul><li>params[]
<ul><li>cleanup_id / string / identifier of running cleanup</li> <li>started / int / unixtime when cleanup started</li> <li>total_files / int / number of files that were sent for cleanup</li> <li>total_cleaned / int / number of files that were successfully cleaned</li> <li>tmp_filename / string / path to a temporary file with a list of results.</li> <li>error / string / error message if any occurred during cleanup</li> <li>status / string / status of scan (“ok”, “failed”)</li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
    &quot;cleanup_id&quot;: &quot;dc3c6061c572410a83be19d153809df1&quot;,
    &quot;started&quot;: 1587365282,
    &quot;total_files&quot;: 873535,
    &quot;total_cleaned&quot;: 872835,
    &quot;tmp_filename&quot;: &quot;/var/imunify/tmp/malware_cleanup_finished_slkj2f.json&quot;,
    &quot;error&quot;: null,
    &quot;status&quot;: &quot;ok&quot;
}
</code></pre></div></div></li></ul></li></ul> <h4 id="license"><a href="#license" aria-hidden="true" class="header-anchor">#</a> license</h4> <ul><li><p>subtype ( expiring | expired | renewed )</p> <ul><li><strong>expiring</strong> - the event is generated when license is about to expire, the even should be sent 3 days prior to expiration
<ul><li><p>params[]</p> <ul><li><strong>exp_time</strong> / int / unixtime data when the license expired</li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{&quot;exp_time&quot;: 1587365282}
</code></pre></div></div></li></ul></li> <li><strong>expired</strong> - the event is generated when license has expired
<ul><li><p>params[]</p> <ul><li><strong>exp_time</strong> / int / unixtime data when the license is expired</li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{&quot;exp_time&quot;: 1587365282}
</code></pre></div></div></li></ul></li> <li><strong>renewed</strong> - the event is generated when the license is updated (renewed)
<ul><li><p>params[]</p> <ul><li><strong>exp_time</strong> / int / unixtime data when the license will expire</li> <li><strong>license</strong> / string / license type</li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
  &quot;exp_time&quot;: 1587365282,
  &quot;license&quot;: &quot;imunify360&quot;
}
</code></pre></div></div></li></ul></li></ul></li></ul> <h3 id="cli"><a href="#cli" aria-hidden="true" class="header-anchor">#</a> CLI</h3> <p>The following CLI command is used to manage hooks:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify360-agent hook [command] --event [event_name|all] [--path &lt;/path/to/hook_script&gt;]
</code></pre></div></div> <p>The following commands are supported:</p> <ul><li><span class="notranslate"><strong>add</strong></span> - register a new event handler</li> <li><span class="notranslate"><strong>delete</strong></span> - unregister existing event handler</li> <li><span class="notranslate"><strong>list</strong></span> - show existing event handlers</li> <li><span class="notranslate"><strong>add-native</strong></span> - register a new native event handler</li></ul> <p>The third parameter <span class="notranslate"><em>event_name</em></span> defines a particular event that invokes a registered handler as opposed to <span class="notranslate"><strong>all</strong></span> keyword.
The fourth parameter <code>/path/to/hook_script</code> shall contain a valid path to a handler of the event, it shall be any executable or Python Native event handlers that agent will run upon a registered event.</p> <h3 id="native"><a href="#native" aria-hidden="true" class="header-anchor">#</a> Native</h3> <p>Native hook is a script written on Python 3.5 and allows to quickly process events. The Python file should contain only one method that customer would implement:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>def im_hook(dict_param):
  …
  pass
</code></pre></div></div> <p>where <code>dict_param</code> would hold the same data as JSON that non-Native hook would get.</p> <h3 id="log-file"><a href="#log-file" aria-hidden="true" class="header-anchor">#</a> Log File</h3> <p>You can see all hook data in the log file. It is located at <span class="notranslate"><em>/var/log/imunify360/hook.log</em></span> .
When the event comes, the data is recorded to the log file in the following format:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>timestamp event : id : started [native:] name :  subtype : script_path
</code></pre></div></div> <ul><li><span class="notranslate"><strong>native</strong></span> is prepended for the Native hook implementation</li> <li><span class="notranslate"><strong>id</strong></span> is a unique ID for each event</li></ul> <p>Once the listener is done, the data is recorded to the log file in the following format:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>timestamp event : id : done [native:] script_path [OK|ERROR:code]
</code></pre></div></div> <p>In case of an error, you can see the error code you have specified.</p> <h3 id="structure-and-examples-of-a-hook-script"><a href="#structure-and-examples-of-a-hook-script" aria-hidden="true" class="header-anchor">#</a> Structure and examples of a hook script</h3> <p>Regular (non-native) hook:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>#!/bin/bash

data=$(cat)

event=$(jq -r '.event' &lt;&lt;&lt; ${data})
subtype=$(jq -r '.subtype' &lt;&lt;&lt; ${data})

case ${event} in
    malware-scanning)
        case ${subtype} in
            started)
                # do stuff here
            ;;
            *)
                echo &quot;Unhandled subtype: ${subtype}&quot; 1&gt;&amp;2
                exit 1
        esac
        ;;
    *)
        echo &quot;Unhandled event: ${event}/${subtype}&quot; 1&gt;&amp;2
        exit 2
esac
</code></pre></div></div> <p>Native hook:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>def im_hook(dict_param):
   event = dict_param['event']
   subtype = dict_param['subtype']

   if event == 'malware-scanning':
       if subtype == 'started':
           # do stuff here
           pass
       elif subtype == 'finished':
           # do other stuff here
           pass
       else:
           raise Exception('Unhandled subtype {}'.format(subtype))
   else:
       raise Exception('Unhandled event {}'.format(event))
</code></pre></div></div> <h3 id="notifications"><a href="#notifications" aria-hidden="true" class="header-anchor">#</a> Notifications</h3> <p>Starting from version 4.10, an administrator is able to configure email addresses to submit reports and execute custom scripts. Go to <span class="notranslate"><em>Settings</em></span> and choose <span class="notranslate"><em>Notifications</em></span> tab.</p> <p><img src="/images/notifications.png" alt=""></p> <ul><li><span class="notranslate"><strong>Default admin emails</strong></span>: specify the default list of emails used for all enabled admin email notifications.</li> <li><span class="notranslate"><strong>From</strong></span>: specify a sender of all emails sent by the Hooks.</li></ul> <p>The following events are available.</p> <h4 id="real-time-scan-malware-detected"><a href="#real-time-scan-malware-detected" aria-hidden="true" class="header-anchor">#</a> Real-Time scan: malware detected</h4> <p>Occurs when malware is detected during the real-time scanning.</p> <p><img src="/images/RealTimeScanDetected.png" alt=""></p> <ul><li><span class="notranslate"><strong>Enable email notifications for admin</strong></span>: move the slider to <span class="notranslate">ON</span> to notify the administrator and a custom user list via email upon event occurrence. To notify the administrator on the default admin email, tick the <span class="notranslate"><em>Default admin emails</em></span> checkbox.</li> <li><span class="notranslate"><strong>Notify every (mins)</strong></span>: set a notification interval in minutes. The data for all events that happened within the interval will be accumulated and sent altogether.</li> <li><span class="notranslate"><strong>Admin emails</strong></span>: tick the <span class="notranslate"><em>Default admin emails</em></span> and/or specify your emails for notifications.</li> <li><span class="notranslate"><strong>Enable script execution</strong></span>: move the slide to <span class="notranslate">ON</span> to run a script (event handler) upon event occurrence.</li> <li><span class="notranslate"><strong>Notify every (sec)</strong></span>: set a notification interval in seconds. The data for all events that happened within the interval will be accumulated and sent altogether.</li> <li><span class="notranslate"><strong>Run a script</strong></span>: specify the full path to the script(s) or any other Linux executable to be launched on event occurrence. Make sure that the script has an executable bit (+x) on. A line-separated list of scripts is supported.</li></ul> <h4 id="user-scan-started"><a href="#user-scan-started" aria-hidden="true" class="header-anchor">#</a> User scan: started</h4> <p>Occurs immediately after the user scanning has started.</p> <p><img src="/images/UserScanStarted.png" alt=""></p> <h4 id="custom-scan-started"><a href="#custom-scan-started" aria-hidden="true" class="header-anchor">#</a> Custom scan: started</h4> <p><img src="/images/CustomScanStarted.png" alt=""></p> <p>Occurs immediately after on-demand (manual) scanning has started.</p> <h4 id="user-scan-finished"><a href="#user-scan-finished" aria-hidden="true" class="header-anchor">#</a> User scan: finished</h4> <p>Occurs immediately after the user scanning has finished, regardless the malware has found or not.</p> <p><img src="/images/UserScanFinished.png" alt=""></p> <h4 id="custom-scan-finished"><a href="#custom-scan-finished" aria-hidden="true" class="header-anchor">#</a> Custom scan: finished</h4> <p><img src="/images/CustomScanFinished.png" alt=""></p> <p>Occurs immediately after on-demand (manual) scanning has finished, regardless the malware has found or not.</p> <h4 id="custom-scan-malware-detected"><a href="#custom-scan-malware-detected" aria-hidden="true" class="header-anchor">#</a> Custom scan: malware detected</h4> <p>Occurs when the on-demand scanning process has finished and malware found.</p> <p><img src="/images/CustomScanDetected.png" alt=""></p> <h4 id="user-scan-malware-detected"><a href="#user-scan-malware-detected" aria-hidden="true" class="header-anchor">#</a> User scan: malware detected</h4> <p>Occurs when the malware scanning process of a user account has finished and malware found.</p> <p><img src="/images/UserScanDetected.png" alt=""></p> <h4 id="script-blocked"><a href="#script-blocked" aria-hidden="true" class="header-anchor">#</a> Script blocked</h4> <p>Occurs when the Proactive Defense has blocked malicious script.</p> <p><img src="/images/ScriptBlocked.png" alt=""></p> <p>Click <span class="notranslate"><em>Save changes</em></span> at the bottom to apply all changes.</p> <h2 id="malware-database-scanner-mds"><a href="#malware-database-scanner-mds" aria-hidden="true" class="header-anchor">#</a> Malware Database Scanner (MDS)</h2> <p><span class="notranslate">Malware Database Scanner (MDS)</span> is designed to solve all malware related problems in the database.</p> <div class="danger custom-block"><p class="custom-block-title">Warning</p><p>Version 5.1 of the Imunify360 introduces a CLI tool without the UI. Further versions will be integrated with the Malware Scanner UI.</p></div><div class="danger custom-block"><p class="custom-block-title">Warning</p><p>For now, Malware Database Scanner (MDS) supports WordPress databases only.</p></div><h3 id="how-to-use-malware-database-scanner-mds"><a href="#how-to-use-malware-database-scanner-mds" aria-hidden="true" class="header-anchor">#</a> How to use Malware Database Scanner (MDS)</h3> <p>To provide safe work with database MDS supports several methods:</p> <ul><li><span class="notranslate"><code>--scan</code></span> - only scan the database, no changes will be applied</li> <li><span class="notranslate"><code>--clean</code></span> - scan database and clean-up malicious</li> <li><span class="notranslate"><code>--restore</code></span> - restore data affected by clean-up from the backup CSV file</li></ul> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>“Clean” operation includes “scan”, so you don’t need to run a scan before the cleanup. Whereas the “scan” can be used for non-disruptive checks of the database. Cleanup mode creates a backup file that can be used to rollback all changes back. It makes MDS safe to use and prevents websites from breaking and data loss.</p></div><p>The easiest way to use MDS is to run it with  <span class="notranslate"><code>--search-configs</code></span> argument: MDS will try to find the config files and print out database credentials that should be later specified for scanning.</p> <p><span class="notranslate"><code>--creds-from-xargs</code></span> argument can be used to run MDS without a need to manually enter credentials. It allows automating the process of credentials discovery and the scan process.</p> <h4 id="usage"><a href="#usage" aria-hidden="true" class="header-anchor">#</a> Usage</h4> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>php /opt/ai-bolit/imunify_dbscan.php [OPTIONS] [PATH]
</code></pre></div></div> <p><strong>Options</strong></p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><span class="notranslate"><code>--host=&lt;host&gt;</code></span></td> <td>Database host</td></tr> <tr><td><span class="notranslate"><code>--port=&lt;port&gt;</code></span></td> <td>Database port</td></tr> <tr><td><span class="notranslate"><code>--login=&lt;username&gt;</code></span></td> <td>Database username</td></tr> <tr><td><span class="notranslate"><code>--password=&lt;password&gt;</code></span></td> <td>Database password</td></tr> <tr><td><span class="notranslate"><code>--password-from-stdin</code></span></td> <td>Get database password from stdin</td></tr> <tr><td><span class="notranslate"><code>--database=&lt;db_name&gt;</code></span></td> <td>Database name</td></tr> <tr><td><span class="notranslate"><code>--prefix=&lt;prefix&gt;</code></span></td> <td>Prefix for table</td></tr> <tr><td><span class="notranslate"><code>--scan</code></span></td> <td>Do scan</td></tr> <tr><td><span class="notranslate"><code>--clean</code></span></td> <td>Do clean</td></tr> <tr><td><span class="notranslate"><code>--search-configs</code></span></td> <td>Find the config files and print out database credentials</td></tr> <tr><td><span class="notranslate"><code>--creds-from-xargs</code></span></td> <td>Discover credentials and do scan</td></tr> <tr><td><span class="notranslate"><code>--report-file=&lt;filepath&gt;</code></span></td> <td>Filepath where to put the report</td></tr> <tr><td><span class="notranslate"><code>--signature-db=&lt;filepath&gt;</code></span></td> <td>Filepath with signatures</td></tr> <tr><td><span class="notranslate"><code>--progress=&lt;filepath&gt;</code></span></td> <td>Filepath with progress</td></tr> <tr><td><span class="notranslate"><code>--shared-mem-progress=&lt;shmem_id&gt;</code></span></td> <td>ID of shared memory segment</td></tr> <tr><td><span class="notranslate"><code>--create-shared-mem</code></span></td> <td>MDS create own shared memory segment</td></tr> <tr><td><span class="notranslate"><code>--status=&lt;filepath&gt;</code></span></td> <td>Filepath with status for control task</td></tr> <tr><td><span class="notranslate"><code>--avdb=&lt;filepath&gt;</code></span></td> <td>Filepath with ai-bolit signatures database</td></tr> <tr><td><span class="notranslate"><code>--procudb=&lt;filepath&gt;</code></span></td> <td>Filepath with procu signatures database</td></tr> <tr><td><span class="notranslate"><code>--state-file=&lt;filepath&gt;</code></span></td> <td>Filepath with info about state (content: <span class="notranslate"><code>new</code>/<code>working</code>/<code>done</code>/<code>canceled</code></span>). You can change it on <span class="notranslate"><code>canceled</code></span>.</td></tr> <tr><td><span class="notranslate"><code>--restore=&lt;filepath&gt;</code></span></td> <td>Filepath to restore CSV file</td></tr> <tr><td><span class="notranslate"><code>-h, --help</code></span></td> <td>Display this help and exit</td></tr> <tr><td><span class="notranslate"><code>-v, --version</code></span></td> <td>Show version</td></tr></tbody></table> <h4 id="example-of-usage"><a href="#example-of-usage" aria-hidden="true" class="header-anchor">#</a> Example of usage</h4> <h4 id="scan-database"><a href="#scan-database" aria-hidden="true" class="header-anchor">#</a> Scan database</h4> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># /opt/alt/php74-imunify/usr/bin/php -n -d extension=json.so -d extension=pdo.so -d extension=mysqlnd.so -d extension=nd_mysqli.so /opt/ai-bolit/imunify_dbscan.php --port=3306 --login=user --password-from-stdin --database=$DATABASE --avdb=/var/imunify360/files/sigs/v1/aibolit/mds-ai-bolit-hoster.db --report-file=`pwd`/report.json --scan
</code></pre></div></div> <p>Scan results will be stored in the <span class="notranslate"><code>results.json</code></span>.</p> <h4 id="scan-clean-up-database"><a href="#scan-clean-up-database" aria-hidden="true" class="header-anchor">#</a> Scan &amp; Clean-up database</h4> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>#  /opt/alt/php74-imunify/usr/bin/php -n -d extension=json.so -d extension=pdo.so -d extension=mysqlnd.so -d extension=nd_mysqli.so /opt/ai-bolit/imunify_dbscan.php --port=3306 --login=user --password-from-stdin --database=$DATABASE --avdb=/var/imunify360/files/sigs/v1/aibolit/mds-ai-bolit-hoster.db --procudb=/var/imunify360/files/sigs/v1/aibolit/mds-procu2.db --report-file=`pwd`/report.json --clean
</code></pre></div></div> <p>Cleanup results will be stored in the <span class="notranslate"><code>results.json</code></span>. Also, backup of the affected data will be created with a filename similar to the <span class="notranslate"><code>mds_backup_1597223818.csv</code></span>.</p> <h4 id="undo-changes-restore"><a href="#undo-changes-restore" aria-hidden="true" class="header-anchor">#</a> Undo changes (restore)</h4> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code># /opt/alt/php74-imunify/usr/bin/php -n -d extension=json.so -d extension=pdo.so -d extension=mysqlnd.so -d extension=nd_mysqli.so /opt/ai-bolit/imunify_dbscan.php --port=3306 --login=user --password-from-stdin --database=$DATABASE --report-file=$REPORT --restore=`pwd`/mds_backup_1597223818.csv
</code></pre></div></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/cloudlinux/imunify360-doc/edit/dev/docs/features/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="back-to-top" data-v-5366e0dd><a href="/features/#app" class="nav-arrow top back-to-top__link" data-v-5366e0dd></a></div> </div> <div class="footer" data-v-3ca314c6><div data-v-3ca314c6><a href="https://cloudlinux.com" data-v-3ca314c6><img src="/assets/img/we-are-cloudlinux.783ed390.svg" alt="We are Cloudlinux" data-v-3ca314c6></a></div> <div class="footer-company-title" data-v-3ca314c6>2021. CloudLinux Inc</div> <div data-v-3ca314c6><div data-v-3ca314c6><a href="https://cloudlinux.zendesk.com/hc/en-us/categories/360002375980-Imunify-Security-Products" target="_blank" data-v-3ca314c6>How to</a></div><div data-v-3ca314c6><a href="https://www.imunify360.com/getting-started" target="_blank" data-v-3ca314c6>Getting started</a></div><div data-v-3ca314c6><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" data-v-3ca314c6>Contact support</a></div><div data-v-3ca314c6><a href="https://blog.imunify360.com" target="_blank" data-v-3ca314c6>Blog</a></div></div> <div class="social" data-v-3ca314c6><span class="footer-social-text" data-v-3ca314c6>Stay in touch</span> <a href="https://www.facebook.com/imunify360/" target="_blank" data-v-3ca314c6><img src="/fb.png" class="footer-social-logo" data-v-3ca314c6></a><a href="https://twitter.com/imunify360/" target="_blank" data-v-3ca314c6><img src="/tw.png" class="footer-social-logo" data-v-3ca314c6></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-3ca314c6><img src="/in.png" class="footer-social-logo" data-v-3ca314c6></a><a href="https://www.youtube.com/channel/UCcW6dDJjcy41c7Hl_5LdLZQ" target="_blank" data-v-3ca314c6><img src="/ytube.png" class="footer-social-logo" data-v-3ca314c6></a></div></div> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8f538a27.js" defer></script><script src="/assets/js/4.ad788cf3.js" defer></script><script src="/assets/js/1.ac56a00f.js" defer></script><script src="/assets/js/29.c1a62275.js" defer></script><script src="/assets/js/19.e19b2aac.js" defer></script>
  </body>
</html>
